import{r as eV,g as X1,a as tV,c as q_}from"./react-Csw2ODfV.js";function nV(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var Z1=eV();const Pt=X1(Z1),tce=nV({__proto__:null,default:Pt},[Z1]);var rV=tV();const Q1=X1(rV);var K_={},mc,X_;function Zt(){if(X_)return mc;X_=1;var t=function(e){return e&&e.Math===Math&&e};return mc=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof q_=="object"&&q_)||t(typeof mc=="object"&&mc)||function(){return this}()||Function("return this")(),mc}var lw={},uw,Z_;function rn(){return Z_||(Z_=1,uw=function(t){try{return!!t()}catch{return!0}}),uw}var cw,Q_;function ei(){if(Q_)return cw;Q_=1;var t=rn();return cw=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),cw}var hw,J_;function np(){if(J_)return hw;J_=1;var t=rn();return hw=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),hw}var dw,eM;function on(){if(eM)return dw;eM=1;var t=np(),e=Function.prototype.call;return dw=t?e.bind(e):function(){return e.apply(e,arguments)},dw}var fw={},tM;function iV(){if(tM)return fw;tM=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return fw.f=n?function(i){var o=e(this,i);return!!o&&o.enumerable}:t,fw}var gw,nM;function rp(){return nM||(nM=1,gw=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),gw}var mw,rM;function Qt(){if(rM)return mw;rM=1;var t=np(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return mw=t?r:function(i){return function(){return n.apply(i,arguments)}},mw}var pw,iM;function pl(){if(iM)return pw;iM=1;var t=Qt(),e=t({}.toString),n=t("".slice);return pw=function(r){return n(e(r),8,-1)},pw}var ww,oM;function oV(){if(oM)return ww;oM=1;var t=Qt(),e=rn(),n=pl(),r=Object,i=t("".split);return ww=e(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,ww}var vw,sM;function IR(){return sM||(sM=1,vw=function(t){return t==null}),vw}var Cw,aM;function Sd(){if(aM)return Cw;aM=1;var t=IR(),e=TypeError;return Cw=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Cw}var yw,lM;function Rd(){if(lM)return yw;lM=1;var t=oV(),e=Sd();return yw=function(n){return t(e(n))},yw}var bw,uM;function sn(){if(uM)return bw;uM=1;var t=typeof document=="object"&&document.all;return bw=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},bw}var Sw,cM;function ti(){if(cM)return Sw;cM=1;var t=sn();return Sw=function(e){return typeof e=="object"?e!==null:t(e)},Sw}var Rw,hM;function Zu(){if(hM)return Rw;hM=1;var t=Zt(),e=sn(),n=function(r){return e(r)?r:void 0};return Rw=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Rw}var Ew,dM;function Ed(){if(dM)return Ew;dM=1;var t=Qt();return Ew=t({}.isPrototypeOf),Ew}var Tw,fM;function ip(){if(fM)return Tw;fM=1;var t=Zt(),e=t.navigator,n=e&&e.userAgent;return Tw=n?String(n):"",Tw}var _w,gM;function sV(){if(gM)return _w;gM=1;var t=Zt(),e=ip(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),_w=a,_w}var Mw,mM;function PR(){if(mM)return Mw;mM=1;var t=sV(),e=rn(),n=Zt(),r=n.String;return Mw=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Mw}var Iw,pM;function J1(){if(pM)return Iw;pM=1;var t=PR();return Iw=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Iw}var Pw,wM;function OR(){if(wM)return Pw;wM=1;var t=Zu(),e=sn(),n=Ed(),r=J1(),i=Object;return Pw=r?function(o){return typeof o=="symbol"}:function(o){var s=t("Symbol");return e(s)&&n(s.prototype,i(o))},Pw}var Ow,vM;function op(){if(vM)return Ow;vM=1;var t=String;return Ow=function(e){try{return t(e)}catch{return"Object"}},Ow}var xw,CM;function wr(){if(CM)return xw;CM=1;var t=sn(),e=op(),n=TypeError;return xw=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},xw}var Hw,yM;function Td(){if(yM)return Hw;yM=1;var t=wr(),e=IR();return Hw=function(n,r){var i=n[r];return e(i)?void 0:t(i)},Hw}var Aw,bM;function aV(){if(bM)return Aw;bM=1;var t=on(),e=sn(),n=ti(),r=TypeError;return Aw=function(i,o){var s,a;if(o==="string"&&e(s=i.toString)&&!n(a=t(s,i))||e(s=i.valueOf)&&!n(a=t(s,i))||o!=="string"&&e(s=i.toString)&&!n(a=t(s,i)))return a;throw new r("Can't convert object to primitive value")},Aw}var Nw={exports:{}},Dw,SM;function ra(){return SM||(SM=1,Dw=!1),Dw}var kw,RM;function xR(){if(RM)return kw;RM=1;var t=Zt(),e=Object.defineProperty;return kw=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},kw}var EM;function HR(){if(EM)return Nw.exports;EM=1;var t=ra(),e=Zt(),n=xR(),r="__core-js_shared__",i=Nw.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.44.0",mode:t?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),Nw.exports}var Lw,TM;function eN(){if(TM)return Lw;TM=1;var t=HR();return Lw=function(e,n){return t[e]||(t[e]=n||{})},Lw}var $w,_M;function Qu(){if(_M)return $w;_M=1;var t=Sd(),e=Object;return $w=function(n){return e(t(n))},$w}var Fw,MM;function ni(){if(MM)return Fw;MM=1;var t=Qt(),e=Qu(),n=t({}.hasOwnProperty);return Fw=Object.hasOwn||function(i,o){return n(e(i),o)},Fw}var Vw,IM;function tN(){if(IM)return Vw;IM=1;var t=Qt(),e=0,n=Math.random(),r=t(1.1.toString);return Vw=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},Vw}var Ww,PM;function Hi(){if(PM)return Ww;PM=1;var t=Zt(),e=eN(),n=ni(),r=tN(),i=PR(),o=J1(),s=t.Symbol,a=e("wks"),l=o?s.for||s:s&&s.withoutSetter||r;return Ww=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:l("Symbol."+u)),a[u]},Ww}var Bw,OM;function lV(){if(OM)return Bw;OM=1;var t=on(),e=ti(),n=OR(),r=Td(),i=aV(),o=Hi(),s=TypeError,a=o("toPrimitive");return Bw=function(l,u){if(!e(l)||n(l))return l;var c=r(l,a),h;if(c){if(u===void 0&&(u="default"),h=t(c,l,u),!e(h)||n(h))return h;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(l,u)},Bw}var jw,xM;function nN(){if(xM)return jw;xM=1;var t=lV(),e=OR();return jw=function(n){var r=t(n,"string");return e(r)?r:r+""},jw}var Uw,HM;function AR(){if(HM)return Uw;HM=1;var t=Zt(),e=ti(),n=t.document,r=e(n)&&e(n.createElement);return Uw=function(i){return r?n.createElement(i):{}},Uw}var zw,AM;function rN(){if(AM)return zw;AM=1;var t=ei(),e=rn(),n=AR();return zw=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),zw}var NM;function iN(){if(NM)return lw;NM=1;var t=ei(),e=on(),n=iV(),r=rp(),i=Rd(),o=nN(),s=ni(),a=rN(),l=Object.getOwnPropertyDescriptor;return lw.f=t?l:function(c,h){if(c=i(c),h=o(h),a)try{return l(c,h)}catch{}if(s(c,h))return r(!e(n.f,c,h),c[h])},lw}var Yw={},Gw,DM;function oN(){if(DM)return Gw;DM=1;var t=ei(),e=rn();return Gw=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Gw}var qw,kM;function an(){if(kM)return qw;kM=1;var t=ti(),e=String,n=TypeError;return qw=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},qw}var LM;function ia(){if(LM)return Yw;LM=1;var t=ei(),e=rN(),n=oN(),r=an(),i=nN(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",u="configurable",c="writable";return Yw.f=t?n?function(d,f,m){if(r(d),f=i(f),r(m),typeof d=="function"&&f==="prototype"&&"value"in m&&c in m&&!m[c]){var w=a(d,f);w&&w[c]&&(d[f]=m.value,m={configurable:u in m?m[u]:w[u],enumerable:l in m?m[l]:w[l],writable:!1})}return s(d,f,m)}:s:function(d,f,m){if(r(d),f=i(f),r(m),e)try{return s(d,f,m)}catch{}if("get"in m||"set"in m)throw new o("Accessors not supported");return"value"in m&&(d[f]=m.value),d},Yw}var Kw,$M;function Ju(){if($M)return Kw;$M=1;var t=ei(),e=ia(),n=rp();return Kw=t?function(r,i,o){return e.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},Kw}var Xw={exports:{}},Zw,FM;function uV(){if(FM)return Zw;FM=1;var t=ei(),e=ni(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!t||t&&r(n,"name").configurable);return Zw={EXISTS:i,PROPER:o,CONFIGURABLE:s},Zw}var Qw,VM;function cV(){if(VM)return Qw;VM=1;var t=Qt(),e=sn(),n=HR(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Qw=n.inspectSource,Qw}var Jw,WM;function hV(){if(WM)return Jw;WM=1;var t=Zt(),e=sn(),n=t.WeakMap;return Jw=e(n)&&/native code/.test(String(n)),Jw}var ev,BM;function NR(){if(BM)return ev;BM=1;var t=eN(),e=tN(),n=t("keys");return ev=function(r){return n[r]||(n[r]=e(r))},ev}var tv,jM;function DR(){return jM||(jM=1,tv={}),tv}var nv,UM;function sN(){if(UM)return nv;UM=1;var t=hV(),e=Zt(),n=ti(),r=Ju(),i=ni(),o=HR(),s=NR(),a=DR(),l="Object already initialized",u=e.TypeError,c=e.WeakMap,h,d,f,m=function(C){return f(C)?d(C):h(C,{})},w=function(C){return function(M){var H;if(!n(M)||(H=d(M)).type!==C)throw new u("Incompatible receiver, "+C+" required");return H}};if(t||o.state){var b=o.state||(o.state=new c);b.get=b.get,b.has=b.has,b.set=b.set,h=function(C,M){if(b.has(C))throw new u(l);return M.facade=C,b.set(C,M),M},d=function(C){return b.get(C)||{}},f=function(C){return b.has(C)}}else{var E=s("state");a[E]=!0,h=function(C,M){if(i(C,E))throw new u(l);return M.facade=C,r(C,E,M),M},d=function(C){return i(C,E)?C[E]:{}},f=function(C){return i(C,E)}}return nv={set:h,get:d,has:f,enforce:m,getterFor:w},nv}var zM;function aN(){if(zM)return Xw.exports;zM=1;var t=Qt(),e=rn(),n=sn(),r=ni(),i=ei(),o=uV().CONFIGURABLE,s=cV(),a=sN(),l=a.enforce,u=a.get,c=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),m=t([].join),w=i&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),E=Xw.exports=function(C,M,H){d(c(M),0,7)==="Symbol("&&(M="["+f(c(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),H&&H.getter&&(M="get "+M),H&&H.setter&&(M="set "+M),(!r(C,"name")||o&&C.name!==M)&&(i?h(C,"name",{value:M,configurable:!0}):C.name=M),w&&H&&r(H,"arity")&&C.length!==H.arity&&h(C,"length",{value:H.arity});try{H&&r(H,"constructor")&&H.constructor?i&&h(C,"prototype",{writable:!1}):C.prototype&&(C.prototype=void 0)}catch{}var L=l(C);return r(L,"source")||(L.source=m(b,typeof M=="string"?M:"")),C};return Function.prototype.toString=E(function(){return n(this)&&u(this).source||s(this)},"toString"),Xw.exports}var rv,YM;function kR(){if(YM)return rv;YM=1;var t=sn(),e=ia(),n=aN(),r=xR();return rv=function(i,o,s,a){a||(a={});var l=a.enumerable,u=a.name!==void 0?a.name:o;if(t(s)&&n(s,u,a),a.global)l?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(l=!0):delete i[o]}catch{}l?i[o]=s:e.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},rv}var iv={},ov,GM;function dV(){if(GM)return ov;GM=1;var t=Math.ceil,e=Math.floor;return ov=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},ov}var sv,qM;function _d(){if(qM)return sv;qM=1;var t=dV();return sv=function(e){var n=+e;return n!==n||n===0?0:t(n)},sv}var av,KM;function fV(){if(KM)return av;KM=1;var t=_d(),e=Math.max,n=Math.min;return av=function(r,i){var o=t(r);return o<0?e(o+i,0):n(o,i)},av}var lv,XM;function gV(){if(XM)return lv;XM=1;var t=_d(),e=Math.min;return lv=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},lv}var uv,ZM;function ec(){if(ZM)return uv;ZM=1;var t=gV();return uv=function(e){return t(e.length)},uv}var cv,QM;function mV(){if(QM)return cv;QM=1;var t=Rd(),e=fV(),n=ec(),r=function(i){return function(o,s,a){var l=t(o),u=n(l);if(u===0)return!i&&-1;var c=e(a,u),h;if(i&&s!==s){for(;u>c;)if(h=l[c++],h!==h)return!0}else for(;u>c;c++)if((i||c in l)&&l[c]===s)return i||c||0;return!i&&-1}};return cv={includes:r(!0),indexOf:r(!1)},cv}var hv,JM;function lN(){if(JM)return hv;JM=1;var t=Qt(),e=ni(),n=Rd(),r=mV().indexOf,i=DR(),o=t([].push);return hv=function(s,a){var l=n(s),u=0,c=[],h;for(h in l)!e(i,h)&&e(l,h)&&o(c,h);for(;a.length>u;)e(l,h=a[u++])&&(~r(c,h)||o(c,h));return c},hv}var dv,eI;function LR(){return eI||(eI=1,dv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),dv}var tI;function pV(){if(tI)return iv;tI=1;var t=lN(),e=LR(),n=e.concat("length","prototype");return iv.f=Object.getOwnPropertyNames||function(i){return t(i,n)},iv}var fv={},nI;function wV(){return nI||(nI=1,fv.f=Object.getOwnPropertySymbols),fv}var gv,rI;function vV(){if(rI)return gv;rI=1;var t=Zu(),e=Qt(),n=pV(),r=wV(),i=an(),o=e([].concat);return gv=t("Reflect","ownKeys")||function(a){var l=n.f(i(a)),u=r.f;return u?o(l,u(a)):l},gv}var mv,iI;function uN(){if(iI)return mv;iI=1;var t=ni(),e=vV(),n=iN(),r=ia();return mv=function(i,o,s){for(var a=e(o),l=r.f,u=n.f,c=0;c<a.length;c++){var h=a[c];!t(i,h)&&!(s&&t(s,h))&&l(i,h,u(o,h))}},mv}var pv,oI;function CV(){if(oI)return pv;oI=1;var t=rn(),e=sn(),n=/#|\.prototype\./,r=function(l,u){var c=o[i(l)];return c===a?!0:c===s?!1:e(u)?t(u):!!u},i=r.normalize=function(l){return String(l).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return pv=r,pv}var wv,sI;function ft(){if(sI)return wv;sI=1;var t=Zt(),e=iN().f,n=Ju(),r=kR(),i=xR(),o=uN(),s=CV();return wv=function(a,l){var u=a.target,c=a.global,h=a.stat,d,f,m,w,b,E;if(c?f=t:h?f=t[u]||i(u,{}):f=t[u]&&t[u].prototype,f)for(m in l){if(b=l[m],a.dontCallGetSet?(E=e(f,m),w=E&&E.value):w=f[m],d=s(c?m:u+(h?".":"#")+m,a.forced),!d&&w!==void 0){if(typeof b==typeof w)continue;o(b,w)}(a.sham||w&&w.sham)&&n(b,"sham",!0),r(f,m,b,a)}},wv}var vv,aI;function Md(){if(aI)return vv;aI=1;var t=np(),e=Function.prototype,n=e.apply,r=e.call;return vv=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),vv}var Cv,lI;function cN(){if(lI)return Cv;lI=1;var t=Qt(),e=wr();return Cv=function(n,r,i){try{return t(e(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Cv}var yv,uI;function yV(){if(uI)return yv;uI=1;var t=ti();return yv=function(e){return t(e)||e===null},yv}var bv,cI;function bV(){if(cI)return bv;cI=1;var t=yV(),e=String,n=TypeError;return bv=function(r){if(t(r))return r;throw new n("Can't set "+e(r)+" as a prototype")},bv}var Sv,hI;function hN(){if(hI)return Sv;hI=1;var t=cN(),e=ti(),n=Sd(),r=bV();return Sv=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=t(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(l,u){return n(l),r(u),e(l)&&(i?s(l,u):l.__proto__=u),l}}():void 0),Sv}var Rv,dI;function SV(){if(dI)return Rv;dI=1;var t=ia().f;return Rv=function(e,n,r){r in e||t(e,r,{configurable:!0,get:function(){return n[r]},set:function(i){n[r]=i}})},Rv}var Ev,fI;function RV(){if(fI)return Ev;fI=1;var t=sn(),e=ti(),n=hN();return Ev=function(r,i,o){var s,a;return n&&t(s=i.constructor)&&s!==o&&e(a=s.prototype)&&a!==o.prototype&&n(r,a),r},Ev}var Tv,gI;function EV(){if(gI)return Tv;gI=1;var t=Hi(),e=t("toStringTag"),n={};return n[e]="z",Tv=String(n)==="[object z]",Tv}var _v,mI;function dN(){if(mI)return _v;mI=1;var t=EV(),e=sn(),n=pl(),r=Hi(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(l,u){try{return l[u]}catch{}};return _v=t?n:function(l){var u,c,h;return l===void 0?"Undefined":l===null?"Null":typeof(c=a(u=o(l),i))=="string"?c:s?n(u):(h=n(u))==="Object"&&e(u.callee)?"Arguments":h},_v}var Mv,pI;function sp(){if(pI)return Mv;pI=1;var t=dN(),e=String;return Mv=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},Mv}var Iv,wI;function TV(){if(wI)return Iv;wI=1;var t=sp();return Iv=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},Iv}var Pv,vI;function _V(){if(vI)return Pv;vI=1;var t=ti(),e=Ju();return Pv=function(n,r){t(r)&&"cause"in r&&e(n,"cause",r.cause)},Pv}var Ov,CI;function MV(){if(CI)return Ov;CI=1;var t=Qt(),e=Error,n=t("".replace),r=function(s){return String(new e(s).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,o=i.test(r);return Ov=function(s,a){if(o&&typeof s=="string"&&!e.prepareStackTrace)for(;a--;)s=n(s,i,"");return s},Ov}var xv,yI;function IV(){if(yI)return xv;yI=1;var t=rn(),e=rp();return xv=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),xv}var Hv,bI;function PV(){if(bI)return Hv;bI=1;var t=Ju(),e=MV(),n=IV(),r=Error.captureStackTrace;return Hv=function(i,o,s,a){n&&(r?r(i,o):t(i,"stack",e(s,a)))},Hv}var Av,SI;function OV(){if(SI)return Av;SI=1;var t=Zu(),e=ni(),n=Ju(),r=Ed(),i=hN(),o=uN(),s=SV(),a=RV(),l=TV(),u=_V(),c=PV(),h=ei(),d=ra();return Av=function(f,m,w,b){var E="stackTraceLimit",C=b?2:1,M=f.split("."),H=M[M.length-1],L=t.apply(null,M);if(L){var P=L.prototype;if(!d&&e(P,"cause")&&delete P.cause,!w)return L;var O=t("Error"),z=m(function(K,A){var Q=l(b?A:K,void 0),X=b?new L(K):new L;return Q!==void 0&&n(X,"message",Q),c(X,z,X.stack,2),this&&r(P,this)&&a(X,this,z),arguments.length>C&&u(X,arguments[C]),X});if(z.prototype=P,H!=="Error"?i?i(z,O):o(z,O,{name:!0}):h&&E in L&&(s(z,L,E),s(z,L,"prepareStackTrace")),o(z,L),!d)try{P.name!==H&&n(P,"name",H),P.constructor=z}catch{}return z}},Av}var RI;function xV(){if(RI)return K_;RI=1;var t=ft(),e=Zt(),n=Md(),r=OV(),i="WebAssembly",o=e[i],s=new Error("e",{cause:7}).cause!==7,a=function(u,c){var h={};h[u]=r(u,c,s),t({global:!0,constructor:!0,arity:1,forced:s},h)},l=function(u,c){if(o&&o[u]){var h={};h[u]=r(i+"."+u,c,s),t({target:i,stat:!0,constructor:!0,arity:1,forced:s},h)}};return a("Error",function(u){return function(h){return n(u,this,arguments)}}),a("EvalError",function(u){return function(h){return n(u,this,arguments)}}),a("RangeError",function(u){return function(h){return n(u,this,arguments)}}),a("ReferenceError",function(u){return function(h){return n(u,this,arguments)}}),a("SyntaxError",function(u){return function(h){return n(u,this,arguments)}}),a("TypeError",function(u){return function(h){return n(u,this,arguments)}}),a("URIError",function(u){return function(h){return n(u,this,arguments)}}),l("CompileError",function(u){return function(h){return n(u,this,arguments)}}),l("LinkError",function(u){return function(h){return n(u,this,arguments)}}),l("RuntimeError",function(u){return function(h){return n(u,this,arguments)}}),K_}xV();var EI={},Nv,TI;function fN(){if(TI)return Nv;TI=1;var t=pl();return Nv=Array.isArray||function(n){return t(n)==="Array"},Nv}var Dv,_I;function gN(){if(_I)return Dv;_I=1;var t=ei(),e=fN(),n=TypeError,r=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}}();return Dv=i?function(o,s){if(e(o)&&!r(o,"length").writable)throw new n("Cannot set read only .length");return o.length=s}:function(o,s){return o.length=s},Dv}var kv,MI;function mN(){if(MI)return kv;MI=1;var t=TypeError,e=9007199254740991;return kv=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},kv}var II;function HV(){if(II)return EI;II=1;var t=ft(),e=Qu(),n=ec(),r=gN(),i=mN(),o=rn(),s=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(c){var h=e(this),d=n(h),f=arguments.length;i(d+f);for(var m=0;m<f;m++)h[d]=arguments[m],d++;return r(h,d),d}}),EI}HV();var PI={},Lv,OI;function AV(){if(OI)return Lv;OI=1;var t=pl(),e=Qt();return Lv=function(n){if(t(n)==="Function")return e(n)},Lv}var $v,xI;function pN(){if(xI)return $v;xI=1;var t=AV(),e=wr(),n=np(),r=t(t.bind);return $v=function(i,o){return e(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},$v}var Fv,HI;function wN(){return HI||(HI=1,Fv={}),Fv}var Vv,AI;function NV(){if(AI)return Vv;AI=1;var t=Hi(),e=wN(),n=t("iterator"),r=Array.prototype;return Vv=function(i){return i!==void 0&&(e.Array===i||r[n]===i)},Vv}var Wv,NI;function $R(){if(NI)return Wv;NI=1;var t=dN(),e=Td(),n=IR(),r=wN(),i=Hi(),o=i("iterator");return Wv=function(s){if(!n(s))return e(s,o)||e(s,"@@iterator")||r[t(s)]},Wv}var Bv,DI;function DV(){if(DI)return Bv;DI=1;var t=on(),e=wr(),n=an(),r=op(),i=$R(),o=TypeError;return Bv=function(s,a){var l=arguments.length<2?i(s):a;if(e(l))return n(t(l,s));throw new o(r(s)+" is not iterable")},Bv}var jv,kI;function vr(){if(kI)return jv;kI=1;var t=on(),e=an(),n=Td();return jv=function(r,i,o){var s,a;e(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=t(s,r)}catch(l){a=!0,s=l}if(i==="throw")throw o;if(a)throw s;return e(s),o},jv}var Uv,LI;function tc(){if(LI)return Uv;LI=1;var t=pN(),e=on(),n=an(),r=op(),i=NV(),o=ec(),s=Ed(),a=DV(),l=$R(),u=vr(),c=TypeError,h=function(f,m){this.stopped=f,this.result=m},d=h.prototype;return Uv=function(f,m,w){var b=w&&w.that,E=!!(w&&w.AS_ENTRIES),C=!!(w&&w.IS_RECORD),M=!!(w&&w.IS_ITERATOR),H=!!(w&&w.INTERRUPTED),L=t(m,b),P,O,z,K,A,Q,X,ae=function(ce){return P&&u(P,"normal"),new h(!0,ce)},ee=function(ce){return E?(n(ce),H?L(ce[0],ce[1],ae):L(ce[0],ce[1])):H?L(ce,ae):L(ce)};if(C)P=f.iterator;else if(M)P=f;else{if(O=l(f),!O)throw new c(r(f)+" is not iterable");if(i(O)){for(z=0,K=o(f);K>z;z++)if(A=ee(f[z]),A&&s(d,A))return A;return new h(!1)}P=a(f,O)}for(Q=C?f.next:P.next;!(X=e(Q,P)).done;){try{A=ee(X.value)}catch(ce){u(P,"throw",ce)}if(typeof A=="object"&&A&&s(d,A))return A}return new h(!1)},Uv}var zv,$I;function vN(){if($I)return zv;$I=1;var t=ei(),e=ia(),n=rp();return zv=function(r,i,o){t?e.f(r,i,n(0,o)):r[i]=o},zv}var FI;function kV(){if(FI)return PI;FI=1;var t=ft(),e=tc(),n=vN();return t({target:"Object",stat:!0},{fromEntries:function(i){var o={};return e(i,function(s,a){n(o,s,a)},{AS_ENTRIES:!0}),o}}),PI}kV();var VI={},Yv,WI;function go(){if(WI)return Yv;WI=1;var t=Qt(),e=Set.prototype;return Yv={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},Yv}var Gv,BI;function wl(){if(BI)return Gv;BI=1;var t=go().has;return Gv=function(e){return t(e),e},Gv}var qv,jI;function vl(){if(jI)return qv;jI=1;var t=on();return qv=function(e,n,r){for(var i=r?e:e.iterator,o=e.next,s,a;!(s=t(o,i)).done;)if(a=n(s.value),a!==void 0)return a},qv}var Kv,UI;function Id(){if(UI)return Kv;UI=1;var t=Qt(),e=vl(),n=go(),r=n.Set,i=n.proto,o=t(i.forEach),s=t(i.keys),a=s(new r).next;return Kv=function(l,u,c){return c?e({iterator:s(l),next:a},u):o(l,u)},Kv}var Xv,zI;function FR(){if(zI)return Xv;zI=1;var t=go(),e=Id(),n=t.Set,r=t.add;return Xv=function(i){var o=new n;return e(i,function(s){r(o,s)}),o},Xv}var Zv,YI;function Pd(){if(YI)return Zv;YI=1;var t=cN(),e=go();return Zv=t(e.proto,"size","get")||function(n){return n.size},Zv}var Qv,GI;function mo(){return GI||(GI=1,Qv=function(t){return{iterator:t,next:t.next,done:!1}}),Qv}var Jv,qI;function Cl(){if(qI)return Jv;qI=1;var t=wr(),e=an(),n=on(),r=_d(),i=mo(),o="Invalid size",s=RangeError,a=TypeError,l=Math.max,u=function(c,h){this.set=c,this.size=l(h,0),this.has=t(c.has),this.keys=t(c.keys)};return u.prototype={getIterator:function(){return i(e(n(this.keys,this.set)))},includes:function(c){return n(this.has,this.set,c)}},Jv=function(c){e(c);var h=+c.size;if(h!==h)throw new a(o);var d=r(h);if(d<0)throw new s(o);return new u(c,d)},Jv}var eC,KI;function LV(){if(KI)return eC;KI=1;var t=wl(),e=go(),n=FR(),r=Pd(),i=Cl(),o=Id(),s=vl(),a=e.has,l=e.remove;return eC=function(c){var h=t(this),d=i(c),f=n(h);return r(h)<=d.size?o(h,function(m){d.includes(m)&&l(f,m)}):s(d.getIterator(),function(m){a(f,m)&&l(f,m)}),f},eC}var tC,XI;function yl(){if(XI)return tC;XI=1;var t=Zu(),e=function(r){return{size:r,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(r){return{size:r,has:function(){return!0},keys:function(){throw new Error("e")}}};return tC=function(r,i){var o=t("Set");try{new o()[r](e(0));try{return new o()[r](e(-1)),!1}catch{if(!i)return!0;try{return new o()[r](n(-1/0)),!1}catch{var s=new o;return s.add(1),s.add(2),i(s[r](n(1/0)))}}}catch{return!1}},tC}var ZI;function $V(){if(ZI)return VI;ZI=1;var t=ft(),e=LV(),n=rn(),r=yl(),i=!r("difference",function(s){return s.size===0}),o=i||n(function(){var s={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var u=l++>1;return a.has(1)&&a.clear(),{done:u,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(s).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),VI}$V();var QI={},nC,JI;function FV(){if(JI)return nC;JI=1;var t=wl(),e=go(),n=Pd(),r=Cl(),i=Id(),o=vl(),s=e.Set,a=e.add,l=e.has;return nC=function(c){var h=t(this),d=r(c),f=new s;return n(h)>d.size?o(d.getIterator(),function(m){l(h,m)&&a(f,m)}):i(h,function(m){d.includes(m)&&a(f,m)}),f},nC}var eP;function VV(){if(eP)return QI;eP=1;var t=ft(),e=rn(),n=FV(),r=yl(),i=!r("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:n}),QI}VV();var tP={},rC,nP;function WV(){if(nP)return rC;nP=1;var t=wl(),e=go().has,n=Pd(),r=Cl(),i=Id(),o=vl(),s=vr();return rC=function(l){var u=t(this),c=r(l);if(n(u)<=c.size)return i(u,function(d){if(c.includes(d))return!1},!0)!==!1;var h=c.getIterator();return o(h,function(d){if(e(u,d))return s(h,"normal",!1)})!==!1},rC}var rP;function BV(){if(rP)return tP;rP=1;var t=ft(),e=WV(),n=yl(),r=!n("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isDisjointFrom:e}),tP}BV();var iP={},iC,oP;function jV(){if(oP)return iC;oP=1;var t=wl(),e=Pd(),n=Id(),r=Cl();return iC=function(o){var s=t(this),a=r(o);return e(s)>a.size?!1:n(s,function(l){if(!a.includes(l))return!1},!0)!==!1},iC}var sP;function UV(){if(sP)return iP;sP=1;var t=ft(),e=jV(),n=yl(),r=!n("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSubsetOf:e}),iP}UV();var aP={},oC,lP;function zV(){if(lP)return oC;lP=1;var t=wl(),e=go().has,n=Pd(),r=Cl(),i=vl(),o=vr();return oC=function(a){var l=t(this),u=r(a);if(n(l)<u.size)return!1;var c=u.getIterator();return i(c,function(h){if(!e(l,h))return o(c,"normal",!1)})!==!1},oC}var uP;function YV(){if(uP)return aP;uP=1;var t=ft(),e=zV(),n=yl(),r=!n("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:r},{isSupersetOf:e}),aP}YV();var cP={},sC,hP;function GV(){if(hP)return sC;hP=1;var t=wl(),e=go(),n=FR(),r=Cl(),i=vl(),o=e.add,s=e.has,a=e.remove;return sC=function(u){var c=t(this),h=r(u).getIterator(),d=n(c);return i(h,function(f){s(c,f)?a(d,f):o(d,f)}),d},sC}var aC,dP;function CN(){return dP||(dP=1,aC=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},r=e[t](n);return r.size===1&&r.values().next().value===4}catch{return!1}}),aC}var fP;function qV(){if(fP)return cP;fP=1;var t=ft(),e=GV(),n=CN(),r=yl(),i=!r("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),cP}qV();var gP={},lC,mP;function KV(){if(mP)return lC;mP=1;var t=wl(),e=go().add,n=FR(),r=Cl(),i=vl();return lC=function(s){var a=t(this),l=r(s).getIterator(),u=n(a);return i(l,function(c){e(u,c)}),u},lC}var pP;function XV(){if(pP)return gP;pP=1;var t=ft(),e=KV(),n=CN(),r=yl(),i=!r("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),gP}XV();var wP={},vP={},uC,CP;function ZV(){if(CP)return uC;CP=1;var t=Ed(),e=TypeError;return uC=function(n,r){if(t(r,n))return n;throw new e("Incorrect invocation")},uC}var cC,yP;function QV(){if(yP)return cC;yP=1;var t=rn();return cC=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),cC}var hC,bP;function yN(){if(bP)return hC;bP=1;var t=ni(),e=sn(),n=Qu(),r=NR(),i=QV(),o=r("IE_PROTO"),s=Object,a=s.prototype;return hC=i?s.getPrototypeOf:function(l){var u=n(l);if(t(u,o))return u[o];var c=u.constructor;return e(c)&&u instanceof c?c.prototype:u instanceof s?a:null},hC}var dC,SP;function JV(){if(SP)return dC;SP=1;var t=aN(),e=ia();return dC=function(n,r,i){return i.get&&t(i.get,r,{getter:!0}),i.set&&t(i.set,r,{setter:!0}),e.f(n,r,i)},dC}var fC={},gC,RP;function eW(){if(RP)return gC;RP=1;var t=lN(),e=LR();return gC=Object.keys||function(r){return t(r,e)},gC}var EP;function tW(){if(EP)return fC;EP=1;var t=ei(),e=oN(),n=ia(),r=an(),i=Rd(),o=eW();return fC.f=t&&!e?Object.defineProperties:function(a,l){r(a);for(var u=i(l),c=o(l),h=c.length,d=0,f;h>d;)n.f(a,f=c[d++],u[f]);return a},fC}var mC,TP;function bN(){if(TP)return mC;TP=1;var t=Zu();return mC=t("document","documentElement"),mC}var pC,_P;function VR(){if(_P)return pC;_P=1;var t=an(),e=tW(),n=LR(),r=DR(),i=bN(),o=AR(),s=NR(),a=">",l="<",u="prototype",c="script",h=s("IE_PROTO"),d=function(){},f=function(C){return l+c+a+C+l+"/"+c+a},m=function(C){C.write(f("")),C.close();var M=C.parentWindow.Object;return C=null,M},w=function(){var C=o("iframe"),M="java"+c+":",H;return C.style.display="none",i.appendChild(C),C.src=String(M),H=C.contentWindow.document,H.open(),H.write(f("document.F=Object")),H.close(),H.F},b,E=function(){try{b=new ActiveXObject("htmlfile")}catch{}E=typeof document<"u"?document.domain&&b?m(b):w():m(b);for(var C=n.length;C--;)delete E[u][n[C]];return E()};return r[h]=!0,pC=Object.create||function(M,H){var L;return M!==null?(d[u]=t(M),L=new d,d[u]=null,L[h]=M):L=E(),H===void 0?L:e.f(L,H)},pC}var wC,MP;function SN(){if(MP)return wC;MP=1;var t=rn(),e=sn(),n=ti(),r=VR(),i=yN(),o=kR(),s=Hi(),a=ra(),l=s("iterator"),u=!1,c,h,d;[].keys&&(d=[].keys(),"next"in d?(h=i(i(d)),h!==Object.prototype&&(c=h)):u=!0);var f=!n(c)||t(function(){var m={};return c[l].call(m)!==m});return f?c={}:a&&(c=r(c)),e(c[l])||o(c,l,function(){return this}),wC={IteratorPrototype:c,BUGGY_SAFARI_ITERATORS:u},wC}var IP;function nW(){if(IP)return vP;IP=1;var t=ft(),e=Zt(),n=ZV(),r=an(),i=sn(),o=yN(),s=JV(),a=vN(),l=rn(),u=ni(),c=Hi(),h=SN().IteratorPrototype,d=ei(),f=ra(),m="constructor",w="Iterator",b=c("toStringTag"),E=TypeError,C=e[w],M=f||!i(C)||C.prototype!==h||!l(function(){C({})}),H=function(){if(n(this,h),o(this)===h)throw new E("Abstract class Iterator not directly constructable")},L=function(P,O){d?s(h,P,{configurable:!0,get:function(){return O},set:function(z){if(r(this),this===h)throw new E("You can't redefine this property");u(this,P)?this[P]=z:a(this,P,z)}}):h[P]=O};return u(h,b)||L(b,w),(M||!u(h,m)||h[m]===Object)&&L(m,H),H.prototype=h,t({global:!0,constructor:!0,forced:M},{Iterator:H}),vP}var PP;function rW(){return PP||(PP=1,nW()),wP}rW();var OP={},xP={},vC,HP;function iW(){if(HP)return vC;HP=1;var t=kR();return vC=function(e,n,r){for(var i in n)t(e,i,n[i],r);return e},vC}var CC,AP;function oW(){return AP||(AP=1,CC=function(t,e){return{value:t,done:e}}),CC}var yC,NP;function sW(){if(NP)return yC;NP=1;var t=vr();return yC=function(e,n,r){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{r=t(e[i].iterator,n,r)}catch(o){n="throw",r=o}if(n==="throw")throw r;return r},yC}var bC,DP;function WR(){if(DP)return bC;DP=1;var t=on(),e=VR(),n=Ju(),r=iW(),i=Hi(),o=sN(),s=Td(),a=SN().IteratorPrototype,l=oW(),u=vr(),c=sW(),h=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",m="normal",w="throw",b=o.set,E=function(H){var L=o.getterFor(H?f:d);return r(e(a),{next:function(){var O=L(this);if(H)return O.nextHandler();if(O.done)return l(void 0,!0);try{var z=O.nextHandler();return O.returnHandlerResult?z:l(z,O.done)}catch(K){throw O.done=!0,K}},return:function(){var P=L(this),O=P.iterator;if(P.done=!0,H){var z=s(O,"return");return z?t(z,O):l(void 0,!0)}if(P.inner)try{u(P.inner.iterator,m)}catch(K){return u(O,w,K)}if(P.openIters)try{c(P.openIters,m)}catch(K){return u(O,w,K)}return O&&u(O,m),l(void 0,!0)}})},C=E(!0),M=E(!1);return n(M,h,"Iterator Helper"),bC=function(H,L,P){var O=function(K,A){A?(A.iterator=K.iterator,A.next=K.next):A=K,A.type=L?f:d,A.returnHandlerResult=!!P,A.nextHandler=H,A.counter=0,A.done=!1,b(this,A)};return O.prototype=L?C:M,O},bC}var SC,kP;function RN(){if(kP)return SC;kP=1;var t=an(),e=vr();return SC=function(n,r,i,o){try{return o?r(t(i)[0],i[1]):r(i)}catch(s){e(n,"throw",s)}},SC}var RC,LP;function BR(){return LP||(LP=1,RC=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),RC}var EC,$P;function oa(){if($P)return EC;$P=1;var t=Zt();return EC=function(e,n){var r=t.Iterator,i=r&&r.prototype,o=i&&i[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(a){a instanceof n||(s=!1)}if(!s)return o},EC}var FP;function aW(){if(FP)return xP;FP=1;var t=ft(),e=on(),n=wr(),r=an(),i=mo(),o=WR(),s=RN(),a=ra(),l=vr(),u=BR(),c=oa(),h=!a&&!u("filter",function(){}),d=!a&&!h&&c("filter",TypeError),f=a||h||d,m=o(function(){for(var w=this.iterator,b=this.predicate,E=this.next,C,M,H;;){if(C=r(e(E,w)),M=this.done=!!C.done,M)return;if(H=C.value,s(w,b,[H,this.counter++],!0))return H}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(b){r(this);try{n(b)}catch(E){l(this,"throw",E)}return d?e(d,this,b):new m(i(this),{predicate:b})}}),xP}var VP;function lW(){return VP||(VP=1,aW()),OP}lW();var WP={},BP={},jP;function uW(){if(jP)return BP;jP=1;var t=ft(),e=on(),n=tc(),r=wr(),i=an(),o=mo(),s=vr(),a=oa(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;n(h,function(f){c(f,d++)},{IS_RECORD:!0})}}),BP}var UP;function cW(){return UP||(UP=1,uW()),WP}cW();var zP={},YP={},GP;function hW(){if(GP)return YP;GP=1;var t=ft(),e=on(),n=wr(),r=an(),i=mo(),o=WR(),s=RN(),a=vr(),l=BR(),u=oa(),c=ra(),h=!c&&!l("map",function(){}),d=!c&&!h&&u("map",TypeError),f=c||h||d,m=o(function(){var w=this.iterator,b=r(e(this.next,w)),E=this.done=!!b.done;if(!E)return s(w,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(b){r(this);try{n(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new m(i(this),{mapper:b})}}),YP}var qP;function dW(){return qP||(qP=1,hW()),zP}dW();var KP={},XP={},TC,ZP;function jR(){if(ZP)return TC;ZP=1;var t=Qt();return TC=t([].slice),TC}var _C,QP;function EN(){if(QP)return _C;QP=1;var t=TypeError;return _C=function(e,n){if(e<n)throw new t("Not enough arguments");return e},_C}var MC,JP;function fW(){if(JP)return MC;JP=1;var t=ip();return MC=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),MC}var IC,eO;function TN(){if(eO)return IC;eO=1;var t=Zt(),e=ip(),n=pl(),r=function(i){return e.slice(0,i.length)===i};return IC=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),IC}var PC,tO;function gW(){if(tO)return PC;tO=1;var t=TN();return PC=t==="NODE",PC}var OC,nO;function _N(){if(nO)return OC;nO=1;var t=Zt(),e=Md(),n=pN(),r=sn(),i=ni(),o=rn(),s=bN(),a=jR(),l=AR(),u=EN(),c=fW(),h=gW(),d=t.setImmediate,f=t.clearImmediate,m=t.process,w=t.Dispatch,b=t.Function,E=t.MessageChannel,C=t.String,M=0,H={},L="onreadystatechange",P,O,z,K;o(function(){P=t.location});var A=function(ee){if(i(H,ee)){var ce=H[ee];delete H[ee],ce()}},Q=function(ee){return function(){A(ee)}},X=function(ee){A(ee.data)},ae=function(ee){t.postMessage(C(ee),P.protocol+"//"+P.host)};return(!d||!f)&&(d=function(ce){u(arguments.length,1);var vt=r(ce)?ce:b(ce),Ne=a(arguments,1);return H[++M]=function(){e(vt,void 0,Ne)},O(M),M},f=function(ce){delete H[ce]},h?O=function(ee){m.nextTick(Q(ee))}:w&&w.now?O=function(ee){w.now(Q(ee))}:E&&!c?(z=new E,K=z.port2,z.port1.onmessage=X,O=n(K.postMessage,K)):t.addEventListener&&r(t.postMessage)&&!t.importScripts&&P&&P.protocol!=="file:"&&!o(ae)?(O=ae,t.addEventListener("message",X,!1)):L in l("script")?O=function(ee){s.appendChild(l("script"))[L]=function(){s.removeChild(this),A(ee)}}:O=function(ee){setTimeout(Q(ee),0)}),OC={set:d,clear:f},OC}var rO;function mW(){if(rO)return XP;rO=1;var t=ft(),e=Zt(),n=_N().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),XP}var iO={},xC,oO;function pW(){if(oO)return xC;oO=1;var t=Zt(),e=Md(),n=sn(),r=TN(),i=ip(),o=jR(),s=EN(),a=t.Function,l=/MSIE .\./.test(i)||r==="BUN"&&function(){var u=t.Bun.version.split(".");return u.length<3||u[0]==="0"&&(u[1]<3||u[1]==="3"&&u[2]==="0")}();return xC=function(u,c){var h=c?2:1;return l?function(d,f){var m=s(arguments.length,1)>h,w=n(d)?d:a(d),b=m?o(arguments,h):[],E=m?function(){e(w,this,b)}:w;return c?u(E,f):u(E)}:u},xC}var sO;function wW(){if(sO)return iO;sO=1;var t=ft(),e=Zt(),n=_N().set,r=pW(),i=e.setImmediate?r(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),iO}var aO;function vW(){return aO||(aO=1,mW(),wW()),KP}vW();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:MN,setPrototypeOf:lO,isFrozen:CW,getPrototypeOf:yW,getOwnPropertyDescriptor:bW}=Object;let{freeze:Kn,seal:Qr,create:IN}=Object,{apply:vS,construct:CS}=typeof Reflect<"u"&&Reflect;Kn||(Kn=function(e){return e});Qr||(Qr=function(e){return e});vS||(vS=function(e,n,r){return e.apply(n,r)});CS||(CS=function(e,n){return new e(...n)});const ef=Xn(Array.prototype.forEach),SW=Xn(Array.prototype.lastIndexOf),uO=Xn(Array.prototype.pop),pc=Xn(Array.prototype.push),RW=Xn(Array.prototype.splice),Lg=Xn(String.prototype.toLowerCase),HC=Xn(String.prototype.toString),cO=Xn(String.prototype.match),wc=Xn(String.prototype.replace),EW=Xn(String.prototype.indexOf),TW=Xn(String.prototype.trim),vi=Xn(Object.prototype.hasOwnProperty),Vn=Xn(RegExp.prototype.test),vc=_W(TypeError);function Xn(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return vS(t,e,r)}}function _W(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return CS(t,n)}}function De(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Lg;lO&&lO(t,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const o=n(i);o!==i&&(CW(e)||(e[r]=o),i=o)}t[i]=!0}return t}function MW(t){for(let e=0;e<t.length;e++)vi(t,e)||(t[e]=null);return t}function ko(t){const e=IN(null);for(const[n,r]of MN(t))vi(t,n)&&(Array.isArray(r)?e[n]=MW(r):r&&typeof r=="object"&&r.constructor===Object?e[n]=ko(r):e[n]=r);return e}function Cc(t,e){for(;t!==null;){const r=bW(t,e);if(r){if(r.get)return Xn(r.get);if(typeof r.value=="function")return Xn(r.value)}t=yW(t)}function n(){return null}return n}const hO=Kn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),AC=Kn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),NC=Kn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),IW=Kn(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),DC=Kn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),PW=Kn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),dO=Kn(["#text"]),fO=Kn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),kC=Kn(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gO=Kn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),tf=Kn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),OW=Qr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xW=Qr(/<%[\w\W]*|[\w\W]*%>/gm),HW=Qr(/\$\{[\w\W]*/gm),AW=Qr(/^data-[\-\w.\u00B7-\uFFFF]+$/),NW=Qr(/^aria-[\-\w]+$/),PN=Qr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),DW=Qr(/^(?:\w+script|data):/i),kW=Qr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ON=Qr(/^html$/i),LW=Qr(/^[a-z][.\w]*(-[.\w]+)+$/i);var mO=Object.freeze({__proto__:null,ARIA_ATTR:NW,ATTR_WHITESPACE:kW,CUSTOM_ELEMENT:LW,DATA_ATTR:AW,DOCTYPE_NAME:ON,ERB_EXPR:xW,IS_ALLOWED_URI:PN,IS_SCRIPT_OR_DATA:DW,MUSTACHE_EXPR:OW,TMPLIT_EXPR:HW});const yc={element:1,text:3,progressingInstruction:7,comment:8,document:9},$W=function(){return typeof window>"u"?null:window},FW=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},pO=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function xN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$W();const e=we=>xN(we);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==yc.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,m=l.prototype,w=Cc(m,"cloneNode"),b=Cc(m,"remove"),E=Cc(m,"nextSibling"),C=Cc(m,"childNodes"),M=Cc(m,"parentNode");if(typeof s=="function"){const we=n.createElement("template");we.content&&we.content.ownerDocument&&(n=we.content.ownerDocument)}let H,L="";const{implementation:P,createNodeIterator:O,createDocumentFragment:z,getElementsByTagName:K}=n,{importNode:A}=r;let Q=pO();e.isSupported=typeof MN=="function"&&typeof M=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:ae,TMPLIT_EXPR:ee,DATA_ATTR:ce,ARIA_ATTR:vt,IS_SCRIPT_OR_DATA:Ne,ATTR_WHITESPACE:$e,CUSTOM_ELEMENT:Ct}=mO;let{IS_ALLOWED_URI:rt}=mO,at=null;const pn=De({},[...hO,...AC,...NC,...DC,...dO]);let g=null;const p=De({},[...fO,...kC,...gO,...tf]);let y=Object.seal(IN(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),N=null,F=null,B=!0,G=!0,v=!1,S=!0,R=!1,T=!0,I=!1,k=!1,W=!1,x=!1,$=!1,V=!1,j=!0,U=!1;const ie="user-content-";let se=!0,Se=!1,Fe={},Ve=null;const Re=De({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let be=null;const Je=De({},["audio","video","img","source","image","track"]);let Qn=null;const yo=De({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),li="http://www.w3.org/1998/Math/MathML",un="http://www.w3.org/2000/svg",yt="http://www.w3.org/1999/xhtml";let _t=yt,gt=!1,Xe=null;const Ar=De({},[li,un,yt],HC);let Fn=De({},["mi","mo","mn","ms","mtext"]),ua=De({},["annotation-xml"]);const Jd=De({},["title","style","font","a","script"]);let fc=null;const KF=["application/xhtml+xml","text/html"],XF="text/html";let wn=null,Ml=null;const ZF=n.createElement("form"),k_=function(D){return D instanceof RegExp||D instanceof Function},ow=function(){let D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ml&&Ml===D)){if((!D||typeof D!="object")&&(D={}),D=ko(D),fc=KF.indexOf(D.PARSER_MEDIA_TYPE)===-1?XF:D.PARSER_MEDIA_TYPE,wn=fc==="application/xhtml+xml"?HC:Lg,at=vi(D,"ALLOWED_TAGS")?De({},D.ALLOWED_TAGS,wn):pn,g=vi(D,"ALLOWED_ATTR")?De({},D.ALLOWED_ATTR,wn):p,Xe=vi(D,"ALLOWED_NAMESPACES")?De({},D.ALLOWED_NAMESPACES,HC):Ar,Qn=vi(D,"ADD_URI_SAFE_ATTR")?De(ko(yo),D.ADD_URI_SAFE_ATTR,wn):yo,be=vi(D,"ADD_DATA_URI_TAGS")?De(ko(Je),D.ADD_DATA_URI_TAGS,wn):Je,Ve=vi(D,"FORBID_CONTENTS")?De({},D.FORBID_CONTENTS,wn):Re,N=vi(D,"FORBID_TAGS")?De({},D.FORBID_TAGS,wn):ko({}),F=vi(D,"FORBID_ATTR")?De({},D.FORBID_ATTR,wn):ko({}),Fe=vi(D,"USE_PROFILES")?D.USE_PROFILES:!1,B=D.ALLOW_ARIA_ATTR!==!1,G=D.ALLOW_DATA_ATTR!==!1,v=D.ALLOW_UNKNOWN_PROTOCOLS||!1,S=D.ALLOW_SELF_CLOSE_IN_ATTR!==!1,R=D.SAFE_FOR_TEMPLATES||!1,T=D.SAFE_FOR_XML!==!1,I=D.WHOLE_DOCUMENT||!1,x=D.RETURN_DOM||!1,$=D.RETURN_DOM_FRAGMENT||!1,V=D.RETURN_TRUSTED_TYPE||!1,W=D.FORCE_BODY||!1,j=D.SANITIZE_DOM!==!1,U=D.SANITIZE_NAMED_PROPS||!1,se=D.KEEP_CONTENT!==!1,Se=D.IN_PLACE||!1,rt=D.ALLOWED_URI_REGEXP||PN,_t=D.NAMESPACE||yt,Fn=D.MATHML_TEXT_INTEGRATION_POINTS||Fn,ua=D.HTML_INTEGRATION_POINTS||ua,y=D.CUSTOM_ELEMENT_HANDLING||{},D.CUSTOM_ELEMENT_HANDLING&&k_(D.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(y.tagNameCheck=D.CUSTOM_ELEMENT_HANDLING.tagNameCheck),D.CUSTOM_ELEMENT_HANDLING&&k_(D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(y.attributeNameCheck=D.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),D.CUSTOM_ELEMENT_HANDLING&&typeof D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(y.allowCustomizedBuiltInElements=D.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),R&&(G=!1),$&&(x=!0),Fe&&(at=De({},dO),g=[],Fe.html===!0&&(De(at,hO),De(g,fO)),Fe.svg===!0&&(De(at,AC),De(g,kC),De(g,tf)),Fe.svgFilters===!0&&(De(at,NC),De(g,kC),De(g,tf)),Fe.mathMl===!0&&(De(at,DC),De(g,gO),De(g,tf))),D.ADD_TAGS&&(at===pn&&(at=ko(at)),De(at,D.ADD_TAGS,wn)),D.ADD_ATTR&&(g===p&&(g=ko(g)),De(g,D.ADD_ATTR,wn)),D.ADD_URI_SAFE_ATTR&&De(Qn,D.ADD_URI_SAFE_ATTR,wn),D.FORBID_CONTENTS&&(Ve===Re&&(Ve=ko(Ve)),De(Ve,D.FORBID_CONTENTS,wn)),se&&(at["#text"]=!0),I&&De(at,["html","head","body"]),at.table&&(De(at,["tbody"]),delete N.tbody),D.TRUSTED_TYPES_POLICY){if(typeof D.TRUSTED_TYPES_POLICY.createHTML!="function")throw vc('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof D.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw vc('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');H=D.TRUSTED_TYPES_POLICY,L=H.createHTML("")}else H===void 0&&(H=FW(f,i)),H!==null&&typeof L=="string"&&(L=H.createHTML(""));Kn&&Kn(D),Ml=D}},L_=De({},[...AC,...NC,...IW]),$_=De({},[...DC,...PW]),QF=function(D){let J=M(D);(!J||!J.tagName)&&(J={namespaceURI:_t,tagName:"template"});const me=Lg(D.tagName),Mt=Lg(J.tagName);return Xe[D.namespaceURI]?D.namespaceURI===un?J.namespaceURI===yt?me==="svg":J.namespaceURI===li?me==="svg"&&(Mt==="annotation-xml"||Fn[Mt]):!!L_[me]:D.namespaceURI===li?J.namespaceURI===yt?me==="math":J.namespaceURI===un?me==="math"&&ua[Mt]:!!$_[me]:D.namespaceURI===yt?J.namespaceURI===un&&!ua[Mt]||J.namespaceURI===li&&!Fn[Mt]?!1:!$_[me]&&(Jd[me]||!L_[me]):!!(fc==="application/xhtml+xml"&&Xe[D.namespaceURI]):!1},Ni=function(D){pc(e.removed,{element:D});try{M(D).removeChild(D)}catch{b(D)}},Il=function(D,J){try{pc(e.removed,{attribute:J.getAttributeNode(D),from:J})}catch{pc(e.removed,{attribute:null,from:J})}if(J.removeAttribute(D),D==="is")if(x||$)try{Ni(J)}catch{}else try{J.setAttribute(D,"")}catch{}},F_=function(D){let J=null,me=null;if(W)D="<remove></remove>"+D;else{const cn=cO(D,/^[\r\n\t ]+/);me=cn&&cn[0]}fc==="application/xhtml+xml"&&_t===yt&&(D='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+D+"</body></html>");const Mt=H?H.createHTML(D):D;if(_t===yt)try{J=new d().parseFromString(Mt,fc)}catch{}if(!J||!J.documentElement){J=P.createDocument(_t,"template",null);try{J.documentElement.innerHTML=gt?L:Mt}catch{}}const Tn=J.body||J.documentElement;return D&&me&&Tn.insertBefore(n.createTextNode(me),Tn.childNodes[0]||null),_t===yt?K.call(J,I?"html":"body")[0]:I?J.documentElement:Tn},V_=function(D){return O.call(D.ownerDocument||D,D,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},sw=function(D){return D instanceof h&&(typeof D.nodeName!="string"||typeof D.textContent!="string"||typeof D.removeChild!="function"||!(D.attributes instanceof c)||typeof D.removeAttribute!="function"||typeof D.setAttribute!="function"||typeof D.namespaceURI!="string"||typeof D.insertBefore!="function"||typeof D.hasChildNodes!="function")},W_=function(D){return typeof a=="function"&&D instanceof a};function bo(we,D,J){ef(we,me=>{me.call(e,D,J,Ml)})}const B_=function(D){let J=null;if(bo(Q.beforeSanitizeElements,D,null),sw(D))return Ni(D),!0;const me=wn(D.nodeName);if(bo(Q.uponSanitizeElement,D,{tagName:me,allowedTags:at}),T&&D.hasChildNodes()&&!W_(D.firstElementChild)&&Vn(/<[/\w!]/g,D.innerHTML)&&Vn(/<[/\w!]/g,D.textContent)||D.nodeType===yc.progressingInstruction||T&&D.nodeType===yc.comment&&Vn(/<[/\w]/g,D.data))return Ni(D),!0;if(!at[me]||N[me]){if(!N[me]&&U_(me)&&(y.tagNameCheck instanceof RegExp&&Vn(y.tagNameCheck,me)||y.tagNameCheck instanceof Function&&y.tagNameCheck(me)))return!1;if(se&&!Ve[me]){const Mt=M(D)||D.parentNode,Tn=C(D)||D.childNodes;if(Tn&&Mt){const cn=Tn.length;for(let Jn=cn-1;Jn>=0;--Jn){const So=w(Tn[Jn],!0);So.__removalCount=(D.__removalCount||0)+1,Mt.insertBefore(So,E(D))}}}return Ni(D),!0}return D instanceof l&&!QF(D)||(me==="noscript"||me==="noembed"||me==="noframes")&&Vn(/<\/no(script|embed|frames)/i,D.innerHTML)?(Ni(D),!0):(R&&D.nodeType===yc.text&&(J=D.textContent,ef([X,ae,ee],Mt=>{J=wc(J,Mt," ")}),D.textContent!==J&&(pc(e.removed,{element:D.cloneNode()}),D.textContent=J)),bo(Q.afterSanitizeElements,D,null),!1)},j_=function(D,J,me){if(j&&(J==="id"||J==="name")&&(me in n||me in ZF))return!1;if(!(G&&!F[J]&&Vn(ce,J))){if(!(B&&Vn(vt,J))){if(!g[J]||F[J]){if(!(U_(D)&&(y.tagNameCheck instanceof RegExp&&Vn(y.tagNameCheck,D)||y.tagNameCheck instanceof Function&&y.tagNameCheck(D))&&(y.attributeNameCheck instanceof RegExp&&Vn(y.attributeNameCheck,J)||y.attributeNameCheck instanceof Function&&y.attributeNameCheck(J))||J==="is"&&y.allowCustomizedBuiltInElements&&(y.tagNameCheck instanceof RegExp&&Vn(y.tagNameCheck,me)||y.tagNameCheck instanceof Function&&y.tagNameCheck(me))))return!1}else if(!Qn[J]){if(!Vn(rt,wc(me,$e,""))){if(!((J==="src"||J==="xlink:href"||J==="href")&&D!=="script"&&EW(me,"data:")===0&&be[D])){if(!(v&&!Vn(Ne,wc(me,$e,"")))){if(me)return!1}}}}}}return!0},U_=function(D){return D!=="annotation-xml"&&cO(D,Ct)},z_=function(D){bo(Q.beforeSanitizeAttributes,D,null);const{attributes:J}=D;if(!J||sw(D))return;const me={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:g,forceKeepAttr:void 0};let Mt=J.length;for(;Mt--;){const Tn=J[Mt],{name:cn,namespaceURI:Jn,value:So}=Tn,gc=wn(cn),aw=So;let _n=cn==="value"?aw:TW(aw);if(me.attrName=gc,me.attrValue=_n,me.keepAttr=!0,me.forceKeepAttr=void 0,bo(Q.uponSanitizeAttribute,D,me),_n=me.attrValue,U&&(gc==="id"||gc==="name")&&(Il(cn,D),_n=ie+_n),T&&Vn(/((--!?|])>)|<\/(style|title)/i,_n)){Il(cn,D);continue}if(me.forceKeepAttr)continue;if(!me.keepAttr){Il(cn,D);continue}if(!S&&Vn(/\/>/i,_n)){Il(cn,D);continue}R&&ef([X,ae,ee],G_=>{_n=wc(_n,G_," ")});const Y_=wn(D.nodeName);if(!j_(Y_,gc,_n)){Il(cn,D);continue}if(H&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Jn)switch(f.getAttributeType(Y_,gc)){case"TrustedHTML":{_n=H.createHTML(_n);break}case"TrustedScriptURL":{_n=H.createScriptURL(_n);break}}if(_n!==aw)try{Jn?D.setAttributeNS(Jn,cn,_n):D.setAttribute(cn,_n),sw(D)?Ni(D):uO(e.removed)}catch{Il(cn,D)}}bo(Q.afterSanitizeAttributes,D,null)},JF=function we(D){let J=null;const me=V_(D);for(bo(Q.beforeSanitizeShadowDOM,D,null);J=me.nextNode();)bo(Q.uponSanitizeShadowNode,J,null),B_(J),z_(J),J.content instanceof o&&we(J.content);bo(Q.afterSanitizeShadowDOM,D,null)};return e.sanitize=function(we){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},J=null,me=null,Mt=null,Tn=null;if(gt=!we,gt&&(we="<!-->"),typeof we!="string"&&!W_(we))if(typeof we.toString=="function"){if(we=we.toString(),typeof we!="string")throw vc("dirty is not a string, aborting")}else throw vc("toString is not a function");if(!e.isSupported)return we;if(k||ow(D),e.removed=[],typeof we=="string"&&(Se=!1),Se){if(we.nodeName){const So=wn(we.nodeName);if(!at[So]||N[So])throw vc("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof a)J=F_("<!---->"),me=J.ownerDocument.importNode(we,!0),me.nodeType===yc.element&&me.nodeName==="BODY"||me.nodeName==="HTML"?J=me:J.appendChild(me);else{if(!x&&!R&&!I&&we.indexOf("<")===-1)return H&&V?H.createHTML(we):we;if(J=F_(we),!J)return x?null:V?L:""}J&&W&&Ni(J.firstChild);const cn=V_(Se?we:J);for(;Mt=cn.nextNode();)B_(Mt),z_(Mt),Mt.content instanceof o&&JF(Mt.content);if(Se)return we;if(x){if($)for(Tn=z.call(J.ownerDocument);J.firstChild;)Tn.appendChild(J.firstChild);else Tn=J;return(g.shadowroot||g.shadowrootmode)&&(Tn=A.call(r,Tn,!0)),Tn}let Jn=I?J.outerHTML:J.innerHTML;return I&&at["!doctype"]&&J.ownerDocument&&J.ownerDocument.doctype&&J.ownerDocument.doctype.name&&Vn(ON,J.ownerDocument.doctype.name)&&(Jn="<!DOCTYPE "+J.ownerDocument.doctype.name+`>
`+Jn),R&&ef([X,ae,ee],So=>{Jn=wc(Jn,So," ")}),H&&V?H.createHTML(Jn):Jn},e.setConfig=function(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ow(we),k=!0},e.clearConfig=function(){Ml=null,k=!1},e.isValidAttribute=function(we,D,J){Ml||ow({});const me=wn(we),Mt=wn(D);return j_(me,Mt,J)},e.addHook=function(we,D){typeof D=="function"&&pc(Q[we],D)},e.removeHook=function(we,D){if(D!==void 0){const J=SW(Q[we],D);return J===-1?void 0:RW(Q[we],J,1)[0]}return uO(Q[we])},e.removeHooks=function(we){Q[we]=[]},e.removeAllHooks=function(){Q=pO()},e}var VW=xN();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var HN;function q(){return HN.apply(null,arguments)}function WW(t){HN=t}function Pi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function sl(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function UR(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ze(t,e))return!1;return!0}function lr(t){return t===void 0}function ts(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Od(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function AN(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Fs(t,e){for(var n in e)Ze(e,n)&&(t[n]=e[n]);return Ze(e,"toString")&&(t.toString=e.toString),Ze(e,"valueOf")&&(t.valueOf=e.valueOf),t}function po(t,e,n,r){return nD(t,e,n,r,!0).utc()}function BW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ie(t){return t._pf==null&&(t._pf=BW()),t._pf}var yS;Array.prototype.some?yS=Array.prototype.some:yS=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function zR(t){var e=null,n=!1,r=t._d&&!isNaN(t._d.getTime());if(r&&(e=Ie(t),n=yS.call(e.parsedDateParts,function(i){return i!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r;return t._isValid}function ap(t){var e=po(NaN);return t!=null?Fs(Ie(e),t):Ie(e).userInvalidated=!0,e}var wO=q.momentProperties=[],LC=!1;function YR(t,e){var n,r,i,o=wO.length;if(lr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),lr(e._i)||(t._i=e._i),lr(e._f)||(t._f=e._f),lr(e._l)||(t._l=e._l),lr(e._strict)||(t._strict=e._strict),lr(e._tzm)||(t._tzm=e._tzm),lr(e._isUTC)||(t._isUTC=e._isUTC),lr(e._offset)||(t._offset=e._offset),lr(e._pf)||(t._pf=Ie(e)),lr(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=wO[n],i=e[r],lr(i)||(t[r]=i);return t}function xd(t){YR(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),LC===!1&&(LC=!0,q.updateOffset(this),LC=!1)}function Oi(t){return t instanceof xd||t!=null&&t._isAMomentObject!=null}function NN(t){q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function ri(t,e){var n=!0;return Fs(function(){if(q.deprecationHandler!=null&&q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])Ze(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}NN(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var vO={};function DN(t,e){q.deprecationHandler!=null&&q.deprecationHandler(t,e),vO[t]||(NN(e),vO[t]=!0)}q.suppressDeprecationWarnings=!1;q.deprecationHandler=null;function wo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function jW(t){var e,n;for(n in t)Ze(t,n)&&(e=t[n],wo(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function bS(t,e){var n=Fs({},t),r;for(r in e)Ze(e,r)&&(sl(t[r])&&sl(e[r])?(n[r]={},Fs(n[r],t[r]),Fs(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)Ze(t,r)&&!Ze(e,r)&&sl(t[r])&&(n[r]=Fs({},n[r]));return n}function GR(t){t!=null&&this.set(t)}var SS;Object.keys?SS=Object.keys:SS=function(t){var e,n=[];for(e in t)Ze(t,e)&&n.push(e);return n};var UW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zW(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return wo(r)?r.call(e,n):r}function ho(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var qR=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,nf=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,$C={},Ou={};function ve(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Ou[t]=i),e&&(Ou[e[0]]=function(){return ho(i.apply(this,arguments),e[1],e[2])}),n&&(Ou[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function YW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function GW(t){var e=t.match(qR),n,r;for(n=0,r=e.length;n<r;n++)Ou[e[n]]?e[n]=Ou[e[n]]:e[n]=YW(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=wo(e[s])?e[s].call(i,t):e[s];return o}}function $g(t,e){return t.isValid()?(e=kN(e,t.localeData()),$C[e]=$C[e]||GW(e),$C[e](t)):t.localeData().invalidDate()}function kN(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(nf.lastIndex=0;n>=0&&nf.test(t);)t=t.replace(nf,r),nf.lastIndex=0,n-=1;return t}var qW={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function KW(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(qR).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var XW="Invalid date";function ZW(){return this._invalidDate}var QW="%d",JW=/\d{1,2}/;function eB(t){return this._ordinal.replace("%d",t)}var tB={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function nB(t,e,n,r){var i=this._relativeTime[n];return wo(i)?i(t,e,n,r):i.replace(/%d/i,t)}function rB(t,e){var n=this._relativeTime[t>0?"future":"past"];return wo(n)?n(e):n.replace(/%s/i,e)}var CO={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ii(t){return typeof t=="string"?CO[t]||CO[t.toLowerCase()]:void 0}function KR(t){var e={},n,r;for(r in t)Ze(t,r)&&(n=ii(r),n&&(e[n]=t[r]));return e}var iB={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function oB(t){var e=[],n;for(n in t)Ze(t,n)&&e.push({unit:n,priority:iB[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}var LN=/\d/,Hr=/\d\d/,$N=/\d{3}/,XR=/\d{4}/,lp=/[+-]?\d{6}/,Tt=/\d\d?/,FN=/\d\d\d\d?/,VN=/\d\d\d\d\d\d?/,up=/\d{1,3}/,ZR=/\d{1,4}/,cp=/[+-]?\d{1,6}/,nc=/\d+/,hp=/[+-]?\d+/,sB=/Z|[+-]\d\d:?\d\d/gi,dp=/Z|[+-]\d\d(?::?\d\d)?/gi,aB=/[+-]?\d+(\.\d{1,3})?/,Hd=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,rc=/^[1-9]\d?/,QR=/^([1-9]\d|\d)/,om;om={};function ue(t,e,n){om[t]=wo(e)?e:function(r,i){return r&&n?n:e}}function lB(t,e){return Ze(om,t)?om[t](e._strict,e._locale):new RegExp(uB(t))}function uB(t){return Jo(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function Jo(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function qr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Be(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=qr(e)),n}var RS={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),ts(e)&&(r=function(o,s){s[e]=Be(o)}),i=t.length,n=0;n<i;n++)RS[t[n]]=r}function Ad(t,e){ht(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function cB(t,e,n){e!=null&&Ze(RS,t)&&RS[t](e,n._a,n,t)}function fp(t){return t%4===0&&t%100!==0||t%400===0}var kn=0,Yo=1,oo=2,gn=3,Ti=4,Go=5,Ja=6,hB=7,dB=8;ve("Y",0,0,function(){var t=this.year();return t<=9999?ho(t,4):"+"+t});ve(0,["YY",2],0,function(){return this.year()%100});ve(0,["YYYY",4],0,"year");ve(0,["YYYYY",5],0,"year");ve(0,["YYYYYY",6,!0],0,"year");ue("Y",hp);ue("YY",Tt,Hr);ue("YYYY",ZR,XR);ue("YYYYY",cp,lp);ue("YYYYYY",cp,lp);ht(["YYYYY","YYYYYY"],kn);ht("YYYY",function(t,e){e[kn]=t.length===2?q.parseTwoDigitYear(t):Be(t)});ht("YY",function(t,e){e[kn]=q.parseTwoDigitYear(t)});ht("Y",function(t,e){e[kn]=parseInt(t,10)});function _h(t){return fp(t)?366:365}q.parseTwoDigitYear=function(t){return Be(t)+(Be(t)>68?1900:2e3)};var WN=ic("FullYear",!0);function fB(){return fp(this.year())}function ic(t,e){return function(n){return n!=null?(BN(this,t,n),q.updateOffset(this,e),this):Zh(this,t)}}function Zh(t,e){if(!t.isValid())return NaN;var n=t._d,r=t._isUTC;switch(e){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function BN(t,e,n){var r,i,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(r=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!fp(o)?28:a,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function gB(t){return t=ii(t),wo(this[t])?this[t]():this}function mB(t,e){if(typeof t=="object"){t=KR(t);var n=oB(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=ii(t),wo(this[t]))return this[t](e);return this}function pB(t,e){return(t%e+e)%e}var Gt;Array.prototype.indexOf?Gt=Array.prototype.indexOf:Gt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function JR(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=pB(e,12);return t+=(e-n)/12,n===1?fp(t)?29:28:31-n%7%2}ve("M",["MM",2],"Mo",function(){return this.month()+1});ve("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ve("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",Tt,rc);ue("MM",Tt,Hr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[Yo]=Be(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Yo]=i:Ie(n).invalidMonth=t});var wB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),UN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vB=Hd,CB=Hd;function yB(t,e){return t?Pi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||UN).test(e)?"format":"standalone"][t.month()]:Pi(this._months)?this._months:this._months.standalone}function bB(t,e){return t?Pi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[UN.test(e)?"format":"standalone"][t.month()]:Pi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function SB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=po([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:(i=Gt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Gt.call(this._longMonthsParse,s),i!==-1?i:(i=Gt.call(this._shortMonthsParse,s),i!==-1?i:null))}function RB(t,e,n){var r,i,o;if(this._monthsParseExact)return SB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=po([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function zN(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Be(e);else if(e=t.localeData().monthsParse(e),!ts(e))return t}var n=e,r=t.date();return r=r<29?r:Math.min(r,JR(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,r):t._d.setMonth(n,r),t}function YN(t){return t!=null?(zN(this,t),q.updateOffset(this,!0),this):Zh(this,"Month")}function EB(){return JR(this.year(),this.month())}function TB(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||GN.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ze(this,"_monthsShortRegex")||(this._monthsShortRegex=vB),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function _B(t){return this._monthsParseExact?(Ze(this,"_monthsRegex")||GN.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ze(this,"_monthsRegex")||(this._monthsRegex=CB),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function GN(){function t(l,u){return u.length-l.length}var e=[],n=[],r=[],i,o,s,a;for(i=0;i<12;i++)o=po([2e3,i]),s=Jo(this.monthsShort(o,"")),a=Jo(this.months(o,"")),e.push(s),n.push(a),r.push(a),r.push(s);e.sort(t),n.sort(t),r.sort(t),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function MB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Qh(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function sm(t,e,n){var r=7+e-n,i=(7+Qh(t,0,r).getUTCDay()-e)%7;return-i+r-1}function qN(t,e,n,r,i){var o=(7+n-r)%7,s=sm(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=_h(l)+a):a>_h(t)?(l=t+1,u=a-_h(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Jh(t,e,n){var r=sm(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+es(s,e,n)):i>es(t.year(),e,n)?(o=i-es(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function es(t,e,n){var r=sm(t,e,n),i=sm(t+1,e,n);return(_h(t)-r+i)/7}ve("w",["ww",2],"wo","week");ve("W",["WW",2],"Wo","isoWeek");ue("w",Tt,rc);ue("ww",Tt,Hr);ue("W",Tt,rc);ue("WW",Tt,Hr);Ad(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Be(t)});function IB(t){return Jh(t,this._week.dow,this._week.doy).week}var PB={dow:0,doy:6};function OB(){return this._week.dow}function xB(){return this._week.doy}function HB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function AB(t){var e=Jh(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ve("d",0,"do","day");ve("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ve("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ve("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ve("e",0,0,"weekday");ve("E",0,0,"isoWeekday");ue("d",Tt);ue("e",Tt);ue("E",Tt);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});Ad(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ie(n).invalidWeekday=t});Ad(["d","e","E"],function(t,e,n,r){e[r]=Be(t)});function NB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function DB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function eE(t,e){return t.slice(e,7).concat(t.slice(0,e))}var kB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),KN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),LB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),$B=Hd,FB=Hd,VB=Hd;function WB(t,e){var n=Pi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?eE(n,this._week.dow):t?n[t.day()]:n}function BB(t){return t===!0?eE(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function jB(t){return t===!0?eE(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function UB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=po([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Gt.call(this._weekdaysParse,s),i!==-1||(i=Gt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Gt.call(this._shortWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Gt.call(this._minWeekdaysParse,s),i!==-1||(i=Gt.call(this._weekdaysParse,s),i!==-1)?i:(i=Gt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function zB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return UB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=po([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function YB(t){if(!this.isValid())return t!=null?this:NaN;var e=Zh(this,"Day");return t!=null?(t=NB(t,this.localeData()),this.add(t-e,"d")):e}function GB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function qB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=DB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function KB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||tE.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ze(this,"_weekdaysRegex")||(this._weekdaysRegex=$B),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function XB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||tE.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ze(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=FB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ZB(t){return this._weekdaysParseExact?(Ze(this,"_weekdaysRegex")||tE.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ze(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function tE(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=po([2e3,1]).day(o),a=Jo(this.weekdaysMin(s,"")),l=Jo(this.weekdaysShort(s,"")),u=Jo(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function nE(){return this.hours()%12||12}function QB(){return this.hours()||24}ve("H",["HH",2],0,"hour");ve("h",["hh",2],0,nE);ve("k",["kk",2],0,QB);ve("hmm",0,0,function(){return""+nE.apply(this)+ho(this.minutes(),2)});ve("hmmss",0,0,function(){return""+nE.apply(this)+ho(this.minutes(),2)+ho(this.seconds(),2)});ve("Hmm",0,0,function(){return""+this.hours()+ho(this.minutes(),2)});ve("Hmmss",0,0,function(){return""+this.hours()+ho(this.minutes(),2)+ho(this.seconds(),2)});function XN(t,e){ve(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}XN("a",!0);XN("A",!1);function ZN(t,e){return e._meridiemParse}ue("a",ZN);ue("A",ZN);ue("H",Tt,QR);ue("h",Tt,rc);ue("k",Tt,rc);ue("HH",Tt,Hr);ue("hh",Tt,Hr);ue("kk",Tt,Hr);ue("hmm",FN);ue("hmmss",VN);ue("Hmm",FN);ue("Hmmss",VN);ht(["H","HH"],gn);ht(["k","kk"],function(t,e,n){var r=Be(t);e[gn]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[gn]=Be(t),Ie(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[gn]=Be(t.substr(0,r)),e[Ti]=Be(t.substr(r)),Ie(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[gn]=Be(t.substr(0,r)),e[Ti]=Be(t.substr(r,2)),e[Go]=Be(t.substr(i)),Ie(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[gn]=Be(t.substr(0,r)),e[Ti]=Be(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[gn]=Be(t.substr(0,r)),e[Ti]=Be(t.substr(r,2)),e[Go]=Be(t.substr(i))});function JB(t){return(t+"").toLowerCase().charAt(0)==="p"}var ej=/[ap]\.?m?\.?/i,tj=ic("Hours",!0);function nj(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var QN={calendar:UW,longDateFormat:qW,invalidDate:XW,ordinal:QW,dayOfMonthOrdinalParse:JW,relativeTime:tB,months:wB,monthsShort:jN,week:PB,weekdays:kB,weekdaysMin:LB,weekdaysShort:KN,meridiemParse:ej},It={},bc={},ed;function rj(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function yO(t){return t&&t.toLowerCase().replace("_","-")}function ij(t){for(var e=0,n,r,i,o;e<t.length;){for(o=yO(t[e]).split("-"),n=o.length,r=yO(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=gp(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&rj(o,r)>=n-1)break;n--}e++}return ed}function oj(t){return!!(t&&t.match("^[^/\\\\]*$"))}function gp(t){var e=null,n;if(It[t]===void 0&&typeof module<"u"&&module&&module.exports&&oj(t))try{e=ed._abbr,n=require,n("./locale/"+t),Ys(e)}catch{It[t]=null}return It[t]}function Ys(t,e){var n;return t&&(lr(e)?n=os(t):n=rE(t,e),n?ed=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),ed._abbr}function rE(t,e){if(e!==null){var n,r=QN;if(e.abbr=t,It[t]!=null)DN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=gp(e.parentLocale),n!=null)r=n._config;else return bc[e.parentLocale]||(bc[e.parentLocale]=[]),bc[e.parentLocale].push({name:t,config:e}),null;return It[t]=new GR(bS(r,e)),bc[t]&&bc[t].forEach(function(i){rE(i.name,i.config)}),Ys(t),It[t]}else return delete It[t],null}function sj(t,e){if(e!=null){var n,r,i=QN;It[t]!=null&&It[t].parentLocale!=null?It[t].set(bS(It[t]._config,e)):(r=gp(t),r!=null&&(i=r._config),e=bS(i,e),r==null&&(e.abbr=t),n=new GR(e),n.parentLocale=It[t],It[t]=n),Ys(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===Ys()&&Ys(t)):It[t]!=null&&delete It[t]);return It[t]}function os(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return ed;if(!Pi(t)){if(e=gp(t),e)return e;t=[t]}return ij(t)}function aj(){return SS(It)}function iE(t){var e,n=t._a;return n&&Ie(t).overflow===-2&&(e=n[Yo]<0||n[Yo]>11?Yo:n[oo]<1||n[oo]>JR(n[kn],n[Yo])?oo:n[gn]<0||n[gn]>24||n[gn]===24&&(n[Ti]!==0||n[Go]!==0||n[Ja]!==0)?gn:n[Ti]<0||n[Ti]>59?Ti:n[Go]<0||n[Go]>59?Go:n[Ja]<0||n[Ja]>999?Ja:-1,Ie(t)._overflowDayOfYear&&(e<kn||e>oo)&&(e=oo),Ie(t)._overflowWeeks&&e===-1&&(e=hB),Ie(t)._overflowWeekday&&e===-1&&(e=dB),Ie(t).overflow=e),t}var lj=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,uj=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cj=/Z|[+-]\d\d(?::?\d\d)?/,rf=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],FC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],hj=/^\/?Date\((-?\d+)/i,dj=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,fj={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function JN(t){var e,n,r=t._i,i=lj.exec(r)||uj.exec(r),o,s,a,l,u=rf.length,c=FC.length;if(i){for(Ie(t).iso=!0,e=0,n=u;e<n;e++)if(rf[e][1].exec(i[1])){s=rf[e][0],o=rf[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(FC[e][1].exec(i[3])){a=(i[2]||" ")+FC[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(cj.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),sE(t)}else t._isValid=!1}function gj(t,e,n,r,i,o){var s=[mj(t),jN.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function mj(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function pj(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function wj(t,e,n){if(t){var r=KN.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ie(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function vj(t,e,n){if(t)return fj[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function eD(t){var e=dj.exec(pj(t._i)),n;if(e){if(n=gj(e[4],e[3],e[2],e[5],e[6],e[7]),!wj(e[1],n,t))return;t._a=n,t._tzm=vj(e[8],e[9],e[10]),t._d=Qh.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ie(t).rfc2822=!0}else t._isValid=!1}function Cj(t){var e=hj.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(JN(t),t._isValid===!1)delete t._isValid;else return;if(eD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:q.createFromInputFallback(t)}q.createFromInputFallback=ri("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function mu(t,e,n){return t??e??n}function yj(t){var e=new Date(q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function oE(t){var e,n,r=[],i,o,s;if(!t._d){for(i=yj(t),t._w&&t._a[oo]==null&&t._a[Yo]==null&&bj(t),t._dayOfYear!=null&&(s=mu(t._a[kn],i[kn]),(t._dayOfYear>_h(s)||t._dayOfYear===0)&&(Ie(t)._overflowDayOfYear=!0),n=Qh(s,0,t._dayOfYear),t._a[Yo]=n.getUTCMonth(),t._a[oo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[gn]===24&&t._a[Ti]===0&&t._a[Go]===0&&t._a[Ja]===0&&(t._nextDay=!0,t._a[gn]=0),t._d=(t._useUTC?Qh:MB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[gn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ie(t).weekdayMismatch=!0)}}function bj(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=mu(e.GG,t._a[kn],Jh(Et(),1,4).year),r=mu(e.W,1),i=mu(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Jh(Et(),o,s),n=mu(e.gg,t._a[kn],u.year),r=mu(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>es(n,o,s)?Ie(t)._overflowWeeks=!0:l!=null?Ie(t)._overflowWeekday=!0:(a=qN(n,r,i,o,s),t._a[kn]=a.year,t._dayOfYear=a.dayOfYear)}q.ISO_8601=function(){};q.RFC_2822=function(){};function sE(t){if(t._f===q.ISO_8601){JN(t);return}if(t._f===q.RFC_2822){eD(t);return}t._a=[],Ie(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=kN(t._f,t._locale).match(qR)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(lB(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ie(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Ou[o]?(r?Ie(t).empty=!1:Ie(t).unusedTokens.push(o),cB(o,r,t)):t._strict&&!r&&Ie(t).unusedTokens.push(o);Ie(t).charsLeftOver=a-l,e.length>0&&Ie(t).unusedInput.push(e),t._a[gn]<=12&&Ie(t).bigHour===!0&&t._a[gn]>0&&(Ie(t).bigHour=void 0),Ie(t).parsedDateParts=t._a.slice(0),Ie(t).meridiem=t._meridiem,t._a[gn]=Sj(t._locale,t._a[gn],t._meridiem),u=Ie(t).era,u!==null&&(t._a[kn]=t._locale.erasConvertYear(u,t._a[kn])),oE(t),iE(t)}function Sj(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function Rj(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ie(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=YR({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],sE(e),zR(e)&&(s=!0),o+=Ie(e).charsLeftOver,o+=Ie(e).unusedTokens.length*10,Ie(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Fs(t,n||e)}function Ej(t){if(!t._d){var e=KR(t._i),n=e.day===void 0?e.date:e.day;t._a=AN([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),oE(t)}}function Tj(t){var e=new xd(iE(tD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function tD(t){var e=t._i,n=t._f;return t._locale=t._locale||os(t._l),e===null||n===void 0&&e===""?ap({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Oi(e)?new xd(iE(e)):(Od(e)?t._d=e:Pi(n)?Rj(t):n?sE(t):_j(t),zR(t)||(t._d=null),t))}function _j(t){var e=t._i;lr(e)?t._d=new Date(q.now()):Od(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Cj(t):Pi(e)?(t._a=AN(e.slice(0),function(n){return parseInt(n,10)}),oE(t)):sl(e)?Ej(t):ts(e)?t._d=new Date(e):q.createFromInputFallback(t)}function nD(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(sl(t)&&UR(t)||Pi(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,Tj(o)}function Et(t,e,n,r){return nD(t,e,n,r,!1)}var Mj=ri("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:ap()}),Ij=ri("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:ap()});function rD(t,e){var n,r;if(e.length===1&&Pi(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function Pj(){var t=[].slice.call(arguments,0);return rD("isBefore",t)}function Oj(){var t=[].slice.call(arguments,0);return rD("isAfter",t)}var xj=function(){return Date.now?Date.now():+new Date},Sc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Hj(t){var e,n=!1,r,i=Sc.length;for(e in t)if(Ze(t,e)&&!(Gt.call(Sc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Sc[r]]){if(n)return!1;parseFloat(t[Sc[r]])!==Be(t[Sc[r]])&&(n=!0)}return!0}function Aj(){return this._isValid}function Nj(){return Ai(NaN)}function mp(t){var e=KR(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=Hj(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=os(),this._bubble()}function Fg(t){return t instanceof mp}function ES(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Dj(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)Be(t[s])!==Be(e[s])&&o++;return o+i}function iD(t,e){ve(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+ho(~~(n/60),2)+e+ho(~~n%60,2)})}iD("Z",":");iD("ZZ","");ue("Z",dp);ue("ZZ",dp);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=aE(dp,t)});var kj=/([\+\-]|\d\d)/gi;function aE(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(kj)||["-",0,0],o=+(i[1]*60)+Be(i[2]),o===0?0:i[0]==="+"?o:-o)}function lE(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Oi(t)||Od(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),q.updateOffset(n,!1),n):Et(t).local()}function TS(t){return-Math.round(t._d.getTimezoneOffset())}q.updateOffset=function(){};function Lj(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=aE(dp,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=TS(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?aD(this,Ai(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:TS(this)}function $j(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Fj(t){return this.utcOffset(0,t)}function Vj(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(TS(this),"m")),this}function Wj(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=aE(sB,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Bj(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function jj(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Uj(){if(!lr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return YR(t,this),t=tD(t),t._a?(e=t._isUTC?po(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&Dj(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function zj(){return this.isValid()?!this._isUTC:!1}function Yj(){return this.isValid()?this._isUTC:!1}function oD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Gj=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,qj=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ai(t,e){var n=t,r=null,i,o,s;return Fg(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:ts(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=Gj.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Be(r[oo])*i,h:Be(r[gn])*i,m:Be(r[Ti])*i,s:Be(r[Go])*i,ms:Be(ES(r[Ja]*1e3))*i}):(r=qj.exec(t))?(i=r[1]==="-"?-1:1,n={y:ca(r[2],i),M:ca(r[3],i),w:ca(r[4],i),d:ca(r[5],i),h:ca(r[6],i),m:ca(r[7],i),s:ca(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=Kj(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new mp(n),Fg(t)&&Ze(t,"_locale")&&(o._locale=t._locale),Fg(t)&&Ze(t,"_isValid")&&(o._isValid=t._isValid),o}Ai.fn=mp.prototype;Ai.invalid=Nj;function ca(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function bO(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Kj(t,e){var n;return t.isValid()&&e.isValid()?(e=lE(e,t),t.isBefore(e)?n=bO(t,e):(n=bO(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function sD(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(DN(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Ai(n,r),aD(this,i,t),this}}function aD(t,e,n,r){var i=e._milliseconds,o=ES(e._days),s=ES(e._months);t.isValid()&&(r=r??!0,s&&zN(t,Zh(t,"Month")+s*n),o&&BN(t,"Date",Zh(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&q.updateOffset(t,o||s))}var Xj=sD(1,"add"),Zj=sD(-1,"subtract");function lD(t){return typeof t=="string"||t instanceof String}function Qj(t){return Oi(t)||Od(t)||lD(t)||ts(t)||eU(t)||Jj(t)||t===null||t===void 0}function Jj(t){var e=sl(t)&&!UR(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function eU(t){var e=Pi(t),n=!1;return e&&(n=t.filter(function(r){return!ts(r)&&lD(t)}).length===0),e&&n}function tU(t){var e=sl(t)&&!UR(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||Ze(t,o);return e&&n}function nU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function rU(t,e){arguments.length===1&&(arguments[0]?Qj(arguments[0])?(t=arguments[0],e=void 0):tU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=lE(n,this).startOf("day"),i=q.calendarFormat(this,r)||"sameElse",o=e&&(wo(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function iU(){return new xd(this)}function oU(t,e){var n=Oi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=ii(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function sU(t,e){var n=Oi(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=ii(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function aU(t,e,n,r){var i=Oi(t)?t:Et(t),o=Oi(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function lU(t,e){var n=Oi(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=ii(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function uU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function cU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function hU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=lE(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=ii(e),e){case"year":o=Vg(this,r)/12;break;case"month":o=Vg(this,r);break;case"quarter":o=Vg(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:qr(o)}function Vg(t,e){if(t.date()<e.date())return-Vg(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function dU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function fU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?$g(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):wo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",$g(n,"Z")):$g(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function mU(t){t||(t=this.isUtc()?q.defaultFormatUtc:q.defaultFormat);var e=$g(this,t);return this.localeData().postformat(e)}function pU(t,e){return this.isValid()&&(Oi(t)&&t.isValid()||Et(t).isValid())?Ai({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function wU(t){return this.from(Et(),t)}function vU(t,e){return this.isValid()&&(Oi(t)&&t.isValid()||Et(t).isValid())?Ai({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function CU(t){return this.to(Et(),t)}function uD(t){var e;return t===void 0?this._locale._abbr:(e=os(t),e!=null&&(this._locale=e),this)}var cD=ri("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function hD(){return this._locale}var am=1e3,xu=60*am,lm=60*xu,dD=(365*400+97)*24*lm;function Hu(t,e){return(t%e+e)%e}function fD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-dD:new Date(t,e,n).valueOf()}function gD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-dD:Date.UTC(t,e,n)}function yU(t){var e,n;if(t=ii(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?gD:fD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Hu(e+(this._isUTC?0:this.utcOffset()*xu),lm);break;case"minute":e=this._d.valueOf(),e-=Hu(e,xu);break;case"second":e=this._d.valueOf(),e-=Hu(e,am);break}return this._d.setTime(e),q.updateOffset(this,!0),this}function bU(t){var e,n;if(t=ii(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?gD:fD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=lm-Hu(e+(this._isUTC?0:this.utcOffset()*xu),lm)-1;break;case"minute":e=this._d.valueOf(),e+=xu-Hu(e,xu)-1;break;case"second":e=this._d.valueOf(),e+=am-Hu(e,am)-1;break}return this._d.setTime(e),q.updateOffset(this,!0),this}function SU(){return this._d.valueOf()-(this._offset||0)*6e4}function RU(){return Math.floor(this.valueOf()/1e3)}function EU(){return new Date(this.valueOf())}function TU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function _U(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function MU(){return this.isValid()?this.toISOString():null}function IU(){return zR(this)}function PU(){return Fs({},Ie(this))}function OU(){return Ie(this).overflow}function xU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ve("N",0,0,"eraAbbr");ve("NN",0,0,"eraAbbr");ve("NNN",0,0,"eraAbbr");ve("NNNN",0,0,"eraName");ve("NNNNN",0,0,"eraNarrow");ve("y",["y",1],"yo","eraYear");ve("y",["yy",2],0,"eraYear");ve("y",["yyy",3],0,"eraYear");ve("y",["yyyy",4],0,"eraYear");ue("N",uE);ue("NN",uE);ue("NNN",uE);ue("NNNN",BU);ue("NNNNN",jU);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ie(n).era=i:Ie(n).invalidEra=t});ue("y",nc);ue("yy",nc);ue("yyy",nc);ue("yyyy",nc);ue("yo",UU);ht(["y","yy","yyy","yyyy"],kn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[kn]=n._locale.eraYearOrdinalParse(t,i):e[kn]=parseInt(t,10)});function HU(t,e){var n,r,i,o=this._eras||os("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function AU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function NU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?q(t.since).year():q(t.since).year()+(e-t.offset)*n}function DU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function kU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function LU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function $U(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-q(i[t].since).year())*n+i[t].offset;return this.year()}function FU(t){return Ze(this,"_erasNameRegex")||cE.call(this),t?this._erasNameRegex:this._erasRegex}function VU(t){return Ze(this,"_erasAbbrRegex")||cE.call(this),t?this._erasAbbrRegex:this._erasRegex}function WU(t){return Ze(this,"_erasNarrowRegex")||cE.call(this),t?this._erasNarrowRegex:this._erasRegex}function uE(t,e){return e.erasAbbrRegex(t)}function BU(t,e){return e.erasNameRegex(t)}function jU(t,e){return e.erasNarrowRegex(t)}function UU(t,e){return e._eraYearOrdinalRegex||nc}function cE(){var t=[],e=[],n=[],r=[],i,o,s,a,l,u=this.eras();for(i=0,o=u.length;i<o;++i)s=Jo(u[i].name),a=Jo(u[i].abbr),l=Jo(u[i].narrow),e.push(s),t.push(a),n.push(l),r.push(s),r.push(a),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ve(0,["gg",2],0,function(){return this.weekYear()%100});ve(0,["GG",2],0,function(){return this.isoWeekYear()%100});function pp(t,e){ve(0,[t,t.length],0,e)}pp("gggg","weekYear");pp("ggggg","weekYear");pp("GGGG","isoWeekYear");pp("GGGGG","isoWeekYear");ue("G",hp);ue("g",hp);ue("GG",Tt,Hr);ue("gg",Tt,Hr);ue("GGGG",ZR,XR);ue("gggg",ZR,XR);ue("GGGGG",cp,lp);ue("ggggg",cp,lp);Ad(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Be(t)});Ad(["gg","GG"],function(t,e,n,r){e[r]=q.parseTwoDigitYear(t)});function zU(t){return mD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function YU(t){return mD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function GU(){return es(this.year(),1,4)}function qU(){return es(this.isoWeekYear(),1,4)}function KU(){var t=this.localeData()._week;return es(this.year(),t.dow,t.doy)}function XU(){var t=this.localeData()._week;return es(this.weekYear(),t.dow,t.doy)}function mD(t,e,n,r,i){var o;return t==null?Jh(this,r,i).year:(o=es(t,r,i),e>o&&(e=o),ZU.call(this,t,e,n,r,i))}function ZU(t,e,n,r,i){var o=qN(t,e,n,r,i),s=Qh(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ve("Q",0,"Qo","quarter");ue("Q",LN);ht("Q",function(t,e){e[Yo]=(Be(t)-1)*3});function QU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ve("D",["DD",2],"Do","date");ue("D",Tt,rc);ue("DD",Tt,Hr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],oo);ht("Do",function(t,e){e[oo]=Be(t.match(Tt)[0])});var pD=ic("Date",!0);ve("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",up);ue("DDDD",$N);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Be(t)});function JU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ve("m",["mm",2],0,"minute");ue("m",Tt,QR);ue("mm",Tt,Hr);ht(["m","mm"],Ti);var ez=ic("Minutes",!1);ve("s",["ss",2],0,"second");ue("s",Tt,QR);ue("ss",Tt,Hr);ht(["s","ss"],Go);var tz=ic("Seconds",!1);ve("S",0,0,function(){return~~(this.millisecond()/100)});ve(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve(0,["SSS",3],0,"millisecond");ve(0,["SSSS",4],0,function(){return this.millisecond()*10});ve(0,["SSSSS",5],0,function(){return this.millisecond()*100});ve(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ve(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ve(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ve(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",up,LN);ue("SS",up,Hr);ue("SSS",up,$N);var Vs,wD;for(Vs="SSSS";Vs.length<=9;Vs+="S")ue(Vs,nc);function nz(t,e){e[Ja]=Be(("0."+t)*1e3)}for(Vs="S";Vs.length<=9;Vs+="S")ht(Vs,nz);wD=ic("Milliseconds",!1);ve("z",0,0,"zoneAbbr");ve("zz",0,0,"zoneName");function rz(){return this._isUTC?"UTC":""}function iz(){return this._isUTC?"Coordinated Universal Time":""}var Z=xd.prototype;Z.add=Xj;Z.calendar=rU;Z.clone=iU;Z.diff=hU;Z.endOf=bU;Z.format=mU;Z.from=pU;Z.fromNow=wU;Z.to=vU;Z.toNow=CU;Z.get=gB;Z.invalidAt=OU;Z.isAfter=oU;Z.isBefore=sU;Z.isBetween=aU;Z.isSame=lU;Z.isSameOrAfter=uU;Z.isSameOrBefore=cU;Z.isValid=IU;Z.lang=cD;Z.locale=uD;Z.localeData=hD;Z.max=Ij;Z.min=Mj;Z.parsingFlags=PU;Z.set=mB;Z.startOf=yU;Z.subtract=Zj;Z.toArray=TU;Z.toObject=_U;Z.toDate=EU;Z.toISOString=fU;Z.inspect=gU;typeof Symbol<"u"&&Symbol.for!=null&&(Z[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Z.toJSON=MU;Z.toString=dU;Z.unix=RU;Z.valueOf=SU;Z.creationData=xU;Z.eraName=DU;Z.eraNarrow=kU;Z.eraAbbr=LU;Z.eraYear=$U;Z.year=WN;Z.isLeapYear=fB;Z.weekYear=zU;Z.isoWeekYear=YU;Z.quarter=Z.quarters=QU;Z.month=YN;Z.daysInMonth=EB;Z.week=Z.weeks=HB;Z.isoWeek=Z.isoWeeks=AB;Z.weeksInYear=KU;Z.weeksInWeekYear=XU;Z.isoWeeksInYear=GU;Z.isoWeeksInISOWeekYear=qU;Z.date=pD;Z.day=Z.days=YB;Z.weekday=GB;Z.isoWeekday=qB;Z.dayOfYear=JU;Z.hour=Z.hours=tj;Z.minute=Z.minutes=ez;Z.second=Z.seconds=tz;Z.millisecond=Z.milliseconds=wD;Z.utcOffset=Lj;Z.utc=Fj;Z.local=Vj;Z.parseZone=Wj;Z.hasAlignedHourOffset=Bj;Z.isDST=jj;Z.isLocal=zj;Z.isUtcOffset=Yj;Z.isUtc=oD;Z.isUTC=oD;Z.zoneAbbr=rz;Z.zoneName=iz;Z.dates=ri("dates accessor is deprecated. Use date instead.",pD);Z.months=ri("months accessor is deprecated. Use month instead",YN);Z.years=ri("years accessor is deprecated. Use year instead",WN);Z.zone=ri("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",$j);Z.isDSTShifted=ri("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Uj);function oz(t){return Et(t*1e3)}function sz(){return Et.apply(null,arguments).parseZone()}function vD(t){return t}var Qe=GR.prototype;Qe.calendar=zW;Qe.longDateFormat=KW;Qe.invalidDate=ZW;Qe.ordinal=eB;Qe.preparse=vD;Qe.postformat=vD;Qe.relativeTime=nB;Qe.pastFuture=rB;Qe.set=jW;Qe.eras=HU;Qe.erasParse=AU;Qe.erasConvertYear=NU;Qe.erasAbbrRegex=VU;Qe.erasNameRegex=FU;Qe.erasNarrowRegex=WU;Qe.months=yB;Qe.monthsShort=bB;Qe.monthsParse=RB;Qe.monthsRegex=_B;Qe.monthsShortRegex=TB;Qe.week=IB;Qe.firstDayOfYear=xB;Qe.firstDayOfWeek=OB;Qe.weekdays=WB;Qe.weekdaysMin=jB;Qe.weekdaysShort=BB;Qe.weekdaysParse=zB;Qe.weekdaysRegex=KB;Qe.weekdaysShortRegex=XB;Qe.weekdaysMinRegex=ZB;Qe.isPM=JB;Qe.meridiem=nj;function um(t,e,n,r){var i=os(),o=po().set(r,e);return i[n](o,t)}function CD(t,e,n){if(ts(t)&&(e=t,t=void 0),t=t||"",e!=null)return um(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=um(t,r,n,"month");return i}function hE(t,e,n,r){typeof t=="boolean"?(ts(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,ts(e)&&(n=e,e=void 0),e=e||"");var i=os(),o=t?i._week.dow:0,s,a=[];if(n!=null)return um(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=um(e,(s+o)%7,r,"day");return a}function az(t,e){return CD(t,e,"months")}function lz(t,e){return CD(t,e,"monthsShort")}function uz(t,e,n){return hE(t,e,n,"weekdays")}function cz(t,e,n){return hE(t,e,n,"weekdaysShort")}function hz(t,e,n){return hE(t,e,n,"weekdaysMin")}Ys("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Be(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});q.lang=ri("moment.lang is deprecated. Use moment.locale instead.",Ys);q.langData=ri("moment.langData is deprecated. Use moment.localeData instead.",os);var Ro=Math.abs;function dz(){var t=this._data;return this._milliseconds=Ro(this._milliseconds),this._days=Ro(this._days),this._months=Ro(this._months),t.milliseconds=Ro(t.milliseconds),t.seconds=Ro(t.seconds),t.minutes=Ro(t.minutes),t.hours=Ro(t.hours),t.months=Ro(t.months),t.years=Ro(t.years),this}function yD(t,e,n,r){var i=Ai(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function fz(t,e){return yD(this,t,e,1)}function gz(t,e){return yD(this,t,e,-1)}function SO(t){return t<0?Math.floor(t):Math.ceil(t)}function mz(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=SO(_S(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=qr(t/1e3),r.seconds=i%60,o=qr(i/60),r.minutes=o%60,s=qr(o/60),r.hours=s%24,e+=qr(s/24),l=qr(bD(e)),n+=l,e-=SO(_S(l)),a=qr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function bD(t){return t*4800/146097}function _S(t){return t*146097/4800}function pz(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=ii(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+bD(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(_S(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function ss(t){return function(){return this.as(t)}}var SD=ss("ms"),wz=ss("s"),vz=ss("m"),Cz=ss("h"),yz=ss("d"),bz=ss("w"),Sz=ss("M"),Rz=ss("Q"),Ez=ss("y"),Tz=SD;function _z(){return Ai(this)}function Mz(t){return t=ii(t),this.isValid()?this[t+"s"]():NaN}function bl(t){return function(){return this.isValid()?this._data[t]:NaN}}var Iz=bl("milliseconds"),Pz=bl("seconds"),Oz=bl("minutes"),xz=bl("hours"),Hz=bl("days"),Az=bl("months"),Nz=bl("years");function Dz(){return qr(this.days()/7)}var Wo=Math.round,Eu={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function kz(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function Lz(t,e,n,r){var i=Ai(t).abs(),o=Wo(i.as("s")),s=Wo(i.as("m")),a=Wo(i.as("h")),l=Wo(i.as("d")),u=Wo(i.as("M")),c=Wo(i.as("w")),h=Wo(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,kz.apply(null,d)}function $z(t){return t===void 0?Wo:typeof t=="function"?(Wo=t,!0):!1}function Fz(t,e){return Eu[t]===void 0?!1:e===void 0?Eu[t]:(Eu[t]=e,t==="s"&&(Eu.ss=e-1),!0)}function Vz(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Eu,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Eu,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=Lz(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var VC=Math.abs;function Pl(t){return(t>0)-(t<0)||+t}function wp(){if(!this.isValid())return this.localeData().invalidDate();var t=VC(this._milliseconds)/1e3,e=VC(this._days),n=VC(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=qr(t/60),i=qr(r/60),t%=60,r%=60,o=qr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Pl(this._months)!==Pl(a)?"-":"",c=Pl(this._days)!==Pl(a)?"-":"",h=Pl(this._milliseconds)!==Pl(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var Ge=mp.prototype;Ge.isValid=Aj;Ge.abs=dz;Ge.add=fz;Ge.subtract=gz;Ge.as=pz;Ge.asMilliseconds=SD;Ge.asSeconds=wz;Ge.asMinutes=vz;Ge.asHours=Cz;Ge.asDays=yz;Ge.asWeeks=bz;Ge.asMonths=Sz;Ge.asQuarters=Rz;Ge.asYears=Ez;Ge.valueOf=Tz;Ge._bubble=mz;Ge.clone=_z;Ge.get=Mz;Ge.milliseconds=Iz;Ge.seconds=Pz;Ge.minutes=Oz;Ge.hours=xz;Ge.days=Hz;Ge.weeks=Dz;Ge.months=Az;Ge.years=Nz;Ge.humanize=Vz;Ge.toISOString=wp;Ge.toString=wp;Ge.toJSON=wp;Ge.locale=uD;Ge.localeData=hD;Ge.toIsoString=ri("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",wp);Ge.lang=cD;ve("X",0,0,"unix");ve("x",0,0,"valueOf");ue("x",hp);ue("X",aB);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(Be(t))});//! moment.js
q.version="2.30.1";WW(Et);q.fn=Z;q.min=Pj;q.max=Oj;q.now=xj;q.utc=po;q.unix=oz;q.months=az;q.isDate=Od;q.locale=Ys;q.invalid=ap;q.duration=Ai;q.isMoment=Oi;q.weekdays=uz;q.parseZone=sz;q.localeData=os;q.isDuration=Fg;q.monthsShort=lz;q.weekdaysMin=hz;q.defineLocale=rE;q.updateLocale=sj;q.locales=aj;q.weekdaysShort=cz;q.normalizeUnits=ii;q.relativeTimeRounding=$z;q.relativeTimeThreshold=Fz;q.calendarFormat=nU;q.prototype=Z;q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function RD(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function MS(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Mh(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function ln(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function Zs(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Le(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function _(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function ED(t){return ln(t,(e,n)=>e+n,0)}function Wz(t){return ln(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Bz(t){return ln(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function jz(t){return t.length?ED(t)/t.length:0}function TD(t){return ln(t,(e,n)=>e.concat(Array.isArray(n)?TD(n):n),[])}function _D(t){const e=[];return _(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function IS(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function Uz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return _(i,s=>{o=o.filter(a=>s.includes(a))}),o}function zz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return _(i,s=>{_(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function PS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Yz=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:jz,arrayEach:_,arrayFilter:Zs,arrayFlatten:TD,arrayMap:Le,arrayMax:Wz,arrayMin:Bz,arrayReduce:ln,arraySum:ED,arrayUnique:_D,extendArray:MS,getDifferenceOfArrays:IS,getIntersectionOfArrays:Uz,getUnionOfArrays:zz,pivot:Mh,stringToArray:PS,to2dArray:RD},Symbol.toStringTag,{value:"Module"}));function nt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return ln(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function wt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function Rt(t){return typeof t>"u"}function Lt(t){return t===null||t===""||Rt(t)}function MD(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const vh="length",Ih=t=>parseInt(t,16),RO=t=>parseInt(t,10),cm=(t,e,n)=>t.substr(e,n),Ph=t=>t.codePointAt(0)-65,OS=t=>`${t}`.replace(/\-/g,""),Gz=t=>Ih(cm(OS(t),Ih("12"),Ph("F")))/(Ih(cm(OS(t),Ph("B"),~~![][vh]))||9),qz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let EO=!1;const TO={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},_O={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function ID(t,e){const n=!Lt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let o,s="invalid",a="invalid";t=OS(t||"");const l=Kz(t);if(n||r||l)if(l){const u=q("10/07/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=Gz(t);o=q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(qz()&&(s="valid",a="valid"),!EO&&s!=="valid"&&(TO[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](TO[s]({keyValidityDate:o,hotVersion:i})),EO=!0),a!=="valid"&&e&&_O[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=_O[a]({keyValidityDate:o,hotVersion:i}),e.appendChild(c)}}function Kz(t){let e=[][vh],n=e;if(t[vh]!==Ph("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Ph(i.shift());o;o=Ph(i.shift()||"A"))--o<""[vh]?n=n|(RO(`${RO(Ih(r)+(Ih(cm(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=cm(t,o,o?i[vh]===1?9:8:6);return n===e}const Xz=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:ID,isDefined:le,isEmpty:Lt,isRegExp:MD,isUndefined:Rt,stringify:wt},Symbol.toStringTag,{value:"Module"}));function Ln(t){return t[0].toUpperCase()+t.substr(1)}function Zz(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=wt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function dE(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function fE(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function gE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function xS(t){return vp(`${t}`,{ALLOWED_TAGS:[]})}function vp(t,e){return VW.sanitize(t,e)}const Qz=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Zz,isPercentValue:fE,randomString:dE,sanitize:vp,stripTags:xS,substitute:gE,toUpperCaseFirst:Ln},Symbol.toStringTag,{value:"Module"})),sa=t=>["tabindex",t],Jz=()=>["role","treegrid"],qo=()=>["role","presentation"],eY=()=>["role","gridcell"],tY=()=>["role","gridcell button"],nY=()=>["role","rowheader"],PD=()=>["role","rowgroup"],rY=()=>["role","columnheader"],OD=()=>["role","row"],iY=()=>["role","menu"],oY=()=>["role","menuitem"],sY=()=>["role","menuitemcheckbox"],aY=()=>["role","combobox"],xD=()=>["role","listbox"],lY=()=>["role","option"],uY=()=>["role","checkbox"],cY=()=>["scope","col"],hY=()=>["scope","row"],dY=()=>["type","text"],Fu=t=>["aria-label",t],Sl=()=>["aria-hidden","true"],fY=()=>["aria-disabled","true"],gY=()=>["aria-multiselectable","true"],HD=t=>["aria-haspopup",t],AD=t=>["aria-rowcount",t],Cp=t=>["aria-colcount",t],ND=t=>["aria-rowindex",t],mE=t=>["aria-colindex",t],Zr=t=>["aria-expanded",t],mY=t=>["aria-sort",t],MO=()=>["aria-readonly","true"],IO=()=>["aria-invalid","true"],DD=t=>["aria-checked",t],pE=()=>["aria-selected","true"],pY=()=>["aria-autocomplete","list"],wY=t=>["aria-controls",t],vY=t=>["aria-activedescendant",t],CY=t=>["aria-live",t],yY=t=>["aria-relevant",t],bY=t=>["aria-setsize",t],SY=t=>["aria-posinset",t];var PO={},WC,OO;function RY(){if(OO)return WC;OO=1;var t=Qt(),e=fN(),n=sn(),r=pl(),i=sp(),o=t([].push);return WC=function(s){if(n(s))return s;if(e(s)){for(var a=s.length,l=[],u=0;u<a;u++){var c=s[u];typeof c=="string"?o(l,c):(typeof c=="number"||r(c)==="Number"||r(c)==="String")&&o(l,i(c))}var h=l.length,d=!0;return function(f,m){if(d)return d=!1,m;if(e(this))return m;for(var w=0;w<h;w++)if(l[w]===f)return m}}},WC}var xO;function EY(){if(xO)return PO;xO=1;var t=ft(),e=Zu(),n=Md(),r=on(),i=Qt(),o=rn(),s=sn(),a=OR(),l=jR(),u=RY(),c=PR(),h=String,d=e("JSON","stringify"),f=i(/./.exec),m=i("".charAt),w=i("".charCodeAt),b=i("".replace),E=i(1.1.toString),C=/[\uD800-\uDFFF]/g,M=/^[\uD800-\uDBFF]$/,H=/^[\uDC00-\uDFFF]$/,L=!c||o(function(){var K=e("Symbol")("stringify detection");return d([K])!=="[null]"||d({a:K})!=="{}"||d(Object(K))!=="{}"}),P=o(function(){return d("\uDF06\uD834")!=='"\\udf06\\ud834"'||d("\uDEAD")!=='"\\udead"'}),O=function(K,A){var Q=l(arguments),X=u(A);if(!(!s(X)&&(K===void 0||a(K))))return Q[1]=function(ae,ee){if(s(X)&&(ee=r(X,this,h(ae),ee)),!a(ee))return ee},n(d,null,Q)},z=function(K,A,Q){var X=m(Q,A-1),ae=m(Q,A+1);return f(M,K)&&!f(H,ae)||f(H,K)&&!f(M,X)?"\\u"+E(w(K,0),16):K};return d&&t({target:"JSON",stat:!0,arity:3,forced:L||P},{stringify:function(A,Q,X){var ae=l(arguments),ee=n(L?O:d,null,ae);return P&&typeof ee=="string"?b(ee,C,z):ee}}),PO}EY();function Vu(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Oe(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Vu(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Vu(n[0])]:e[r]=[]:e[r]=null)})),e}function kD(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Xt(t,e,n){const r=Array.isArray(n);return Oe(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Nd(t,e){Oe(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Nd(t[r],e[r])):t[r]=e[r]})}function $n(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function xi(t){const e={};return Oe(t,(n,r)=>{e[r]=n}),e}function st(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Oe(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=m=>{let w=m;return(Array.isArray(w)||Pe(w))&&(w=$n(w)),w};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function yp(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Pe(t){return Object.prototype.toString.call(t)==="[object Object]"}function vo(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Oe(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function LD(t,e){const n=e.split(".");let r=t;return Oe(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Wg(t,e,n){if(typeof e!="string")return;const r=e.split(".");let i=t;r.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==r.length-1?(qt(i,o)||(i[o]={}),i=i[o]):i[o]=n)})}function bp(t){if(!Pe(t))return 0;const e=function(n){let r=0;return Pe(n)?Oe(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function pr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function qt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const TY=Object.freeze(Object.defineProperty({__proto__:null,clone:xi,createObjectPropListener:pr,deepClone:$n,deepExtend:Nd,deepObjectSize:bp,defineGetter:vo,duckSchema:Vu,extend:Xt,getProperty:LD,hasOwnProperty:qt,inherit:kD,isObject:Pe,isObjectEqual:yp,mixin:st,objectEach:Oe,setProperty:Wg},Symbol.toStringTag,{value:"Module"}));function td(t){return window.requestAnimationFrame(t)}function nd(t){window.cancelAnimationFrame(t)}function wE(){return"ontouchstart"in window}function $D(){return typeof window<"u"}let Ol;function FD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ol||(typeof Intl=="object"?Ol=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Ol=(n,r)=>`${n}`.localeCompare(r):Ol=(n,r)=>n===r?0:n>r?-1:1,Ol)}const _Y=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:nd,getComparisonFunction:FD,isCSR:$D,isTouchSupported:wE,requestAnimationFrame:td},Symbol.toStringTag,{value:"Module"})),Br=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},as={chrome:Br((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Br(t=>/CriOS/.test(t)),edge:Br(t=>/Edge/.test(t)),edgeWebKit:Br(t=>/EdgiOS/.test(t)),firefox:Br(t=>/Firefox/.test(t)),firefoxWebKit:Br(t=>/FxiOS/.test(t)),mobile:Br(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Br((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},oc={mac:Br(t=>/^Mac/.test(t)),win:Br(t=>/^Win/.test(t)),linux:Br(t=>/^Linux/.test(t)),ios:Br(t=>/iPhone|iPad|iPod/i.test(t))};function VD(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(as,n=>{let{test:r}=n;return void r(t,e)})}function WD(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oe(oc,e=>{let{test:n}=e;return void n(t)})}$D()&&(VD(),WD());function vE(){return as.chrome.value}function BD(){return as.chromeWebKit.value}function Bg(){return as.firefox.value}function jD(){return as.firefoxWebKit.value}function Wu(){return as.safari.value}function UD(){return as.edge.value}function MY(){return as.edgeWebKit.value}function _i(){return as.mobile.value}function CE(){return oc.ios.value}function yE(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&oc.mac.value}function hm(){return oc.win.value}function dm(){return oc.mac.value}function IY(){return oc.linux.value}const PY=Object.freeze(Object.defineProperty({__proto__:null,isChrome:vE,isChromeWebKit:BD,isEdge:UD,isEdgeWebKit:MY,isFirefox:Bg,isFirefoxWebKit:jD,isIOS:CE,isIpadOS:yE,isLinuxOS:IY,isMacOS:dm,isMobileBrowser:_i,isSafari:Wu,isWindowsOS:hm,setBrowserMeta:VD,setPlatformMeta:WD},Symbol.toStringTag,{value:"Module"}));function zD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Oh(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function YD(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ll(t){return YD(t)&&t.parent}function OY(t){return!!Object.getPrototypeOf(t.parent)}function Qs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Ch(t,e,n){const r=[];let i=t;for(;i&&(i=Qs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function GD(t,e){const n={element:void 0,classNames:[]};let r=t;for(;r!==null&&r!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&r.classList.contains(e))n.element=r,n.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(r.classList).filter(o=>e.test(o));i.length&&(n.element=r,n.classNames.push(...i))}r=r.parentElement}return n}function Gs(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function qD(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Ms(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function KD(t){return!t||!t.length?[]:t.filter(e=>!!e)}function XD(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),{regexFree:r,regexes:n}}function ye(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Y(t,e){typeof e=="string"&&(e=e.split(" ")),e=KD(e),e.length>0&&t.classList.add(...e)}function pe(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=XD(e,!0);n=KD(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Rl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=XD(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function bE(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)bE(e[n])}}function fo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const ZD=/(<(.*)>|&(.*);)/;function El(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;ZD.test(e)?t.innerHTML=n?vp(e):e:Js(t,e)}function Js(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(fo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ul(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return ul(r.host.impl);if(r.host)return ul(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(r).display==="none")return!1;r=r.parentNode}return!0}function QD(t){const n=t.ownerDocument.defaultView;let r=t;for(;r.parentNode;){if(r.style.height==="0px"||r.style.height==="0")return n.getComputedStyle(r).overflow==="hidden";r=r.parentNode}return!1}function Rn(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function SE(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Sp(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Rp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?SE(e):t.scrollTop}function RE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Sp(e):t.scrollLeft}function rd(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function JD(t){return t.scrollHeight-t.clientHeight}function ek(t){return t.scrollWidth-t.clientWidth}function Bu(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=n.getComputedStyle(r),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function id(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=n.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function xY(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function jt(t){return t.offsetWidth}function Kt(t){return t.offsetHeight}function Au(t){return t.clientHeight||t.innerHeight}function EE(t){return t.clientWidth||t.innerWidth}function HY(t,e,n){t.addEventListener(e,n,!1)}function AY(t,e,n){t.removeEventListener(e,n,!1)}function TE(t){return t.selectionStart?t.selectionStart:0}function tk(t){return t.selectionEnd?t.selectionEnd:0}function NY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function HS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Dd(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let BC;function _E(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return hm()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function DY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Wu()&&!_i()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i+_E(t)}function mn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return BC===void 0&&(BC=DY(t)),BC}function ME(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function IE(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function Ep(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function kY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function kd(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function xh(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Tp(t){return xh(t)&&t.hasAttribute("data-hot-input")===!1}function LY(t){const e=t.ownerDocument.activeElement;Tp(e)||t.select()}function PE(t){return!t.parentNode}function nk(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function OE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ce(t,"contenteditable",!0),n&&Ce(t,...Sl()),e&&Y(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function xE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&pe(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function rk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;OE(t,n),e(),xE(t,n)}function uo(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const $Y=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:ZD,addClass:Y,addEvent:HY,clearTextSelection:HS,closest:Qs,closestDown:Ch,empty:fo,fastInnerHTML:El,fastInnerText:Js,findFirstParentWithClass:GD,getCaretPosition:TE,getCssTransform:kY,getFractionalScalingCompensation:_E,getFrameElement:YD,getMaximumScrollLeft:ek,getMaximumScrollTop:JD,getParent:zD,getParentWindow:ll,getScrollLeft:RE,getScrollTop:Rp,getScrollableElement:rd,getScrollbarWidth:mn,getSelectionEndPosition:tk,getSelectionText:NY,getStyle:id,getTrimmingContainer:Bu,getWindowScrollLeft:Sp,getWindowScrollTop:SE,hasAccessToParentWindow:OY,hasClass:ye,hasHorizontalScrollbar:IE,hasVerticalScrollbar:ME,hasZeroHeight:QD,index:qD,innerHeight:Au,innerWidth:EE,isChildOf:Gs,isDetached:PE,isHTMLElement:uo,isInput:xh,isInternalElement:Oh,isOutsideInput:Tp,isVisible:ul,makeElementContentEditableAndSelectItsContent:OE,matchesCSSRules:xY,observeVisibilityChangeOnce:nk,offset:Rn,outerHeight:Kt,outerWidth:jt,overlayContainsElement:Ms,removeAttribute:Rl,removeClass:pe,removeContentEditableFromElementAndDeselect:xE,removeEvent:AY,removeTextNodes:bE,resetCssTransform:kd,runWithSelectedContendEditableElement:rk,selectElementIfAllowed:LY,setAttribute:Ce,setCaretPosition:Dd,setOverlayPosition:Ep},Symbol.toStringTag,{value:"Module"}));function tt(t){return typeof t=="function"}function ik(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function FY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=ik(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Ld(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function VY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return ln(i,(u,c)=>c(u),r.apply(this,a))}}function HE(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function ok(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function WY(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function fm(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const BY=Object.freeze(Object.defineProperty({__proto__:null,curry:ok,curryRight:WY,debounce:Ld,fastCall:fm,isFunction:tt,partial:HE,pipe:VY,throttle:ik,throttleAfterHits:FY},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Bg()?182:174,AUDIO_MUTE:Bg()?181:173,AUDIO_UP:Bg()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},jY=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function sk(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function AE(t){return jY.includes(t)}function UY(t){const e=[];return dm()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(t)}function ak(t){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(t)}function sc(t,e){const n=e.split("|");let r=!1;return _(n,i=>{if(t===de[i])return r=!0,!1}),r}const zY=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:UY,isCtrlMetaKey:ak,isFunctionKey:AE,isKey:sc,isPrintableChar:sk},Symbol.toStringTag,{value:"Module"}));function oi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ds(t){return t.isImmediatePropagationEnabled===!1}function ea(t){return t.button===2}function _p(t){return t.button===0}function lk(t){return t instanceof TouchEvent}function uk(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!uo(e)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const YY=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ds,isLeftClick:_p,isRightClick:ea,isTouchEvent:lk,offsetRelativeTo:uk,stopImmediatePropagation:oi},Symbol.toStringTag,{value:"Module"}));function Ke(){le(console)&&console.warn(...arguments)}function NE(){le(console)&&console.error(...arguments)}const Xa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),UC=new Map([[]]);var HO={},zC,AO;function GY(){if(AO)return zC;AO=1;var t=ec();return zC=function(e,n,r){for(var i=0,o=arguments.length>2?r:t(n),s=new e(o);o>i;)s[i]=n[i++];return s},zC}var YC,NO;function qY(){if(NO)return YC;NO=1;var t=Zt();return YC=function(e,n){var r=t[e],i=r&&r.prototype;return i&&i[n]},YC}var GC,DO;function Mp(){if(DO)return GC;DO=1;var t=Hi(),e=VR(),n=ia().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),GC=function(o){i[r][o]=!0},GC}var kO;function KY(){if(kO)return HO;kO=1;var t=ft(),e=Qt(),n=wr(),r=Rd(),i=GY(),o=qY(),s=Mp(),a=Array,l=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(c){c!==void 0&&n(c);var h=r(this),d=i(a,h);return l(d,c)}}),s("toSorted"),HO}KY();var LO={},$O={},FO;function XY(){if(FO)return $O;FO=1;var t=ft(),e=on(),n=tc(),r=wr(),i=an(),o=mo(),s=vr(),a=oa(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),$O}var VO;function ZY(){return VO||(VO=1,XY()),LO}ZY();function QY(t,e){ck(t,e),e.add(t)}function qC(t,e,n){ck(t,e),e.set(t,n)}function ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WO(t,e,n){return t.set(gm(t,e),n),n}function Sn(t,e){return t.get(gm(t,e))}function gm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const JY=100;var Sr=new WeakMap,pu=new WeakMap,KC=new WeakMap,XC=new WeakSet;class BO{constructor(){QY(this,XC),qC(this,Sr,new Map),qC(this,pu,new Map),qC(this,KC,new Set),Xa.forEach(e=>gm(XC,this,jO).call(this,e))}getHooks(e){var n;return(n=Sn(Sr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Sn(Sr,this).has(e)||(gm(XC,this,jO).call(this,e),Xa.push(e));const i=Sn(Sr,this).get(e);if(i.find(u=>u.callback===n))return;const o=Number.isInteger(r.orderIndex)?r.orderIndex:0,s=!!r.runOnce,a=!!r.initialHook;let l=!1;if(a){const u=i.find(c=>c.initialHook);u&&(u.callback=n,l=!0)}if(!l){i.push({callback:n,orderIndex:o,runOnce:s,initialHook:a,skip:!1});let u=Sn(KC,this).has(e);!u&&o!==0&&(u=!0,Sn(KC,this).add(e)),u&&i.length>1&&Sn(Sr,this).set(e,i.toSorted((c,h)=>c.orderIndex-h.orderIndex))}}has(e){return Sn(Sr,this).has(e)&&Sn(Sr,this).get(e).length>0}remove(e,n){if(!Sn(Sr,this).has(e))return!1;const r=Sn(Sr,this).get(e),i=r.find(o=>o.callback===n);if(i){let o=Sn(pu,this).get(e);return i.skip=!0,o+=1,o>JY&&(Sn(Sr,this).set(e,r.filter(s=>!s.skip)),o=0),Sn(pu,this).set(e,o),!0}return!1}destroy(){Sn(Sr,this).clear(),Sn(pu,this).clear(),WO(Sr,this,null),WO(pu,this,null)}}function jO(t){Sn(Sr,this).set(t,[]),Sn(pu,this).set(t,0)}function eG(t,e,n){return(e=tG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tG(t){var e=nG(t,"string");return typeof e=="symbol"?e:e+""}function nG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rG=nt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ne{constructor(){eG(this,"globalBucket",new BO)}static getSingleton(){return oG()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new BO),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.add(e,o,r)):(jC.has(e)&&Ke(gE(rG,{hookName:e,removedInVersion:jC.get(e)})),UC.has(e)&&Ke(UC.get(e)),this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!1})),this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?_(n,o=>this.once(e,o,r)):this.getBucket(r).add(e,n,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?_(n,i=>this.addAsFixed(e,i,r)):this.getBucket(r).add(e,n,{initialHook:!0}),this}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(r).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,r,i,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=fm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=fm(u[h].callback,e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Xa.push(e)}deregister(e){this.isRegistered(e)&&Xa.splice(Xa.indexOf(e),1)}isDeprecated(e){return UC.has(e)||jC.has(e)}isRegistered(e){return Xa.indexOf(e)>=0}getRegistered(){return Xa}}const iG=new ne;function oG(){return iG}const el=new Map;function si(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";el.has(t)||el.set(t,new Map);const e=el.get(t);function n(l,u){e.set(l,u)}function r(l){return e.get(l)}function i(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){el.delete(t),e.clear()}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s,clear:a}}function sG(t,e){var n;return el==null||(n=el.get(t.guid))===null||n===void 0?void 0:n.get(e)}const AS=new WeakMap,{register:aG,getItem:hk,hasItem:dk,getNames:lG,getValues:nce}=si("editors");function uG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ne.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function fk(t,e){let n;if(typeof t=="function")AS.get(t)||ur(null,t),n=AS.get(t);else if(typeof t=="string")n=hk(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function od(t){if(typeof t=="function")return t;if(!dk(t))throw Error(`No registered editor found under "${t}" name`);return hk(t).getConstructor()}function ur(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new uG(e);typeof t=="string"&&aG(t,n),AS.set(e,n)}function cG(t,e,n){return(e=hG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hG(t){var e=dG(t,"string");return typeof e=="symbol"?e:e+""}function dG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let jg=0;class Jr{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;cG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,fG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),jg+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),jg-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),jg-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function fG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),oi(this)},t}function gG(){return jg}function mG(t,e){pG(t,e),e.add(t)}function pG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){return(e=wG(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wG(t){var e=vG(t,"string");return typeof e=="symbol"?e:e+""}function vG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var of=new WeakSet;class NS{constructor(e,n,r){mG(this,of),ha(this,"hot",void 0),ha(this,"tableMeta",void 0),ha(this,"selection",void 0),ha(this,"eventManager",void 0),ha(this,"destroyed",!1),ha(this,"activeEditor",void 0),ha(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Jr(e),this.hot.addHook("afterDocumentKeyDown",i=>ZC(of,this,UO).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>ZC(of,this,UO).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>ZC(of,this,CG).call(this,i,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=fk(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function UO(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ds(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!AE(n)&&!ak(n)&&!r&&!this.isEditorOpened()&&this.openEditor("",t)}function CG(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const zO=new WeakMap;NS.getInstance=function(t,e,n){let r=zO.get(t);return r||(r=new NS(t,e,n),zO.set(t,r)),r};function yG(t,e){gk(t,e),e.add(t)}function Rc(t,e,n){gk(t,e),e.set(t,n)}function gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(zo(t,e))}function Ec(t,e,n){return t.set(zo(t,e),n),n}function zo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nu=Object.freeze({CELL:"cell",MIXED:"mixed"});var nn=new WeakMap,sf=new WeakMap,af=new WeakMap,lf=new WeakMap,uf=new WeakMap,Os=new WeakSet;class bG{constructor(e){var n=this;yG(this,Os),Rc(this,nn,void 0),Rc(this,sf,void 0),Rc(this,af,1),Rc(this,lf,null),Rc(this,uf,new Map);const r=e.getSettings();Ec(nn,this,e),Ec(sf,this,r.imeFastEdit?Nu.MIXED:Nu.CELL),mt(nn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zo(Os,n,RG).call(n,...o)}),mt(nn,this).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zo(Os,n,YO).call(n,...o)}),mt(nn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zo(Os,n,YO).call(n,...o)}),mt(nn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zo(Os,n,SG).call(n,...o)})}getFocusMode(){return mt(sf,this)}setFocusMode(e){Object.values(Nu).includes(e)?Ec(sf,this,e):Ke(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return mt(af,this)}setRefocusDelay(e){Ec(af,this,e)}setRefocusElementGetter(e){Ec(lf,this,e)}getRefocusElement(){var e;return typeof mt(lf,this)=="function"?mt(lf,this).call(this):(e=mt(nn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=mt(nn,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=mt(nn,this).runHooks("modifyFocusedElement",s.row,s.col,r);uo(a)||(a=r),a&&!((o=mt(nn,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):zo(Os,this,DE).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mt(af,this);if(mt(nn,this).getSettings().imeFastEdit&&!((e=mt(nn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var r,i;(r=mt(nn,this).getActiveEditor())===null||r===void 0||(i=r.refreshValue)===null||i===void 0||i.call(r),mt(uf,this).has(n)||mt(uf,this).set(n,Ld(()=>{if(!mt(nn,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),mt(uf,this).get(n)()}}}function DE(t){var e;const n=(e=mt(nn,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!mt(nn,this).selection.isCellVisible(n)){t(null);return}const r=mt(nn,this).getCell(n.row,n.col,!0);r===null?mt(nn,this).addHookOnce("afterScroll",()=>{t(mt(nn,this).getCell(n.row,n.col,!0))}):t(r)}function YO(){zo(Os,this,DE).call(this,t=>{const{activeElement:e}=mt(nn,this).rootDocument;e&&Tp(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function SG(){zo(Os,this,DE).call(this,t=>{this.getFocusMode()===Nu.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function RG(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Nu.MIXED:Nu.CELL)}var GO={},QC,qO;function EG(){if(qO)return QC;qO=1;var t=ti(),e=pl(),n=Hi(),r=n("match");return QC=function(i){var o;return t(i)&&((o=i[r])!==void 0?!!o:e(i)==="RegExp")},QC}var JC,KO;function TG(){if(KO)return JC;KO=1;var t=Zt(),e=rn(),n=t.RegExp,r=!e(function(){var i=!0;try{n(".","d")}catch{i=!1}var o={},s="",a=i?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(o,d,{get:function(){return s+=f,!0}})},u={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(u.hasIndices="d");for(var c in u)l(c,u[c]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return h!==a||s!==a});return JC={correct:r},JC}var ey,XO;function _G(){if(XO)return ey;XO=1;var t=an();return ey=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},ey}var ty,ZO;function MG(){if(ZO)return ty;ZO=1;var t=on(),e=ni(),n=Ed(),r=TG(),i=_G(),o=RegExp.prototype;return ty=r.correct?function(s){return s.flags}:function(s){return!r.correct&&n(o,s)&&!e(s,"flags")?t(i,s):s.flags},ty}var ny,QO;function IG(){if(QO)return ny;QO=1;var t=Qt(),e=Qu(),n=Math.floor,r=t("".charAt),i=t("".replace),o=t("".slice),s=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return ny=function(l,u,c,h,d,f){var m=c+l.length,w=h.length,b=a;return d!==void 0&&(d=e(d),b=s),i(f,b,function(E,C){var M;switch(r(C,0)){case"$":return"$";case"&":return l;case"`":return o(u,0,c);case"'":return o(u,m);case"<":M=d[o(C,1,-1)];break;default:var H=+C;if(H===0)return E;if(H>w){var L=n(H/10);return L===0?E:L<=w?h[L-1]===void 0?r(C,1):h[L-1]+r(C,1):E}M=h[H-1]}return M===void 0?"":M})},ny}var JO;function PG(){if(JO)return GO;JO=1;var t=ft(),e=on(),n=Qt(),r=Sd(),i=sn(),o=ti(),s=EG(),a=sp(),l=Td(),u=MG(),c=IG(),h=Hi(),d=ra(),f=h("replace"),m=TypeError,w=n("".indexOf),b=n("".replace),E=n("".slice),C=Math.max;return t({target:"String",proto:!0},{replaceAll:function(H,L){var P=r(this),O,z,K,A,Q,X,ae,ee,ce,vt,Ne=0,$e="";if(o(H)){if(O=s(H),O&&(z=a(r(u(H))),!~w(z,"g")))throw new m("`.replaceAll` does not allow non-global regexes");if(K=l(H,f),K)return e(K,H,P,L);if(d&&O)return b(a(P),H,L)}for(A=a(P),Q=a(H),X=i(L),X||(L=a(L)),ae=Q.length,ee=C(1,ae),ce=w(A,Q);ce!==-1;)vt=X?a(L(Q,ce,A)):c(Q,A,ce,[],void 0,L),$e+=E(A,Ne,ce)+vt,Ne=ce+ae,ce=ce+ee>A.length?-1:w(A,Q,ce+ee);return Ne<A.length&&($e+=E(A,Ne)),$e}}),GO}PG();var ex={},tx={},nx;function OG(){if(nx)return tx;nx=1;var t=ft(),e=tc(),n=wr(),r=an(),i=mo(),o=vr(),s=oa(),a=Md(),l=rn(),u=TypeError,c=l(function(){[].keys().reduce(function(){},void 0)}),h=!c&&s("reduce",u);return t({target:"Iterator",proto:!0,real:!0,forced:c||h},{reduce:function(f){r(this);try{n(f)}catch(C){o(this,"throw",C)}var m=arguments.length<2,w=m?void 0:arguments[1];if(h)return a(h,this,m?[f]:[f,w]);var b=i(this),E=0;if(e(b,function(C){m?(m=!1,w=C):w=f(w,C,E),E++},{IS_RECORD:!0}),m)throw new u("Reduce of empty iterator with no initial value");return w}}),tx}var rx;function xG(){return rx||(rx=1,OG()),ex}xG();const mk={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},HG=new RegExp(Object.keys(mk).map(t=>`(${t})`).join("|"),"gi");function AG(t){return(t&&t.nodeName||"")==="TABLE"}function DS(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,m=[];for(let b=0;b<s;b+=1){const E=!f&&n&&b===0;let C="";if(f)C=`<th>${t.getColHeader(b-c)}</th>`;else if(E)C=`<th>${t.getRowHeader(d-h)}</th>`;else{const M=i[d][b],{hidden:H,rowspan:L,colspan:P}=t.getCellMeta(d-h,b-c);if(!H){const O=[];if(L&&O.push(`rowspan="${L}"`),P&&O.push(`colspan="${P}"`),Lt(M))C=`<td ${O.join(" ")}></td>`;else{const z=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");C=`<td ${O.join(" ")}>${z}</td>`}}}m.push(C)}const w=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,w):u.splice(-1,0,w)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function kS(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Lt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function pk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const M=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,H=>{const L=H.match(/<td\b[^>]*?>/g)[0],P=/<p.*?>/g,O=H.substring(L.length,H.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(P,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${L}${O}</td>`});i.insertAdjacentHTML("afterbegin",`${M}`),o=i.querySelector("table")}if(!o||!AG(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((M,H)=>M+H.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(o.tHead){const M=Array.from(o.tHead.rows).filter(H=>{const L=H.querySelector("td")!==null;return L&&h.push(H),!L});f=M.length,d=f>0,f>1?n.nestedHeaders=Array.from(M).reduce((H,L)=>{const P=Array.from(L.cells).reduce((O,z,K)=>{if(a&&K===0)return O;const{colSpan:A,innerHTML:Q}=z,X=A>1?{label:Q,colspan:A}:Q;return O.push(X),O},[]);return H.push(P),H},[]):d&&(n.colHeaders=Array.from(M[0].children).reduce((H,L,P)=>(a&&P===0||H.push(L.innerHTML),H),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const w=[...h,...Array.from(o.tBodies).reduce((M,H)=>(M.push(...Array.from(H.rows)),M),[]),...c];m=w.length;const b=new Array(m);for(let M=0;M<m;M++)b[M]=new Array(u);const E=[],C=[];for(let M=0;M<m;M++){const H=w[M],L=Array.from(H.cells),P=L.length;for(let O=0;O<P;O++){const z=L[O],{nodeName:K,innerHTML:A,rowSpan:Q,colSpan:X}=z,ae=b[M].findIndex(ee=>ee===void 0);if(K==="TD"){if(Q>1||X>1){for(let Ne=M;Ne<M+Q;Ne++)if(Ne<m)for(let $e=ae;$e<ae+X;$e++)b[Ne][$e]=null;const ce=z.getAttribute("style");ce&&ce.includes("mso-ignore:colspan")||E.push({col:ae,row:M,rowspan:Q,colspan:X})}let ee="";s&&/excel/gi.test(s.content)?ee=A.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=A.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[M][ae]=ee.replace(HG,ce=>mk[ce])}else C.push(A)}}return E.length&&(n.mergeCells=E),C.length&&(n.rowHeaders=C),b.length&&(n.data=b),n}const NG=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:kS,htmlToGridSettings:pk,instanceToHTML:DS},Symbol.toStringTag,{value:"Module"}));function Nn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function wk(t){return Nn(t,[","])}function fe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function LS(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function kE(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function We(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const DG=Object.freeze(Object.defineProperty({__proto__:null,clamp:We,isNumeric:Nn,isNumericLike:wk,rangeEach:fe,rangeEachReverse:LS,valueAccordingPercent:kE},Symbol.toStringTag,{value:"Module"})),$S="asc",kG="desc",ix=new Map([[$S,[-1,1]],[kG,[1,-1]]]),LG=t=>`The priority '${t}' is already declared in a map.`,$G=t=>`The priority '${t}' is not a number.`;function FG(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=tt(t)?t:LG,e=tt(e)?e:$G;function r(o,s){if(!Nn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$S;const[s,a]=ix.get(o)||ix.get($S);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const VG=t=>`The id '${t}' is already declared in a map.`;function Ip(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=tt(t)?t:VG;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const WG=t=>`'${t}' value is already declared in a unique set.`;function BG(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=tt(t)?t:WG;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const LE=t=>`There is already registered "${t}" plugin.`,jG=t=>`There is already registered plugin on priority "${t}".`,UG=t=>`The priority "${t}" is not a number.`,vk=FG({errorPriorityExists:jG,errorPriorityNaN:UG}),Ck=BG({errorItemExists:LE}),FS=Ip({errorIdExists:LE});function $E(){return[...vk.getItems(),...Ck.getItems()]}function $d(t){const e=Ln(t);return FS.getItem(e)}function zG(t){return!!$d(t)}function je(t,e,n){[t,e,n]=GG(t,e,n),$d(t)===void 0&&YG(t,e,n)}function YG(t,e,n){const r=Ln(t);if(FS.hasItem(r))throw new Error(LE(r));n===void 0?Ck.addItem(r):vk.addItem(n,r),FS.addItem(r,e)}function GG(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:qG,getItem:KG,hasItem:yk,getNames:XG,getValues:rce}=si("renderers");function sd(t){if(typeof t=="function")return t;if(!yk(t))throw Error(`No registered renderer found under "${t}" name`);return KG(t)}function Er(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),qG(t,e)}const{register:ZG,getItem:QG,hasItem:bk,getNames:JG,getValues:ice}=si("validators");function FE(t){if(typeof t=="function")return t;if(!bk(t))throw Error(`No registered validator found under "${t}" name`);return QG(t)}function Za(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),ZG(t,e)}var ox={},sx;function e2(){if(sx)return ox;sx=1;var t=ft(),e=Qu(),n=ec(),r=_d(),i=Mp();return t({target:"Array",proto:!0},{at:function(s){var a=e(this),l=n(a),u=r(s),c=u>=0?u:l+u;return c<0||c>=l?void 0:a[c]}}),i("at"),ox}e2();var ax={},lx;function t2(){if(lx)return ax;lx=1;var t=ft(),e=Qt(),n=Sd(),r=_d(),i=sp(),o=rn(),s=e("".charAt),a=o(function(){return"ð ®·".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(u){var c=i(n(this)),h=c.length,d=r(u),f=d>=0?d:h+d;return f<0||f>=h?void 0:s(c,f)}}),ax}t2();function Tc(t,e,n){return(e=n2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n2(t){var e=r2(t,"string");return typeof e=="symbol"?e:e+""}function r2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i2{constructor(){Tc(this,"count",0),Tc(this,"startColumn",null),Tc(this,"endColumn",null),Tc(this,"startPosition",null),Tc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o,columnWidth:s}=n,a=i>0?o+1:o;r>=i&&r+s<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i,d=r+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||r>u.at(-1)||-1*r-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _c(t,e,n){return(e=o2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o2(t){var e=s2(t,"string");return typeof e=="symbol"?e:e+""}function s2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a2{constructor(){_c(this,"count",0),_c(this,"startRow",null),_c(this,"endRow",null),_c(this,"startPosition",null),_c(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o,rowHeight:s}=n;r>=i&&r+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-o&&(this.startRow-=1),d>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=r+i-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||r>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Mc(t,e,n){return(e=l2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l2(t){var e=u2(t,"string");return typeof e=="symbol"?e:e+""}function u2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sk{constructor(){Mc(this,"count",0),Mc(this,"startColumn",null),Mc(this,"endColumn",null),Mc(this,"startPosition",null),Mc(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:r,zeroBasedScrollOffset:i,viewportWidth:o}=n;r<=i&&(this.startColumn=e);const s=i>0?o+1:o;r>=i&&r<=i+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:r,viewportWidth:i,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?i+1:i;r+i-h<-1*o||r>u.at(-1)+c||-1*r-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ic(t,e,n){return(e=c2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c2(t){var e=h2(t,"string");return typeof e=="symbol"?e:e+""}function h2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rk{constructor(){Ic(this,"count",0),Ic(this,"startRow",null),Ic(this,"endRow",null),Ic(this,"startPosition",null),Ic(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:r,zeroBasedScrollOffset:i,innerViewportHeight:o}=n;r<=i&&(this.startRow=e),r>=i&&r<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:r,viewportHeight:i,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,r+i-o<0||r>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Pc(t,e,n){return(e=d2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d2(t){var e=f2(t,"string");return typeof e=="symbol"?e:e+""}function f2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g2{constructor(){Pc(this,"count",0),Pc(this,"startColumn",0),Pc(this,"endColumn",0),Pc(this,"startPosition",0),Pc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Oc(t,e,n){return(e=m2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m2(t){var e=p2(t,"string");return typeof e=="symbol"?e:e+""}function p2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w2{constructor(){Oc(this,"count",0),Oc(this,"startRow",0),Oc(this,"endRow",0),Oc(this,"startPosition",0),Oc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function ux(t,e,n){return(e=v2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v2(t){var e=C2(t,"string");return typeof e=="symbol"?e:e+""}function C2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y2 extends Sk{constructor(){super(...arguments),ux(this,"columnStartOffset",0),ux(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalColumns:i,startPositions:o}=e;if(this.startColumn!==null&&typeof r=="function"){const s=this.startColumn,a=this.endColumn;r(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function cx(t,e,n){return(e=b2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b2(t){var e=S2(t,"string");return typeof e=="symbol"?e:e+""}function S2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R2 extends Rk{constructor(){super(...arguments),cx(this,"rowStartOffset",0),cx(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:r,totalRows:i,startPositions:o}=e;if(this.startRow!==null&&typeof r=="function"){const s=this.startRow,a=this.endRow;r(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function hx(t,e,n){return(e=E2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E2(t){var e=T2(t,"string");return typeof e=="symbol"?e:e+""}function T2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ek{constructor(e){hx(this,"calculationTypes",[]),hx(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[r,i]=n;this.calculationResults.set(r,i),i.initialize(e)})}_process(e,n){this.calculationTypes.forEach(r=>{let[,i]=r;return i.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,r]=n;return r.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ui(t,e,n){return(e=_2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _2(t){var e=M2(t,"string");return typeof e=="symbol"?e:e+""}function M2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ju=50;class I2 extends Ek{constructor(e){let{calculationTypes:n,viewportWidth:r,scrollOffset:i,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),ui(this,"viewportWidth",0),ui(this,"scrollOffset",0),ui(this,"zeroBasedScrollOffset",0),ui(this,"totalColumns",0),ui(this,"columnWidthFn",null),ui(this,"columnWidth",0),ui(this,"overrideFn",null),ui(this,"inlineStartOffset",0),ui(this,"totalCalculatedWidth",0),ui(this,"startPositions",[]),ui(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?ju:n}}function Nr(t,e,n){return(e=P2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P2(t){var e=O2(t,"string");return typeof e=="symbol"?e:e+""}function O2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x2 extends Ek{constructor(e){let{calculationTypes:n,viewportHeight:r,scrollOffset:i,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),Nr(this,"viewportHeight",0),Nr(this,"scrollOffset",0),Nr(this,"zeroBasedScrollOffset",0),Nr(this,"totalRows",0),Nr(this,"rowHeightFn",null),Nr(this,"rowHeight",0),Nr(this,"overrideFn",null),Nr(this,"horizontalScrollbarHeight",0),Nr(this,"innerViewportHeight",0),Nr(this,"totalCalculatedHeight",0),Nr(this,"startPositions",[]),Nr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=r,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function H2(t,e,n){A2(t,e),e.set(t,n)}function A2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e,n){return(e=N2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N2(t){var e=D2(t,"string");return typeof e=="symbol"?e:e+""}function D2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xl(t,e){return t.get(Tk(t,e))}function fx(t,e,n){return t.set(Tk(t,e),n),n}function Tk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eo=new WeakMap;class cl{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;dx(this,"row",null),dx(this,"col",null),H2(this,Eo,!1),fx(Eo,this,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return xl(Eo,this)}isSouthEastOf(e){return this.row>=e.row&&(xl(Eo,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(xl(Eo,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(xl(Eo,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(xl(Eo,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof cl&&fx(Eo,this,e.isRtl()),this}clone(){return new cl(this.row,this.col,xl(Eo,this))}toObject(){return{row:this.row,col:this.col}}}function k2(t,e,n){L2(t,e),e.set(t,n)}function L2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ry(t,e,n){return(e=$2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $2(t){var e=F2(t,"string");return typeof e=="symbol"?e:e+""}function F2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dr(t,e){return t.get(_k(t,e))}function V2(t,e,n){return t.set(_k(t,e),n),n}function _k(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var er=new WeakMap;class Fd{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ry(this,"highlight",null),ry(this,"from",null),ry(this,"to",null),k2(this,er,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),V2(er,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(r.row,s.row),u=Math.min(r.col,s.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Dr(er,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Dr(er,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Dr(er,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Dr(er,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Dr(er,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Dr(er,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Dr(er,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Dr(er,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof cl))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Dr(er,this)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Dr(er,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Fd(this.highlight,this.from,this.to,Dr(er,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new cl(e,n,Dr(er,this))}}function Di(t,e,n){W2(t,e),e.set(t,n)}function W2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ge(t,e){return t.get(Mk(t,e))}function cs(t,e,n){return t.set(Mk(t,e),n),n}function Mk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kr=new WeakMap,iy=new WeakMap,vn=new WeakMap,Hl=new WeakMap,cf=new WeakMap,ci=new WeakMap,oy=new WeakMap,xc=new WeakMap,da=new WeakMap,ki=new WeakMap;let Ik=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Di(this,kr,void 0),Di(this,iy,void 0),Di(this,vn,void 0),Di(this,Hl,void 0),Di(this,cf,void 0),Di(this,ci,void 0),Di(this,oy,void 0),Di(this,xc,void 0),Di(this,da,[null,null]),Di(this,ki,[null,null]),cs(kr,this,r),cs(iy,this,n),cs(vn,this,o),cs(Hl,this,s),cs(cf,this,a),cs(ci,this,i),cs(oy,this,e),this.registerEvents()}registerEvents(){ge(ci,this).addEventListener(ge(vn,this).holder,"contextmenu",r=>this.onContextMenu(r)),ge(ci,this).addEventListener(ge(vn,this).TABLE,"mouseover",r=>this.onMouseOver(r)),ge(ci,this).addEventListener(ge(vn,this).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ge(ci,this).addEventListener(ge(vn,this).holder,"touchstart",r=>this.onTouchStart(r)),ge(ci,this).addEventListener(ge(vn,this).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ge(ci,this).addEventListener(ge(vn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ge(kr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ge(kr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ge(ci,this).addEventListener(ge(vn,this).holder,"mouseup",r=>this.onMouseUp(r)),ge(ci,this).addEventListener(ge(vn,this).holder,"mousedown",r=>this.onMouseDown(r))};_i()?e():(wE()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ge(xc,this)&&r){const[i,o]=[r.row,ge(xc,this).from.row],[s,a]=[r.col,ge(xc,this).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ge(vn,this).TABLE,i=Ch(e,["TD","TH"],r);return i?(n.coords=ge(vn,this).getCoords(i),n.TD=i):ye(e,"wtBorder")&&ye(e,"current")?(n.coords=ge(Hl,this).getFocusSelection().cellRange.highlight,n.TD=ge(vn,this).getCell(n.coords)):ye(e,"wtBorder")&&ye(e,"area")&&ge(Hl,this).getAreaSelection().cellRange&&(n.coords=ge(Hl,this).getAreaSelection().cellRange.to,n.TD=ge(vn,this).getCell(n.coords)),n}onMouseDown(e){const n=ge(iy,this).rootDocument.activeElement,r=HE(zD,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);ye(i,"corner")?ge(kr,this).getSetting("onCellCornerMouseDown",e,i):o.TD&&ge(kr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ge(ki,this)[0]=o.TD,clearTimeout(ge(da,this)[0]),ge(da,this)[0]=setTimeout(()=>{ge(ki,this)[0]=null},1e3))}onContextMenu(e){if(ge(kr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ge(kr,this).has("onCellMouseOver"))return;const n=ge(vn,this).TABLE,r=Ch(e.target,["TD","TH"],n),i=ge(cf,this)||this;r&&r!==i.lastMouseOver&&Gs(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ge(vn,this).getCoords(r),r))}onMouseOut(e){if(!ge(kr,this).has("onCellMouseOut"))return;const n=ge(vn,this).TABLE,r=Ch(e.target,["TD","TH"],n),i=Ch(e.relatedTarget,["TD","TH"],n),o=ge(cf,this)||this;r&&r!==i&&Gs(r,n)&&(this.callListener("onCellMouseOut",e,ge(vn,this).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ge(kr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ge(ki,this)[0]&&n.TD===ge(ki,this)[1]?(ye(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ge(ki,this)[0]=null,ge(ki,this)[1]=null):n.TD===ge(ki,this)[0]&&(ge(ki,this)[1]=n.TD,clearTimeout(ge(da,this)[1]),ge(da,this)[1]=setTimeout(()=>{ge(ki,this)[1]=null},500)))}onTouchStart(e){cs(xc,this,ge(Hl,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ge(kr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];CE()&&(BD()||jD())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ge(kr,this).getSettingPure(e);o&&o(n,r,i,ge(oy,this).call(this))}destroy(){clearTimeout(ge(da,this)[0]),clearTimeout(ge(da,this)[1]),ge(ci,this).destroy()}};function sy(t,e,n){return(e=B2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B2(t){var e=j2(t,"string");return typeof e=="symbol"?e:e+""}function j2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U2{constructor(e,n,r){sy(this,"offset",void 0),sy(this,"total",void 0),sy(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function ay(t,e,n){return(e=z2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z2(t){var e=Y2(t,"string");return typeof e=="symbol"?e:e+""}function Y2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G2{constructor(e,n,r){ay(this,"offset",void 0),ay(this,"total",void 0),ay(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function hf(t,e,n){return(e=q2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q2(t){var e=K2(t,"string");return typeof e=="symbol"?e:e+""}function K2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X2{constructor(){hf(this,"currentSize",0),hf(this,"nextSize",0),hf(this,"currentOffset",0),hf(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Z2=0,gx=1,VS=2;function ly(t,e,n){return(e=Q2(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q2(t){var e=J2(t,"string");return typeof e=="symbol"?e:e+""}function J2(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eq{constructor(){ly(this,"size",new X2),ly(this,"workingSpace",Z2),ly(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=gx,e.workingSpace=VS,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=VS,e.workingSpace=gx,this.sharedSize=e.getViewSize()}}var mx={},uy,px;function tq(){if(px)return uy;px=1;var t=op(),e=TypeError;return uy=function(n,r){if(!delete n[r])throw new e("Cannot delete property "+t(r)+" of "+t(n))},uy}var wx;function nq(){if(wx)return mx;wx=1;var t=ft(),e=Qu(),n=ec(),r=gN(),i=tq(),o=mN(),s=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(u){return u instanceof TypeError}},l=s||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(c){var h=e(this),d=n(h),f=arguments.length;if(f){o(d+f);for(var m=d;m--;){var w=m+f;m in h?h[w]=h[m]:i(h,w)}for(var b=0;b<f;b++)h[b]=arguments[b]}return r(h,d+f)}}),mx}nq();function rq(t,e,n){return(e=iq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iq(t){var e=oq(t,"string");return typeof e=="symbol"?e:e+""}function oq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vx{constructor(e,n){rq(this,"order",[]),this.order=[...Array(n).keys()].map(r=>e+r)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function sq(t,e,n){return(e=aq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aq(t){var e=lq(t,"string");return typeof e=="symbol"?e:e+""}function lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uq{constructor(e){sq(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:r}=e.getViewSize();let i=Math.max(r,n);if(i===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new vx(o,n),l=new vx(s,r),u=[];for(let c=0;c<i;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(VS)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),r<=a.length&&(i-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function Al(t,e,n){return(e=cq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cq(t){var e=hq(t,"string");return typeof e=="symbol"?e:e+""}function hq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pk{constructor(e,n){Al(this,"rootNode",void 0),Al(this,"nodesPool",void 0),Al(this,"sizeSet",new eq),Al(this,"collectedNodes",[]),Al(this,"viewDiffer",new uq(this.sizeSet)),Al(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[r,i,o,s]=e,a=this.nodesPool(i);switch(this.collectedNodes.push(a),r){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class Ok extends Pk{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Cx(t,e,n){return(e=dq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:e+""}function fq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gq{constructor(e){Cx(this,"nodeType",void 0),Cx(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const i=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,o),o}}function Hc(t,e,n){return(e=mq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mq(t){var e=pq(t,"string");return typeof e=="symbol"?e:e+""}function pq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vd{constructor(e,n){Hc(this,"nodesPool",null),Hc(this,"nodeType",void 0),Hc(this,"rootNode",void 0),Hc(this,"table",null),Hc(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new gq(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function yx(t,e,n){return(e=wq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wq(t){var e=vq(t,"string");return typeof e=="symbol"?e:e+""}function vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cq extends Vd{constructor(){super("TH"),yx(this,"orderViews",new WeakMap),yx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Ok(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(0).start();for(let h=r-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Rl(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(d,[nY(),hY(),mE(h+1),sa(-1)]),n[h](a,d,h)}u.end()}}}class yq extends Vd{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&fo(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ce(this.rootNode,[PD()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ce(s,[OD(),ND(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Rl(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ce(u,[mE(a+1+this.table.rowHeadersCount),sa(-1),rY(),...a>=0?[cY()]:[tY(),Fu("Select whole grid")]]),r[n](l,u,n)}}}}let bx=!1;class bq extends Vd{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!bx&&e>1e3&&(bx=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Y(r,"rowHeader")}}function Sq(t,e,n){return(e=Rq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rq(t){var e=Eq(t,"string");return typeof e=="symbol"?e:e+""}function Eq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nl={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Sx=!1;class Tq extends Vd{constructor(e){super("TR",e),Sq(this,"orderView",void 0),this.orderView=new Pk(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Sx&&e>1e3&&(Sx=!0,Ke(nt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ce(this.rootNode,[PD()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ce(o,[OD(),ND(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?ye(o,Nl.rowEven)||(pe(o,Nl.rowOdd),Y(o,Nl.rowEven)):ye(o,Nl.rowOdd)||(pe(o,Nl.rowEven),Y(o,Nl.rowOdd))}this.orderView.end()}}function Rx(t,e,n){return(e=_q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:e+""}function Mq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iq extends Vd{constructor(){super("TD"),Rx(this,"orderViews",new WeakMap),Rx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new Ok(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),m=c.getCurrentNode();if(ye(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Rl(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,m),this.table.isAriaEnabled()){var o,s;Ce(m,[...m.hasAttribute("role")?[]:[eY()],sa(-1),mE(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function en(t,e,n){return(e=Pq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pq(t){var e=Oq(t,"string");return typeof e=="symbol"?e:e+""}function Oq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xq{constructor(e){let{cellRenderer:n,stylesHandler:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};en(this,"rootNode",void 0),en(this,"rootDocument",void 0),en(this,"rowHeaders",null),en(this,"columnHeaders",null),en(this,"colGroup",null),en(this,"rows",null),en(this,"cells",null),en(this,"rowFilter",null),en(this,"columnFilter",null),en(this,"rowUtils",null),en(this,"columnUtils",null),en(this,"rowsToRender",0),en(this,"columnsToRender",0),en(this,"rowHeaderFunctions",[]),en(this,"rowHeadersCount",0),en(this,"columnHeaderFunctions",[]),en(this,"columnHeadersCount",0),en(this,"cellRenderer",void 0),en(this,"activeOverlayName",void 0),en(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r),o=this.rowUtils;if(i.firstChild){const s=this.renderedRowToSource(r),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?i.firstChild.style.height=`${a-u}px`:i.firstChild.style.height=""}}}}class Hq{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new xq(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new Cq,columnHeaders:new yq(n),colGroup:new bq(r),rows:new Tq(i),cells:new Iq}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cy(t,e,n){return(e=Aq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aq(t){var e=Nq(t,"string");return typeof e=="symbol"?e:e+""}function Nq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dq{constructor(e,n){cy(this,"dataAccessObject",void 0),cy(this,"wtSettings",void 0),cy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function Ex(t,e,n){return(e=kq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kq(t){var e=Lq(t,"string");return typeof e=="symbol"?e:e+""}function Lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $q{constructor(e,n){Ex(this,"dataAccessObject",void 0),Ex(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}getHeightByOverlayName(e,n){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}}function Li(t,e,n){return(e=Fq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fq(t){var e=Vq(t,"string");return typeof e=="symbol"?e:e+""}function Vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ac{constructor(e,n,r,i,o){Li(this,"wtSettings",null),Li(this,"domBindings",void 0),Li(this,"TBODY",null),Li(this,"THEAD",null),Li(this,"COLGROUP",null),Li(this,"hasTableHeight",!0),Li(this,"hasTableWidth",!0),Li(this,"isTableVisible",!1),Li(this,"tableOffset",0),Li(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,bE(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new $q(this.dataAccessObject,this.wtSettings),this.columnUtils=new Dq(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Hq({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ce(r,[qo()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[qo()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!ye(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",this.isMaster&&Ce(r,[sa(-1)]),n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ce(r.parentNode,[qo()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ce(r,[qo()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Rn(this.holder),h=i.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Rn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),m=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new G2(f,o,c),this.columnFilter=new U2(m,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),w=b.skipRender!==!0}w&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(so)||this.is(qs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(so))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),r.refresh(!1),r.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(so)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(d=r.bottomOverlay.resetFixedPosition()||d),d=r.inlineStartOverlay.resetFixedPosition()||d,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Au(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(so))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r,!this.isMaster,"render");if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Qs(n,["TD","TH"])),n===null)return null;const r=n.parentNode;if(!r)return null;const i=r.parentNode;let o=qD(r),s=n.cellIndex;Ms(fl,n,this.wtRootElement)||Ms(hl,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Ms(qs,n,this.wtRootElement)||Ms(so,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),Ms(fl,n,this.wtRootElement)||Ms(dl,n,this.wtRootElement)||Ms(qs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),r=e*n.getDefaultRowHeight(),i=Au(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?Kt:Au,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const m=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-m||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return jt(this.TABLE)}getHeight(){return Kt(this.TABLE)}getTotalWidth(){const e=jt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Kt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ul(this.TABLE)}_modifyRowHeaderWidth(e){let n=tt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Wq="stickyRowsBottom",VE={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};vo(VE,"MIXIN_NAME",Wq,{writable:!1,enumerable:!1});const Bq="stickyColumnsStart",Pp={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vo(Pp,"MIXIN_NAME",Bq,{writable:!1,enumerable:!1});class WE extends ac{constructor(e,n,r,i){super(e,n,r,i,qs)}}st(WE,VE);st(WE,Pp);const hl="top",so="bottom",dl="inline_start",fl="top_inline_start_corner",qs="bottom_inline_start_corner",xk=[hl,so,dl,fl,qs],jq=new Map([[hl,`ht_clone_${hl}`],[so,`ht_clone_${so}`],[dl,`ht_clone_${dl} ht_clone_left`],[fl,`ht_clone_${fl} ht_clone_top_left_corner`],[qs,`ht_clone_${qs} ht_clone_bottom_left_corner`]]);function Uq(t,e){zq(t,e),e.add(t)}function zq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yq(t,e,n){return(e=Gq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gq(t){var e=qq(t,"string");return typeof e=="symbol"?e:e+""}function qq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function df(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ac=new WeakSet;class Kq{constructor(e){Uq(this,Ac),Yq(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,r){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,r);return i||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r)return!1;const o=pr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r)return!1;const o=pr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>i)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>i-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return df(Ac,this,_x).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return df(Ac,this,_x).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return df(Ac,this,Tx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return df(Ac,this,Tx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Tx(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=r.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Rn(r.wtRootElement).left;const u=Math.abs(RE(s,s));if(l>u){const c=EE(s);let h=i.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function _x(t){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=Rn(n.wtRootElement),a=Rp(o,o);if(s.top>a){const l=Au(o);let u=r.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function Lr(t,e,n){return(e=Xq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xq(t){var e=Zq(t,"string");return typeof e=="symbol"?e:e+""}function Zq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BE{get eventManager(){return new Jr(this)}constructor(e,n){Lr(this,"wtTable",void 0),Lr(this,"wtScroll",void 0),Lr(this,"wtViewport",void 0),Lr(this,"wtOverlays",void 0),Lr(this,"selectionManager",void 0),Lr(this,"wtEvent",void 0),Lr(this,"guid",`wt_${dE()}`),Lr(this,"drawInterrupted",!1),Lr(this,"drawn",!1),Lr(this,"activeOverlayName","master"),Lr(this,"domBindings",void 0),Lr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Kq(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Js(r,e[n])}])}}createCellCoords(e,n){return new cl(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Fd(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||QD(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r){return this.wtScroll.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Mx(t,e,n){return(e=Qq(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qq(t){var e=Jq(t,"string");return typeof e=="symbol"?e:e+""}function Jq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eK extends BE{constructor(e,n,r){super(e,n),Mx(this,"cloneSource",void 0),Mx(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new Ik(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function tK(t,e,n){return(e=nK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:e+""}function rK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wd{constructor(e,n,r,i,o){tK(this,"wtSettings",null),vo(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Bu(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Bu(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=rd(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Ke(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+mn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(xk.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${jq.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ce(o,[qo()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===hl||u==="vertical"&&this.type===dl?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=rd(e.TABLE),new eK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;[r,i,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class iK extends Wd{constructor(e,n,r,i,o,s){super(e,n,qs,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else kd(n),this.repositionOverlay();let r=Kt(this.clone.wtTable.TABLE);const i=jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=mn(r)),i.style.bottom=`${o}px`}}const oK="calculatedColumns",Op={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};vo(Op,"MIXIN_NAME",oK,{writable:!1,enumerable:!1});class jE extends ac{constructor(e,n,r,i){super(e,n,r,i,so)}}st(jE,VE);st(jE,Op);function sK(t,e,n){return(e=aK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aK(t){var e=lK(t,"string");return typeof e=="symbol"?e:e+""}function lK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uK extends Wd{constructor(e,n,r,i){super(e,n,so,r,i),sK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new jE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=mn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Sp(n),top),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=mn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Kt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=mn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=ye(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(s,"innerBorderBottom"),o=!a):(pe(s,"innerBorderBottom"),o=a)}return o}}const cK="calculatedRows",UE={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vo(UE,"MIXIN_NAME",cK,{writable:!1,enumerable:!1});class zE extends ac{constructor(e,n,r,i){super(e,n,r,i,dl)}}st(zE,UE);st(zE,Pp);const hK="localHooks",En={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)fm(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};vo(En,"MIXIN_NAME",hK,{writable:!1,enumerable:!1});let Hk=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};st(Hk,En);const Ak="active-header",YE="header",GE="area",mm="focus",dK="fill",fK="row",gK="column",mK="custom-selection",qE=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),r=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};var Ix={},Px;function pK(){if(Px)return Ix;Px=1;var t=Mp();return t("flat"),Ix}pK();function wK(t,e){Nk(t,e),e.add(t)}function Ox(t,e,n){Nk(t,e),e.set(t,n)}function Nk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function At(t,e){return t.get(Hh(t,e))}function xx(t,e,n){return t.set(Hh(t,e),n),n}function Hh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var pi=new WeakMap,On=new WeakMap,ff=new WeakSet;class vK{constructor(){wK(this,ff),Ox(this,pi,void 0),Ox(this,On,void 0)}setActiveOverlay(e){return xx(On,this,e),this}setActiveSelection(e){return xx(pi,this,e),this}scan(){const e=At(pi,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=At(pi,this).getCorners(),{wtTable:s}=At(On,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let m=s.getColumnHeader(h,f);const w=At(On,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:At(pi,this).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});w!==null&&(w!==h&&(m=s.getColumnHeader(w,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=At(pi,this).getCorners(),{wtTable:s}=At(On,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let m=s.getRowHeader(h,f);const w=At(On,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:At(pi,this).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});w!==null&&(w!==h&&(m=s.getRowHeader(w,f)),e(m))}u+=1}}}scanCellsRange(e){const{wtTable:n}=At(On,this);Hh(ff,this,CK).call(this,(r,i)=>{const o=n.getCell(At(On,this).createCellCoords(r,i)),s=At(On,this).getSetting("onAfterDrawSelection",r,i,At(pi,this).settings.layerLevel);typeof s=="string"&&Y(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,r]=At(pi,this).getCorners(),{wtTable:i}=At(On,this);Hh(ff,this,Hx).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(At(On,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=At(pi,this).getCorners(),{wtTable:i}=At(On,this);Hh(ff,this,Hx).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(At(On,this).createCellCoords(o,s));e(a)}})}}function CK(t){let[e,n,r,i]=At(pi,this).getCorners();if(e<0&&r<0||n<0&&i<0)return;const{wtTable:o}=At(On,this),s=e!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),e=Math.max(e,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<e)return}else{const a=o.getCell(At(On,this).createCellCoords(e,n));if(!uo(a))return}for(let a=e;a<=r;a+=1)for(let l=n;l<=i;l+=1)t(a,l)}function Hx(t){const{wtTable:e}=At(On,this),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Ax{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=qE(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),oi(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),_i()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,r=n.getSetting("stylesHandler"),i=r.getCSSVariableValue("cell-mobile-handle-size"),o=r.getCSSVariableValue("cell-mobile-handle-border-radius"),s=r.getCSSVariableValue("cell-mobile-handle-background-color"),a=r.getCSSVariableValue("cell-mobile-handle-border-width"),l=r.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};Oe(h,(f,m)=>{this.selectionHandles.styles.bottomHitArea[m]=f,this.selectionHandles.styles.topHitArea[m]=f});const d=r.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};Oe(d,(f,m)=>{this.selectionHandles.styles.bottom[m]=f,this.selectionHandles.styles.top[m]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),w=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),E=this.wot.wtTable.getHeight();u.top=`${parseInt(r-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(r-w/4*3,10)}px`,c[l]=`${parseInt(i-w/4*3,10)}px`;const C=Math.min(parseInt(i+o,10),b-m-f*2),M=Math.min(parseInt(i+o-w/4,10),b-w-f*2);h[l]=`${C}px`,d[l]=`${M}px`;const H=Math.min(parseInt(r+s,10),E-m-f*2),L=Math.min(parseInt(r+s-w/4,10),E-w-f*2);h.top=`${H}px`,d.top=`${L}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,r,i,o]=e;if(n<0&&i<0||r<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==i||r!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),m=s.getLastRenderedColumn();if(f<0&&m<0||h<0&&d<0){this.disappear();return}let w;if(u){if(r=Math.max(r,f),o=Math.min(o,m),n=Math.max(n,h),i=Math.min(i,d),o<r||i<n){this.disappear();return}w=s.getCell(this.wot.createCellCoords(n,r))}else if(w=s.getCell(this.wot.createCellCoords(n,r)),!uo(w)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(i,o)):w,E=Rn(w),C=u?Rn(b):E,M=Rn(s.TABLE),H=E.top,L=E.left,P=this.wot.wtSettings.getSetting("rtlMode");let O=0,z=0;if(P){const $e=jt(s.TABLE),Ct=jt(w),rt=l.innerWidth-M.left-$e;z=L+Ct-C.left,O=l.innerWidth-L-Ct-rt-1}else z=C.left+jt(b)-L,O=L-M.left-1;if(this.isEntireColumnSelected(n,i)){const $e=n,Ct=this.getDimensionsFromHeader("columns",r,o,$e,M);let rt=null;Ct&&([rt,O,z]=Ct),rt&&(w=rt)}let K=H-M.top-1,A=C.top+Kt(b)-H;if(this.isEntireRowSelected(r,o)){const $e=r,Ct=this.getDimensionsFromHeader("rows",n,i,$e,M);let rt=null;Ct&&([rt,K,A]=Ct),rt&&(w=rt)}const Q=l.getComputedStyle(w);parseInt(Q.borderTopWidth,10)>0&&(K+=1,A=A>0?A-1:0),parseInt(Q[P?"borderRightWidth":"borderLeftWidth"],10)>0&&(O+=1,z=z>0?z-1:0);const X=P?"right":"left",ae=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${K}px`,this.topStyle[X]=`${O}px`,this.topStyle.width=`${z+ae}px`,this.topStyle.display="block",this.startStyle.top=`${K}px`,this.startStyle[X]=`${O}px`,this.startStyle.height=`${A+ae}px`,this.startStyle.display="block",this.bottomStyle.top=`${K+A-parseInt(this.bottomStyle.height,10)+ae}px`,this.bottomStyle[X]=`${O}px`,this.bottomStyle.width=`${z+ae}px`,this.bottomStyle.display="block",this.endStyle.top=`${K}px`,this.endStyle[X]=`${O+z-parseInt(this.endStyle.width,10)+ae}px`,this.endStyle.height=`${A+ae}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const ce=this.wot.getSetting("onModifyGetCellCoords",i,o,!1,"render");let[vt,Ne]=[i,o];if(ce&&Array.isArray(ce)&&([,,vt,Ne]=ce),_i()||!ee||this.isPartRange(vt,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${K+A+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[X]=`${O+z+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let $e=Bu(s.TABLE);const Ct=$e===l;Ct&&($e=a.documentElement);const rt=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,at=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),pn=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const g=Ct?b.getBoundingClientRect().left:b.offsetLeft;let p=!1,y=0;if(P?(y=g-parseInt(this.cornerDefaultStyle.width,10)/2,p=y<0):(y=g+jt(b)+parseInt(this.cornerDefaultStyle.width,10)/2,p=y>=EE($e)),p){const N=Math.floor(O+z+this.cornerCenterPointOffset-at-rt);c?(this.cornerStyle[X]=`${N}px`,this.cornerStyle[P?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[X]=`${N-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(Ct?b.getBoundingClientRect().top:b.offsetTop)+Kt(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=Au($e)){const N=Math.floor(K+A+this.cornerCenterPointOffset-pn-rt);c?(this.cornerStyle.top=`${N}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${N-1}px`}this.cornerStyle.display="block"}_i()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,o,K,O,z,A)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,w=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Kt(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return jt(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(m=l(n,b-i),w=l(r,b-i),!m||!w)return!1;const E=Rn(m),C=Rn(w);return m&&w&&(h=E[f]-o[f]-1,d=C[f]+u(w)-E[f]),[m,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Y(this[e],"hidden"):(ye(this[e],"hidden")&&pe(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Y(this[e],"hidden"):pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",_i()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function yK(t,e){Dk(t,e),e.add(t)}function Dl(t,e,n){Dk(t,e),e.set(t,n)}function Dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xe(t,e){return t.get(KE(t,e))}function Nx(t,e,n){return t.set(KE(t,e),n),n}function KE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xn=new WeakMap,cr=new WeakMap,hy=new WeakMap,yh=new WeakMap,dy=new WeakMap,fa=new WeakMap,Dx=new WeakSet;class bK{constructor(e){yK(this,Dx),Dl(this,xn,void 0),Dl(this,cr,void 0),Dl(this,hy,new vK),Dl(this,yh,new WeakMap),Dl(this,dy,new WeakSet),Dl(this,fa,new Map),Nx(cr,this,e)}setActiveOverlay(e){return Nx(xn,this,e),xe(hy,this).setActiveOverlay(xe(xn,this)),xe(yh,this).has(xe(xn,this))||xe(yh,this).set(xe(xn,this),new Set),this}getFocusSelection(){return xe(cr,this)!==null?xe(cr,this).getFocus():null}getAreaSelection(){return xe(cr,this)!==null?xe(cr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(xe(fa,this).has(e)){const r=xe(fa,this).get(e);if(r.has(xe(xn,this)))return r.get(xe(xn,this));const i=new Ax(xe(xn,this),e.settings);return r.set(xe(xn,this),i),i}const n=new Ax(xe(xn,this),e.settings);return xe(fa,this).set(e,new Map([[xe(xn,this),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=xe(fa,this).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){xe(fa,this).get(e).forEach(n=>n.destroy()),xe(fa,this).delete(e)}render(e){if(xe(cr,this)===null)return;e&&KE(Dx,this,SK).call(this);const n=Array.from(xe(cr,this)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;xe(dy,this).has(s)||(xe(dy,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h?.disappear();continue}a&&xe(hy,this).setActiveSelection(s).scan().forEach(m=>{if(r.has(m)){const w=r.get(m);w.has(a)&&u===!0?w.set(a,w.get(a)+1):w.set(a,1)}else r.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=s.getCorners();xe(xn,this).getSetting("onBeforeDrawBorders",d,c),h?.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>xe(yh,this).get(xe(xn,this)).add(u)),Y(s,l),s.nodeName==="TD"&&Array.isArray((a=xe(cr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&Ce(s,xe(cr,this).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ce(o,[...i.get(o)])})}}function SK(){const t=xe(yh,this).get(xe(xn,this)),e=xe(xn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=xe(xn,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=xe(cr,this).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=xe(cr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=xe(cr,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...xe(cr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)pe(o[a],n),Rl(o[a],s)}),t.clear()}class RK extends Wd{constructor(e,n,r,i){super(e,n,dl,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new zE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Ep(r,`${o}px`,"0px")):(o=this.getScrollPosition(),kd(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,SE(n)),r=o!==n.scrollX}else if(e!==i.scrollLeft){const o=i.scrollLeft;i.scrollLeft=e,r=o!==i.scrollLeft}return r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=mn(r)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=jt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=qE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:r}=this,i=r.getSetting("rowHeaders"),o=r.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&i.length>0&&!ye(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=mn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,ek(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(RE(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?pe(r,"emptyRows"):Y(r,"emptyRows");let l=!1;if(!a){if(o&&!i.length)Y(r,"innerBorderLeft innerBorderInlineStart");else if(!o&&i.length){const u=ye(r,"innerBorderInlineStart");e?(Y(r,"innerBorderLeft innerBorderInlineStart"),l=!u):(pe(r,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const EK="stickyRowsTop",XE={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};vo(XE,"MIXIN_NAME",EK,{writable:!1,enumerable:!1});class ZE extends ac{constructor(e,n,r,i){super(e,n,r,i,fl)}}st(ZE,XE);st(ZE,Pp);function kx(t,e,n){return(e=TK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TK(t){var e=_K(t,"string");return typeof e=="symbol"?e:e+""}function _K(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MK extends Wd{constructor(e,n,r,i,o,s){super(e,n,fl,r,i),kx(this,"topOverlay",void 0),kx(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new ZE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Ep(e,`${i}px`,`${o}px`)}else kd(e);let n=Kt(this.clone.wtTable.TABLE);const r=jt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class QE extends ac{constructor(e,n,r,i){super(e,n,r,i,hl)}}st(QE,XE);st(QE,Op);function IK(t,e,n){return(e=PK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xK extends Wd{constructor(e,n,r,i){super(e,n,hl,r,i),IK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new QE(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Ep(e,"0px",`${i}px`)}else i=this.getScrollPosition(),kd(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,r=this.mainTableScrollableElement;let i=!1;if(r===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(Sp(n),e),i=o!==n.scrollY}else if(e!==r.scrollTop){const o=r.scrollTop;r.scrollTop=e,i=o!==r.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=mn(r)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Kt(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=qE(this.wot),r=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!ye(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=mn(this.domBindings.rootDocument)),n){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=r.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,JD(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Rp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,o=r.getSetting("totalColumns"),s=r.getSetting("preventOverflow")==="horizontal";o?pe(i,"emptyColumns"):Y(i,"emptyColumns");let a=!1;if(!n&&!s){const l=r.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=r.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=ye(i,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||r.getSetting("totalRows")===0?(Y(i,"innerBorderTop"),a=!h):(pe(i,"innerBorderTop"),a=h)}}return a}}function gf(t,e,n){HK(t,e),e.set(t,n)}function HK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function To(t,e,n){return(e=AK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AK(t){var e=NK(t,"string");return typeof e=="symbol"?e:e+""}function NK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ga(t,e,n){return t.set(kk(t,e),n),n}function _o(t,e){return t.get(kk(t,e))}function kk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kl=new WeakMap,mf=new WeakMap,Ll=new WeakMap,pf=new WeakMap;class DK{constructor(e,n,r,i,o,s){To(this,"wot",null),gf(this,kl,[]),To(this,"topOverlay",null),To(this,"bottomOverlay",null),To(this,"inlineStartOverlay",null),To(this,"topInlineStartCornerOverlay",null),To(this,"bottomInlineStartCornerOverlay",null),To(this,"browserLineHeight",void 0),To(this,"wtSettings",null),gf(this,mf,!1),gf(this,Ll,0),gf(this,pf,null),To(this,"resizeObserver",new ResizeObserver(c=>{td(()=>{!Array.isArray(c)||!c.length||(ga(Ll,this,_o(Ll,this)+1),_o(Ll,this)===100&&(Ke("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_o(pf,this)!==null&&clearTimeout(_o(pf,this)),ga(pf,this,setTimeout(()=>{ga(Ll,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=mn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:rd(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[..._o(kl,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new xK(...e),this.bottomOverlay=new uK(...e),this.inlineStartOverlay=new RK(...e),this.topInlineStartCornerOverlay=new MK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new iK(...e,this.bottomOverlay,this.inlineStartOverlay),ga(kl,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){ga(mf,this,_o(kl,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),_o(kl,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_o(kl,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!vE())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{td(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{ga(Ll,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===r)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=sc(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let r=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(r=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==r,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=r,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=r;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!_o(mf,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),ga(mf,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=rd(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:r}=this.domBindings,i=this.scrollableElement===r,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,s)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,o),d=n.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-n.holder.clientWidth),w=f()?1:0,b=m()?1:0;d.width=`${c+b}px`,d.height=`${u+w}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return _(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}function Lx(t,e,n){return(e=kK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kK(t){var e=LK(t,"string");return typeof e=="symbol"?e:e+""}function LK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $K{constructor(e){Lx(this,"settings",{}),Lx(this,"defaults",Object.freeze(this.getDefaults())),Oe(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Js(r,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Oe(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class JE extends ac{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Bu(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=id(e,"height",n),o=id(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ul(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}st(JE,UE);st(JE,Op);class FK{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new w2:new R2],["fullyVisible",()=>new a2],["partiallyVisible",()=>new Rk]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new g2:new y2],["fullyVisible",()=>new i2],["partiallyVisible",()=>new Sk]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Kt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(r===n){const o=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>i&&(i=e.documentElement.clientWidth)}else i=r.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,r=e.clientHeight,i=n.offsetHeight;return r<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollWidth>o.clientWidth}const{holder:e,hider:n}=this.wtTable,r=e.clientWidth,i=n.offsetWidth;return r<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getWorkspaceOffset(){return Rn(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Kt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=jt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=mn(this.domBindings.rootDocument),new x2({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=mn(this.domBindings.rootDocument)),new I2({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,r=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o)}if(e&&!n.getSetting("renderAllColumns")){const o=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:o,rowStartOffset:s,rowEndOffset:a}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,u=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r}=e;if(n===null&&r===null){if(!e.isVisibleInTrimmingContainer)return!0;n=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:o,columnStartOffset:s,columnEndOffset:a}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,u=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(u)&&u>0?(n=Math.max(0,n-Math.min(s,u)),r=Math.min(l,r+Math.min(a,u))):u==="auto"&&(n=Math.max(0,n-Math.ceil(s/2)),r=Math.min(l,r+Math.ceil(a/2))),n<i||n===i&&n>0?!1:!(r>o||r===o&&r<l)}resetHasOversizedColumnHeadersMarked(){Oe(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}class VK extends BE{constructor(e,n){super(e,new $K(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new JE(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new FK(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new bK(this.wtSettings.getSetting("selections")),this.wtEvent=new Ik(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new DK(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Oe(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),pe(this.wtTable.wtRootElement.parentNode,n),Y(this.wtTable.wtRootElement.parentNode,r)}getOverlayByName(e){var n;if(!xk.includes(e))return null;const r=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(n=this.wtOverlays[`${r}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class e0{constructor(e){e instanceof BE?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new e0(n);return()=>r},this._wot=new VK(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r){return this._wot.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function $x(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function WK(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}function Fx(t){let{isLeftClick:e,selection:n,cellRangeMapper:r}=t;if(!e||n.settings.selectionMode!=="multiple")return;const i=n.getSelectedRange(),o=i.clone().map(a=>r.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(i.pop(),n.refresh()):a.length>1&&(i.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const BK=new Map([["touchstart",$x],["touchend",Fx],["mousedown",$x],["mouseover",WK],["mouseup",Fx]]);function fy(t,e){BK.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:_p(t)||t.type==="touchstart",isRightClick:ea(t),...e})}const Lk=new WeakMap,t0=Symbol("rootInstance");function jK(t){Lk.set(t,!0)}function UK(t){return t===t0}function wu(t){return Lk.has(t)}function zK(t,e){$k(t,e),e.add(t)}function hs(t,e,n){$k(t,e),e.set(t,n)}function $k(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(t,e,n){return(e=YK(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:e+""}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zt(t,e){return t.get(Du(t,e))}function tr(t,e,n){return t.set(Du(t,e),n),n}function Du(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gy=new WeakMap,wf=new WeakMap,vf=new WeakMap,Mo=new WeakMap,hi=new WeakMap,my=new WeakMap,py=new WeakMap,$l=new WeakMap,bh=new WeakSet;class qK{constructor(e){zK(this,bh),ds(this,"hot",void 0),ds(this,"eventManager",void 0),ds(this,"settings",void 0),ds(this,"THEAD",void 0),ds(this,"TBODY",void 0),ds(this,"_wt",void 0),ds(this,"activeWt",void 0),hs(this,gy,0),hs(this,wf,0),ds(this,"postponedAdjustElementsSize",!1),hs(this,vf,!1),hs(this,Mo,void 0),hs(this,hi,void 0),hs(this,my,0),hs(this,py,0),hs(this,$l,null),this.hot=e,this.eventManager=new Jr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Du(bh,this,XK).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r){return this._wt.scrollViewport(e,n,r)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Y(e,"handsontable"),tr(hi,this,n.createElement("TABLE")),Y(zt(hi,this),"htCore"),this.hot.getSettings().tableClassName&&Y(zt(hi,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ce(zt(hi,this),[qo()]),Ce(e,[Jz(),AD(-1),Cp(this.hot.countCols()),gY()])),this.THEAD=n.createElement("THEAD"),zt(hi,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),zt(hi,this).appendChild(this.TBODY),this.hot.table=zt(hi,this),this.hot.container.insertBefore(zt(hi,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r,rootWindow:i}=this.hot,o=n.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{tr(vf,this,!0),this.isTextSelectionAllowed(a.target)||(HS(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{tr(vf,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{zt(vf,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&HS(i),a.preventDefault())}),this.eventManager.addEventListener(o,"keyup",a=>{r.isInProgress()&&!a.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",a=>{r.isInProgress()&&_p(a)&&r.finish(),tr(Mo,this,!1);const l=Tp(n.activeElement);xh(n.activeElement)&&!l||(l||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ea(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",a=>{r.isInProgress()&&ea(a)&&(r.finish(),tr(Mo,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),tr(Mo,this,!1)}),this.eventManager.addEventListener(o,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(zt(Mo,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=mn(n);if(n.elementFromPoint(u+m,c)!==d||n.elementFromPoint(u,c+m)!==d)return}else for(;h!==o;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let s=ll(i);for(;s!==null;)this.eventManager.addEventListener(s.document.documentElement,"click",()=>{this.hot.unlisten()}),s=ll(s);this.eventManager.addEventListener(zt(hi,this),"selectstart",a=>{this.settings.fragmentSelection||xh(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}addClassNameToLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&Y(r,e)}removeClassNameFromLicenseElement(e){var n;const r=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");r&&pe(r,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:zt(hi,this),isDataViewInstance:()=>wu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),tr(wf,this,o.length),this.hot.getSettings().ariaTags&&Du(bh,this,Fk).call(this)===this.hot.countCols()&&Du(bh,this,KK).call(this,zt(wf,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),tr(gy,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let w=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(w=this.hot.runHooks("beforeValueRender",w,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,w,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,w,f),this.hot.runHooks("afterRenderer",a,l,u,m,w,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ul(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,tr(Mo,this,!0),tr($l,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ds(o)&&(fy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,tr(Mo,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ds(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ds(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ds(o)&&(zt(Mo,this)&&(!zt($l,this)||zt($l,this).x!==o.clientX||zt($l,this).y!==o.clientY)&&fy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,tr($l,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ds(o)||this.hot.isDestroyed)&&(fy(o,{coords:u,selection:this.hot.selection,cellRangeMapper:sG(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[m,w,b,E]=f;return[m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,E>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(E,-1)):E]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new e0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(xh(e))return!0;const n=Gs(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return zt(Mo,this)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!ye(r,"relative")){fo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;ye(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,r,i),s.className="",Y(s,["relative",...o()])):(fo(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(Ce(a,...qo()),Ce(l,...qo())),this.updateCellHeader(l,e,r,i),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ye(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):ye(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?El(e,r(n,i)):(Js(e,"Â "),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){tr(my,this,e),tr(py,this,n)}getLastSize(){return{width:zt(my,this),height:zt(py,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return zt(gy,this)}getRowHeadersCount(){return zt(wf,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function Fk(){return parseInt(this.hot.rootElement.getAttribute(Cp()[0]),10)}function KK(t){const e=Du(bh,this,Fk).call(this)+t;Ce(this.hot.rootElement,...Cp(e))}function XK(){const t=this.hot.rootElement;this.hasVerticalScroll()?Y(t,"htHasScrollY"):pe(t,"htHasScrollY"),this.hasHorizontalScroll()?Y(t,"htHasScrollX"):pe(t,"htHasScrollX")}var Vx={},Wx={},Bx;function ZK(){if(Bx)return Wx;Bx=1;var t=ft(),e=on(),n=tc(),r=wr(),i=an(),o=mo(),s=vr(),a=oa(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return!n(h,function(f,m){if(!c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),Wx}var jx;function QK(){return jx||(jx=1,ZK()),Vx}QK();const Vk="ABCDEFGHIJKLMNOPQRSTUVWXYZ",WS=Vk.length;function xp(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%WS,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/WS,10);return n}function JK(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=WS**r*(Vk.indexOf(t[n])+1);return e-=1,e}function e3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(xp(i)+(r+1));n.push(o)}return n}function t3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=xp(i)+(r+1);n.push(o)}return n}function n3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function n0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function r0(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Pe(t[0])&&(e=bp(t[0]))),e}function Wk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Bk(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const r3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:r0,createEmptySpreadsheetData:n3,createSpreadsheetData:e3,createSpreadsheetObjectData:t3,dataRowToChangesArray:n0,isArrayOfArrays:Wk,isArrayOfObjects:Bk,spreadsheetColumnIndex:JK,spreadsheetColumnLabel:xp},Symbol.toStringTag,{value:"Module"}));function Nc(t,e,n){return(e=i3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i3(t){var e=o3(t,"string");return typeof e=="symbol"?e:e+""}function o3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Nc(this,"hot",void 0),Nc(this,"data",void 0),Nc(this,"dataType","array"),Nc(this,"colToProp",()=>{}),Nc(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return _(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):fe(n,r,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(Pe(a)||tt(a))if(i?l=[]:l={},!o||i){const c=this.countFirstRowKeys()-1;fe(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(r||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):s?Wg(l,d,f):l[d]=f}})}else Oe(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?Wg(l,c,h):l[c]=h});return l}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=pr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=r:Wg(this.data[e],n,r))}}getAtPhysicalCell(e,n,r){let i=null;if(r)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();i=o?LD(r,n):r[n]}else typeof n=="function"?i=n(r):i=r[n];if(this.hot.hasHook("modifySourceData")){const o=pr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return fe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return r0(this.data)}destroy(){this.data=null,this.hot=null}}var Ux={},zx={},Yx;function a3(){if(Yx)return zx;Yx=1;var t=ft(),e=on(),n=tc(),r=wr(),i=an(),o=mo(),s=vr(),a=oa(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(c){i(this);try{r(c)}catch(f){s(this,"throw",f)}if(l)return e(l,this,c);var h=o(this),d=0;return n(h,function(f,m){if(c(f,d++))return m()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),zx}var Gx;function l3(){return Gx||(Gx=1,a3()),Ux}l3();function qx(t,e,n){return(e=u3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u3(t){var e=c3(t,"string");return typeof e=="symbol"?e:e+""}function c3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;qx(this,"indexedValues",[]),qx(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,tt(this.initValueOrFn)?fe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):fe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}st(Tl,En);function i0(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>tt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function o0(t,e){return Zs(t,(n,r)=>e.includes(r)===!1)}class aa extends Tl{insert(e,n){this.indexedValues=i0(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=o0(this.indexedValues,e),super.remove(e)}}class Hp extends aa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ln(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function s0(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function ad(t,e){return Zs(t,n=>e.includes(n)===!1)}function a0(t,e){return Le(t,n=>n-e.filter(r=>r<n).length)}function l0(t,e){const n=e[0],r=e.length;return Le(t,i=>i>=n?i+r:i)}function h3(t,e,n){return(e=d3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d3(t){var e=f3(t,"string");return typeof e=="symbol"?e:e+""}function f3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ap extends Tl{constructor(){super(...arguments),h3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=ad(this.orderOfIndexes,[e]),tt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=i0(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=l0(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=o0(this.indexedValues,e),this.orderOfIndexes=ad(this.orderOfIndexes,e),this.orderOfIndexes=a0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Bd extends aa{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ln(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const Kx=new Map([["indexesSequence",{getListWithInsertedItems:s0,getListWithRemovedItems:ad}],["physicallyIndexed",{getListWithInsertedItems:i0,getListWithRemovedItems:o0}]]),jk=t=>{if(Kx.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Kx.get(t)};class Uk extends Tl{constructor(){super(e=>e)}insert(e,n){const r=l0(this.indexedValues,n);this.indexedValues=s0(r,e,n),super.insert(e,n)}remove(e){const n=ad(this.indexedValues,e);this.indexedValues=a0(n,e),super.remove(e)}}const Xx=new Map([["hiding",Hp],["index",Tl],["linkedPhysicalIndexToValue",Ap],["physicalIndexToValue",aa],["trimming",Bd]]);function g3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Xx.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Xx.get(t))(e)}function m3(t,e,n){return(e=p3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:e+""}function w3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let BS=0;class u0{constructor(){m3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),BS+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),BS-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Rt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}st(u0,En);function v3(){return BS}function wy(t,e,n){return(e=C3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C3(t){var e=y3(t,"string");return typeof e=="symbol"?e:e+""}function y3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zx extends u0{constructor(e,n){super(),wy(this,"mergedValuesCache",[]),wy(this,"aggregationFunction",void 0),wy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Le(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Le(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function b3(t,e,n){S3(t,e),e.set(t,n)}function S3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function R3(t,e,n){return t.set(zk(t,e),n),n}function E3(t,e){return t.get(zk(t,e))}function zk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vy=new WeakMap;class Yk{constructor(){b3(this,vy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(E3(vy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){R3(vy,this,e)}}st(Yk,En);function Qx(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Dc(t,e,n){T3(t,e),e.set(t,n)}function T3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $r(t,e){return t.get(Gk(t,e))}function Cf(t,e,n){return t.set(Gk(t,e),n),n}function Gk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var yf=new WeakMap,kc=new WeakMap,bf=new WeakMap,Sf=new WeakMap,Rf=new WeakMap;class _3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Dc(this,yf,new Set),Dc(this,kc,[]),Dc(this,bf,[]),Dc(this,Sf,!1),Dc(this,Rf,!1),Cf(Rf,this,e??!1)}createObserver(){const e=new Yk;return $r(yf,this).add(e),e.addLocalHook("unsubscribe",()=>{$r(yf,this).delete(e)}),e._writeInitialChanges(Qx($r(kc,this),$r(bf,this))),e}emit(e){let n=$r(bf,this);(!$r(Sf,this)||$r(kc,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill($r(Rf,this)):Cf(kc,this,new Array(e.length).fill($r(Rf,this))),$r(Sf,this)||(Cf(Sf,this,!0),n=$r(kc,this)));const r=Qx(n,e);$r(yf,this).forEach(i=>i._write(r)),Cf(bf,this,e)}}function Wn(t,e,n){return(e=M3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M3(t){var e=I3(t,"string");return typeof e=="symbol"?e:e+""}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jS{constructor(){Wn(this,"indexesSequence",new Uk),Wn(this,"trimmingMapsCollection",new Zx(e=>e.some(n=>n===!0),!1)),Wn(this,"hidingMapsCollection",new Zx(e=>e.some(n=>n===!0),!1)),Wn(this,"variousMapsCollection",new u0),Wn(this,"hidingChangesObservable",new _3({initialIndexValue:!1})),Wn(this,"notTrimmedIndexesCache",[]),Wn(this,"notHiddenIndexesCache",[]),Wn(this,"isBatched",!1),Wn(this,"indexesSequenceChanged",!1),Wn(this,"indexesChangeSource",void 0),Wn(this,"trimmedIndexesChanged",!1),Wn(this,"hiddenIndexesChanged",!1),Wn(this,"renderablePhysicalIndexesCache",[]),Wn(this,"fromPhysicalToVisualIndexesCache",new Map),Wn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,g3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Bd?this.trimmingMapsCollection.register(e,n):n instanceof Hp?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Le(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=ad(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(s0(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],o=le(i)?i:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),a=Le(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=r==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}st(jS,En);function P3(t,e){return Oe(e,(n,r)=>{Rt(t[r])&&(t[r]=n)}),t}function qk(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Kk(t){le(t)&&NE(nt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function O3(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:x3,getValues:H3}=si("phraseFormatters");function A3(t,e){x3(t,e)}function N3(){return H3()}A3("pluralize",O3);const Xk="ContextMenu:items",Te=Xk,c0=`${Te}.noItems`,h0=`${Te}.insertRowAbove`,d0=`${Te}.insertRowBelow`,f0=`${Te}.insertColumnOnTheLeft`,g0=`${Te}.insertColumnOnTheRight`,m0=`${Te}.removeRow`,p0=`${Te}.removeColumn`,w0=`${Te}.undo`,v0=`${Te}.redo`,pm=`${Te}.readOnly`,C0=`${Te}.clearColumn`,y0=`${Te}.copy`,b0=`${Te}.copyWithHeaders`,S0=`${Te}.copyWithGroupHeaders`,R0=`${Te}.copyHeadersOnly`,E0=`${Te}.cut`,T0=`${Te}.freezeColumn`,_0=`${Te}.unfreezeColumn`,M0=`${Te}.mergeCells`,I0=`${Te}.unmergeCells`,P0=`${Te}.addComment`,O0=`${Te}.editComment`,x0=`${Te}.removeComment`,H0=`${Te}.readOnlyComment`,A0=`${Te}.align`,N0=`${Te}.align.left`,D0=`${Te}.align.center`,k0=`${Te}.align.right`,L0=`${Te}.align.justify`,$0=`${Te}.align.top`,F0=`${Te}.align.middle`,V0=`${Te}.align.bottom`,W0=`${Te}.borders`,B0=`${Te}.borders.top`,j0=`${Te}.borders.right`,U0=`${Te}.borders.bottom`,z0=`${Te}.borders.left`,Y0=`${Te}.borders.remove`,G0=`${Te}.nestedHeaders.insertChildRow`,q0=`${Te}.nestedHeaders.detachFromParent`,K0=`${Te}.hideColumn`,X0=`${Te}.showColumn`,Z0=`${Te}.hideRow`,Q0=`${Te}.showRow`,Zn="Filters:",$t=`${Zn}conditions`,Np=`${$t}.none`,J0=`${$t}.isEmpty`,eT=`${$t}.isNotEmpty`,tT=`${$t}.isEqualTo`,nT=`${$t}.isNotEqualTo`,rT=`${$t}.beginsWith`,iT=`${$t}.endsWith`,oT=`${$t}.contains`,sT=`${$t}.doesNotContain`,D3=`${$t}.byValue`,aT=`${$t}.greaterThan`,lT=`${$t}.greaterThanOrEqualTo`,uT=`${$t}.lessThan`,cT=`${$t}.lessThanOrEqualTo`,hT=`${$t}.isBetween`,dT=`${$t}.isNotBetween`,fT=`${$t}.after`,gT=`${$t}.before`,mT=`${$t}.today`,pT=`${$t}.tomorrow`,wT=`${$t}.yesterday`,vT=`${Zn}labels.filterByCondition`,CT=`${Zn}labels.filterByValue`,yT=`${Zn}labels.conjunction`,Dp=`${Zn}labels.disjunction`,wm=`${Zn}values.blankCells`,bT=`${Zn}buttons.selectAll`,ST=`${Zn}buttons.clear`,RT=`${Zn}buttons.ok`,ET=`${Zn}buttons.cancel`,TT=`${Zn}buttons.placeholder.search`,_T=`${Zn}buttons.placeholder.value`,MT=`${Zn}buttons.placeholder.secondValue`,IT="CheckboxRenderer:",PT=`${IT}checked`,OT=`${IT}unchecked`,k3=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:PT,CHECKBOX_RENDERER_NAMESPACE:IT,CHECKBOX_UNCHECKED:OT,CONTEXTMENU_ITEMS_ADD_COMMENT:P0,CONTEXTMENU_ITEMS_ALIGNMENT:A0,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:V0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:D0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:L0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:N0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:F0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:k0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:$0,CONTEXTMENU_ITEMS_BORDERS:W0,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:U0,CONTEXTMENU_ITEMS_BORDERS_LEFT:z0,CONTEXTMENU_ITEMS_BORDERS_RIGHT:j0,CONTEXTMENU_ITEMS_BORDERS_TOP:B0,CONTEXTMENU_ITEMS_CLEAR_COLUMN:C0,CONTEXTMENU_ITEMS_COPY:y0,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:R0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:S0,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:b0,CONTEXTMENU_ITEMS_CUT:E0,CONTEXTMENU_ITEMS_EDIT_COMMENT:O0,CONTEXTMENU_ITEMS_FREEZE_COLUMN:T0,CONTEXTMENU_ITEMS_HIDE_COLUMN:K0,CONTEXTMENU_ITEMS_HIDE_ROW:Z0,CONTEXTMENU_ITEMS_INSERT_LEFT:f0,CONTEXTMENU_ITEMS_INSERT_RIGHT:g0,CONTEXTMENU_ITEMS_MERGE_CELLS:M0,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:q0,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:G0,CONTEXTMENU_ITEMS_NO_ITEMS:c0,CONTEXTMENU_ITEMS_READ_ONLY:pm,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:H0,CONTEXTMENU_ITEMS_REDO:v0,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Y0,CONTEXTMENU_ITEMS_REMOVE_COLUMN:p0,CONTEXTMENU_ITEMS_REMOVE_COMMENT:x0,CONTEXTMENU_ITEMS_REMOVE_ROW:m0,CONTEXTMENU_ITEMS_ROW_ABOVE:h0,CONTEXTMENU_ITEMS_ROW_BELOW:d0,CONTEXTMENU_ITEMS_SHOW_COLUMN:X0,CONTEXTMENU_ITEMS_SHOW_ROW:Q0,CONTEXTMENU_ITEMS_UNDO:w0,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:_0,CONTEXTMENU_ITEMS_UNMERGE_CELLS:I0,CONTEXT_MENU_ITEMS_NAMESPACE:Xk,FILTERS_BUTTONS_CANCEL:ET,FILTERS_BUTTONS_CLEAR:ST,FILTERS_BUTTONS_OK:RT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:TT,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:MT,FILTERS_BUTTONS_PLACEHOLDER_VALUE:_T,FILTERS_BUTTONS_SELECT_ALL:bT,FILTERS_CONDITIONS_AFTER:fT,FILTERS_CONDITIONS_BEFORE:gT,FILTERS_CONDITIONS_BEGINS_WITH:rT,FILTERS_CONDITIONS_BETWEEN:hT,FILTERS_CONDITIONS_BY_VALUE:D3,FILTERS_CONDITIONS_CONTAINS:oT,FILTERS_CONDITIONS_EMPTY:J0,FILTERS_CONDITIONS_ENDS_WITH:iT,FILTERS_CONDITIONS_EQUAL:tT,FILTERS_CONDITIONS_GREATER_THAN:aT,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:lT,FILTERS_CONDITIONS_LESS_THAN:uT,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:cT,FILTERS_CONDITIONS_NAMESPACE:$t,FILTERS_CONDITIONS_NONE:Np,FILTERS_CONDITIONS_NOT_BETWEEN:dT,FILTERS_CONDITIONS_NOT_CONTAIN:sT,FILTERS_CONDITIONS_NOT_EMPTY:eT,FILTERS_CONDITIONS_NOT_EQUAL:nT,FILTERS_CONDITIONS_TODAY:mT,FILTERS_CONDITIONS_TOMORROW:pT,FILTERS_CONDITIONS_YESTERDAY:wT,FILTERS_DIVS_FILTER_BY_CONDITION:vT,FILTERS_DIVS_FILTER_BY_VALUE:CT,FILTERS_LABELS_CONJUNCTION:yT,FILTERS_LABELS_DISJUNCTION:Dp,FILTERS_NAMESPACE:Zn,FILTERS_VALUES_BLANK_CELLS:wm},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Zk={languageCode:"en-US",[c0]:"No available options",[h0]:"Insert row above",[d0]:"Insert row below",[f0]:"Insert column left",[g0]:"Insert column right",[m0]:["Remove row","Remove rows"],[p0]:["Remove column","Remove columns"],[w0]:"Undo",[v0]:"Redo",[pm]:"Read only",[C0]:"Clear column",[A0]:"Alignment",[N0]:"Left",[D0]:"Center",[k0]:"Right",[L0]:"Justify",[$0]:"Top",[F0]:"Middle",[V0]:"Bottom",[T0]:"Freeze column",[_0]:"Unfreeze column",[W0]:"Borders",[B0]:"Top",[j0]:"Right",[U0]:"Bottom",[z0]:"Left",[Y0]:"Remove border(s)",[P0]:"Add comment",[O0]:"Edit comment",[x0]:"Delete comment",[H0]:"Read-only comment",[M0]:"Merge cells",[I0]:"Unmerge cells",[y0]:"Copy",[b0]:["Copy with header","Copy with headers"],[S0]:["Copy with group header","Copy with group headers"],[R0]:["Copy header only","Copy headers only"],[E0]:"Cut",[G0]:"Insert child row",[q0]:"Detach from parent",[K0]:["Hide column","Hide columns"],[X0]:["Show column","Show columns"],[Z0]:["Hide row","Hide rows"],[Q0]:["Show row","Show rows"],[Np]:"None",[J0]:"Is empty",[eT]:"Is not empty",[tT]:"Is equal to",[nT]:"Is not equal to",[rT]:"Begins with",[iT]:"Ends with",[oT]:"Contains",[sT]:"Does not contain",[aT]:"Greater than",[lT]:"Greater than or equal to",[uT]:"Less than",[cT]:"Less than or equal to",[hT]:"Is between",[dT]:"Is not between",[fT]:"After",[gT]:"Before",[mT]:"Today",[pT]:"Tomorrow",[wT]:"Yesterday",[wm]:"Blank cells",[vT]:"Filter by condition",[CT]:"Filter by value",[yT]:"And",[Dp]:"Or",[bT]:"Select all",[ST]:"Clear",[RT]:"OK",[ET]:"Cancel",[TT]:"Search",[_T]:"Value",[MT]:"Second value",[PT]:"Checked",[OT]:"Unchecked"},L3=k3,US=Zk.languageCode,{register:$3,getItem:Qk,hasItem:F3,getValues:V3}=si("languagesDictionaries");Jk(Zk);function Jk(t,e){let n=t,r=e;return Pe(t)&&(r=t,n=r.languageCode),W3(n,r),$3(n,$n(r)),$n(r)}function W3(t,e){t!==US&&P3(e,Qk(US))}function eL(t){return xT(t)?$n(Qk(t)):null}function xT(t){return F3(t)}function B3(){return V3()}function tL(t,e,n){const r=eL(t);if(r===null)return null;const i=r[e];if(Rt(i))return null;const o=j3(i,n);return Array.isArray(o)?o[0]:o}function j3(t,e){let n=t;return _(N3(),r=>{n=r(t,e)}),n}function U3(t){let e=qk(t);return xT(e)||(e=US,Kk(t)),e}function z3(t,e,n){return(e=Y3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y3(t){var e=G3(t,"string");return typeof e=="symbol"?e:e+""}function G3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ls extends Hk{constructor(e,n){super(e,null),z3(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}function Cy(t){let{activeHeaderClassName:e,...n}=t;return new ls({className:e,...n,selectionType:Ak})}function q3(t){let{areaCornerVisible:e,...n}=t;return new ls({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:GE})}function K3(t){let{...e}=t;return new ls({className:"highlight",...e,selectionType:GE})}function X3(t){let{columnClassName:e,...n}=t;return new ls({className:e,...n,selectionType:gK})}function Z3(t){let{cellCornerVisible:e,...n}=t;return new ls({className:"current",headerAttributes:[pE()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:mm})}function Q3(t){let{border:e,visualCellRange:n,...r}=t;return new ls({...e,...r,selectionType:mK},n)}function J3(t){let{...e}=t;return new ls({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:dK})}function Jx(t){let{headerClassName:e,...n}=t;return new ls({className:e,...n,selectionType:YE})}function eX(t){let{rowClassName:e,...n}=t;return new ls({className:e,...n,selectionType:fK})}function tX(t,e){nX(t,e),e.add(t)}function nX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e,n){return(e=rX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Io(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $i=new WeakSet;class oX{constructor(e){tX(this,$i),nr(this,"options",void 0),nr(this,"layerLevel",0),nr(this,"focus",void 0),nr(this,"fill",void 0),nr(this,"layeredAreas",new Map),nr(this,"areas",new Map),nr(this,"rowHeaders",new Map),nr(this,"columnHeaders",new Map),nr(this,"activeRowHeaders",new Map),nr(this,"activeColumnHeaders",new Map),nr(this,"activeCornerHeaders",new Map),nr(this,"rowHighlights",new Map),nr(this,"columnHighlights",new Map),nr(this,"customSelections",[]),this.options=e,this.focus=Z3(e),this.fill=J3(e)}isEnabledFor(e,n){let r=e;e===mm&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Io($i,this,Po).call(this,this.layeredAreas,q3)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Io($i,this,Po).call(this,this.areas,K3)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Io($i,this,Po).call(this,this.rowHeaders,Jx)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Io($i,this,Po).call(this,this.columnHeaders,Jx)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Io($i,this,Po).call(this,this.activeRowHeaders,Cy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Io($i,this,Po).call(this,this.activeColumnHeaders,Cy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Io($i,this,Po).call(this,this.activeCornerHeaders,Cy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Io($i,this,Po).call(this,this.rowHighlights,eX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Io($i,this,Po).call(this,this.columnHighlights,X3)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Q3({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),_(this.areas.values(),e=>void e.clear()),_(this.layeredAreas.values(),e=>void e.clear()),_(this.rowHeaders.values(),e=>void e.clear()),_(this.columnHeaders.values(),e=>void e.clear()),_(this.activeRowHeaders.values(),e=>void e.clear()),_(this.activeColumnHeaders.values(),e=>void e.clear()),_(this.activeCornerHeaders.values(),e=>void e.clear()),_(this.rowHighlights.values(),e=>void e.clear()),_(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Po(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}function eH(t,e,n){return(e=sX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:e+""}function aX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HT{constructor(e){eH(this,"ranges",[]),eH(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((r,i)=>r.includes(e)&&n(r,i))}findAll(e){const n=[];return this.ranges.forEach((r,i)=>{r.isEqual(e)&&n.push({range:r,layer:i})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(r=>r.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,r)=>!e.includes(r)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new HT(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,r)=>e(n,r)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function lX(t,e){nL(t,e),e.add(t)}function yy(t,e,n){nL(t,e),e.set(t,n)}function nL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(tn(t,e))}function Ef(t,e,n){return t.set(tn(t,e),n),n}function tn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tf=new WeakMap,pt=new WeakMap,Mi=new WeakMap,dn=new WeakSet;class zS{constructor(e,n){lX(this,dn),yy(this,Tf,void 0),yy(this,pt,void 0),yy(this,Mi,{x:0,y:0}),Ef(Tf,this,e),Ef(pt,this,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Ye(pt,this).createCellCoords(e,n);let o=Ye(Tf,this).current().highlight;const s=Ye(pt,this).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=tn(dn,this,rL).call(this),{row:h,col:d}=tn(dn,this,nH).call(this,o),f=Ye(pt,this).fixedRowsBottom(),m=Ye(pt,this).minSpareRows(),w=Ye(pt,this).minSpareCols(),b=Ye(pt,this).autoWrapRow(),E=Ye(pt,this).autoWrapCol(),C=Ye(pt,this).createCellCoords(h+i.row,d+i.col);if(C.row>=c){const L=pr(r&&m>0&&f===0),P=C.col+1,O=Ye(pt,this).createCellCoords(C.row-c,P>=u?P-u:P);this.runLocalHooks("beforeColumnWrap",L,tn(dn,this,Fl).call(this,O),P>=u),L.value?this.runLocalHooks("insertRowRequire",Ye(pt,this).countRenderableRows()):E&&C.assign(O)}else if(C.row<0){const L=pr(E),P=C.col-1,O=Ye(pt,this).createCellCoords(c+C.row,P<0?u+P:P);this.runLocalHooks("beforeColumnWrap",L,tn(dn,this,Fl).call(this,O),P<0),E&&C.assign(O)}if(C.col>=u){const L=pr(r&&w>0),P=C.row+1,O=Ye(pt,this).createCellCoords(P>=c?P-c:P,C.col-u);this.runLocalHooks("beforeRowWrap",L,tn(dn,this,Fl).call(this,O),P>=c),L.value?this.runLocalHooks("insertColRequire",Ye(pt,this).countRenderableColumns()):b&&C.assign(O)}else if(C.col<0){const L=pr(b),P=C.row-1,O=Ye(pt,this).createCellCoords(P<0?c+P:P,u+C.col);this.runLocalHooks("beforeRowWrap",L,tn(dn,this,Fl).call(this,O),P<0),b&&C.assign(O)}const{rowDir:M,colDir:H}=tn(dn,this,tH).call(this,C);a=M,l=H,o=tn(dn,this,Fl).call(this,C)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){const r=Ye(pt,this).createCellCoords(e,n),i=Ye(Tf,this).current(),o=Ye(pt,this).visualToRenderableCoords(i.highlight),s=tn(dn,this,by).call(this,i.to.row,i.from.row),a=tn(dn,this,Sy).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=tn(dn,this,nH).call(this,i.highlight),f=Ye(pt,this).createCellCoords(s+r.row,a+r.col),m=i.getTopStartCorner(),w=i.getTopEndCorner(),b=i.getBottomEndCorner();if(r.col<0&&a>=d&&f.col<d){const H=f.col-d;f.col=tn(dn,this,Sy).call(this,m.col,w.col)+H}else if(r.col>0&&a<=d&&f.col>d){const H=tn(dn,this,Sy).call(this,w.col,m.col),L=Math.max(f.col-H,1);f.col=H+L}if(r.row<0&&s>=h&&f.row<h){const H=f.row-h;f.row=tn(dn,this,by).call(this,m.row,b.row)+H}else if(r.row>0&&s<=h&&f.row>h){const H=tn(dn,this,by).call(this,b.row,m.row),L=Math.max(f.row-H,1);f.row=H+L}const{rowDir:E,colDir:C}=tn(dn,this,tH).call(this,f);u=E,c=C;const M=tn(dn,this,Fl).call(this,f);r.row===0&&r.col!==0?l.col=M.col:r.row!==0&&r.col===0?l.row=M.row:(l.row=M.row,l.col=M.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:n,y:r}=e;Ef(Mi,this,{x:n,y:r})}resetOffsetSize(){Ef(Mi,this,{x:0,y:0})}}function tH(t){const{width:e,height:n}=tn(dn,this,rL).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function rL(){return{width:Ye(Mi,this).x+Ye(pt,this).countRenderableColumns(),height:Ye(Mi,this).y+Ye(pt,this).countRenderableRows()}}function by(t,e){const n=Ye(pt,this).findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ye(Mi,this).y+n}function Sy(t,e){const n=Ye(pt,this).findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ye(Mi,this).x+n}function nH(t){const{row:e,col:n}=Ye(pt,this).visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return Ye(pt,this).createCellCoords(Ye(Mi,this).y+e,Ye(Mi,this).x+n)}function Fl(t){const e=t.clone();return e.col=t.col-Ye(Mi,this).x,e.row=t.row-Ye(Mi,this).y,Ye(pt,this).renderableToVisualCoords(e)}st(zS,En);const kp=0,Lp=1,iL=2,AT=3,uX=[AT,iL],cX=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Ry=Symbol("root"),rH=Symbol("child");function Uu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ry;if(e!==Ry&&e!==rH)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Ry;let i=kp;if(n){const o=t[0];t.length===0?i=Lp:r&&o instanceof Fd?i=AT:r&&Array.isArray(o)?i=Uu(o,rH):t.length>=2&&t.length<=4&&!t.some((a,l)=>!cX[l].includes(typeof a))&&(i=iL)}return i}function ld(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!uX.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===AT;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Rt(u)&&(u=a),Rt(c)&&(c=l),!r){const f=a,m=l,w=u,b=c;a=Math.min(f,w),l=Math.min(m,b),u=Math.max(f,w),c=Math.max(m,b)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function hX(t){const e=Uu(t.getSelected());if(e===kp||e===Lp)return[];const n=ld(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return ln(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function dX(t){const e=Uu(t.getSelected());if(e===kp||e===Lp)return[];const n=ld(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;_(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;_(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return ln(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Vl(t,e,n){fX(t,e),e.set(t,n)}function fX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ma(t,e,n){return(e=gX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gX(t){var e=mX(t,"string");return typeof e=="symbol"?e:e+""}function mX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bt(t,e){return t.get(oL(t,e))}function Fi(t,e,n){return t.set(oL(t,e),n),n}function oL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mn=new WeakMap,pa=new WeakMap,_f=new WeakMap,Lc=new WeakMap,Mf=new WeakMap,$c=new WeakMap;class sL{constructor(e,n){var r=this;ma(this,"settings",void 0),ma(this,"tableProps",void 0),ma(this,"inProgress",!1),ma(this,"selectedRange",new HT((i,o,s)=>this.tableProps.createCellRange(i,o,s))),ma(this,"highlight",void 0),Vl(this,Mn,void 0),Vl(this,pa,void 0),ma(this,"selectedByRowHeader",new Set),ma(this,"selectedByColumnHeader",new Set),Vl(this,_f,!1),Vl(this,Lc,!1),Vl(this,Mf,"unknown"),Vl(this,$c,-1),this.settings=e,this.tableProps=n,this.highlight=new oX({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[pE()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),Fi(Mn,this,new zS(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Fi(pa,this,new zS(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),bt(Mn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),bt(Mn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),bt(Mn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),bt(Mn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),bt(Mn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),bt(Mn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),bt(Mn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),bt(Mn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)}),bt(pa,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformFocus",...o)}),bt(pa,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}markSource(e){Fi(Mf,this,e)}markEndSource(){Fi(Mf,this,"unknown")}getSelectionSource(){return bt(Mf,this)}setExpectedLayers(e){Fi($c,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Fi($c,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Rt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Fi(_f,this,!1),this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Rt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();if(this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single")s.setFrom(s.highlight),s.setTo(s.highlight);else{const l=s.getHorizontalDirection(),u=s.getVerticalDirection(),c=this.isMultiple();s.setTo(n),c&&(l!==s.getHorizontalDirection()||s.getWidth()===1&&!s.includes(s.highlight))&&s.from.assign({col:s.highlight.col}),c&&(u!==s.getVerticalDirection()||s.getHeight()===1&&!s.includes(s.highlight))&&s.from.assign({row:s.highlight.row})}r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=bt($c,this)===-1||this.selectedRange.size()===bt($c,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),i=this.tableProps.countCols();n<this.highlight.layerLevel&&(_(this.highlight.getAreas(),m=>void m.clear()),_(this.highlight.getLayeredAreas(),m=>void m.clear()),_(this.highlight.getRowHeaders(),m=>void m.clear()),_(this.highlight.getColumnHeaders(),m=>void m.clear()),_(this.highlight.getActiveRowHeaders(),m=>void m.clear()),_(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),_(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),_(this.highlight.getRowHighlights(),m=>void m.clear()),_(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(GE,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(YE,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),E=this.tableProps.createCellCoords(e.to.row,-1),C=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),M=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(C).commit(),d.add(b).commit(),f.add(C).commit()):(a.add(b).add(E).commit(),l.add(C).add(M).commit(),d.add(b).add(E).commit(),f.add(C).add(M).commit())}const m=!bt(Lc,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),w=!bt(Lc,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||r===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),w&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&w&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const n=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),n.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(mm,n.highlight)&&r.add(n.highlight).commit().syncWith(n),this.inProgress||(Fi(_f,this,!0),this.runLocalHooks("afterSetFocus",n.highlight))}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?bt(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):bt(Mn,this).resetOffsetSize(),this.setRangeStart(bt(Mn,this).transformStart(e,n,r))}transformEnd(e,n){this.settings.navigableHeaders?bt(Mn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):bt(Mn,this).resetOffsetSize(),this.setRangeEnd(bt(Mn,this).transformEnd(e,n))}transformFocus(e,n){const r=this.selectedRange.current(),{row:i,col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRenderableColumnsInRange(0,o-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);r.highlight.isHeader()?bt(pa,this).setOffsetSize({x:o<0?Math.abs(o):-s,y:i<0?Math.abs(i):-a}):bt(pa,this).setOffsetSize({x:o<0?0:-s,y:i<0?0:-a});const l=bt(pa,this).transformStart(e,n);this.setRangeFocus(l.normalize())}shiftRows(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(We(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(We(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(We(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:i,to:o,highlight:s}=r,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,We(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,We(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,We(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const n=pr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&bt(_f,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Fi(Lc,this,f),d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(We(d.row,u,o-1),We(d.col,c,s-1)));const m=this.tableProps.createCellCoords(u,c),w=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.finish(),Fi(Lc,this,!1)}selectCells(e){var n=this;const r=Uu(e);if(r===Lp)return!1;if(r===kp)throw new Error(nt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=ld(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),_(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(f=We(r.row,u,s-1),m=We(r.col,Math.min(i,o),Math.max(i,o))):(f=We(r,u,s-1),m=i);const w=this.tableProps.createCellCoords(f,m),b=l===0?0:We(w.row,u,-1),E=s-1,C=this.tableProps.createCellCoords(b,i),M=this.tableProps.createCellCoords(E,o);this.runLocalHooks("beforeSelectColumns",C,M,w),C.row=b,M.row=E,this.setRangeStartOnly(C,void 0,w),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",C,M,w),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(r?.row)&&Number.isInteger(r?.col)?(h=We(r.row,Math.min(e,n),Math.max(e,n)),d=We(r.col,a,o-1)):(h=e,d=We(r,a,o-1));const f=this.tableProps.createCellCoords(h,d),m=s===0?0:We(f.col,a,-1),w=o-1,b=this.tableProps.createCellCoords(e,m),E=this.tableProps.createCellCoords(n,w);this.runLocalHooks("beforeSelectRows",b,E,f),b.col=m,E.col=w,this.setRangeStartOnly(b,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.runLocalHooks("afterSelectRows",b,E,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const r=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(r.length),r.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:We(u.row,this.settings.navigableHeaders?-1/0:0,c),col:We(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:We(a.row,-1/0,c),col:We(a.col,-1/0,h)}),l.assign({row:We(l.row,-1/0,c),col:We(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),r=this.selectedRange.current();this.highlight.isEnabledFor(mm,r.highlight)&&this.highlight.getFocus().commit().syncWith(r);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}st(sL,En);const iH=/^(\r\n|\n\r|\r|\n)/,pX=/^[^\t\r\n]+/,oH=/^\t/;function wX(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(oH))t=t.replace(oH,""),n+=1,e[r][n]="";else if(t.match(iH))t=t.replace(iH,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(pX);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Ah(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function wa(t,e,n){return(e=vX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vX(t){var e=CX(t,"string");return typeof e=="symbol"?e:e+""}function CX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tu{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){wa(this,"hot",void 0),wa(this,"metaManager",void 0),wa(this,"tableMeta",void 0),wa(this,"dataSource",void 0),wa(this,"duckSchema",void 0),wa(this,"colToPropCache",void 0),wa(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=bp(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Pe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return r0(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Oe(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Vu(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=$n(this.getSchema()):(m=[],fe(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},Nd(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,r)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=i==="end"?Math.min(h+1,a):h;let f=0;for(let m=d;f<n&&l+f<s;m++){if(typeof c!="number"||c>=l+f)if(u>0)for(let w=0;w<u;w+=1)typeof o[w]>"u"&&(o[w]=[]),o[w].push(null);else o.push([null]);else for(let w=0;w<u;w++)o[w].splice(m,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,r),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];MS(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return RD(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];MS(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&qt(i,n))a=i[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let l=i;if(!l)return null;const u=n.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof n=="function"&&(a=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const l=pr(a);this.hot.runHooks("modifyData",e,this.propToCol(n),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=pr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&qt(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(i,i+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Tu.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Tu.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return Ah(this.getRange(e,n,Tu.DESTINATION_RENDERER))}getCopyableText(e,n){return Ah(this.getRange(e,n,Tu.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:yX,getItem:bX,hasItem:aL,getNames:SX,getValues:ace}=si("cellTypes");function NT(t){if(!aL(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return bX(t)}function Vr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&ur(t,n),r&&Er(t,r),i&&Za(t,i),yX(t,e)}function RX(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!qt(e,t)}function $p(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?NT(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Oe(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Pe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Oe(r,(o,s)=>{if(RX(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Xt(t,i)}function EX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}kD(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Ug(t){return Number.isInteger(t)&&t>=0}function zg(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function If(t){return t==null}const lL=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Lt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Lt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),yp(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function sH(t,e,n){return(e=TX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TX(t){var e=_X(t,"string");return typeof e=="symbol"?e:e+""}function _X(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MX(){return class{}}class IX{constructor(e){sH(this,"metaCtor",MX()),sH(this,"meta",void 0),this.meta=this.metaCtor.prototype,Xt(this.meta,lL()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Xt(this.meta,e),$p(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function PX(t,e,n){return(e=OX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OX(t){var e=xX(t,"string");return typeof e=="symbol"?e:e+""}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HX{constructor(e){PX(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Xt(this.meta,e),$p(this.meta,e,e)}}function Pf(t,e,n){return(e=AX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AX(t){var e=NX(t,"string");return typeof e=="symbol"?e:e+""}function NX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vm{constructor(e){Pf(this,"valueFactory",void 0),Pf(this,"data",[]),Pf(this,"index",[]),Pf(this,"holes",new Set),this.valueFactory=e}obtain(e){zg(()=>Ug(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zg(()=>Ug(e)||If(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=If(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zg(()=>Ug(e)||If(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(If(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&this.data[r]!==void 0&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function aH(t,e,n){return(e=DX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DX(t){var e=kX(t,"string");return typeof e=="symbol"?e:e+""}function kX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LX=["data","width"];class $X{constructor(e){aH(this,"globalMeta",void 0),aH(this,"metas",new vm(()=>this._createMeta())),this.globalMeta=e,this.metas=new vm(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Xt(r,n),$p(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return EX(this.globalMeta.getMetaConstructor(),LX).prototype}}function lH(t,e,n){return(e=FX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FX(t){var e=VX(t,"string");return typeof e=="symbol"?e:e+""}function VX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WX{constructor(e){lH(this,"columnMeta",void 0),lH(this,"metas",new vm(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Xt(i,r),$p(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)le(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){zg(()=>Ug(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new vm(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class uL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new IX(e),this.tableMeta=new HX(this.globalMeta),this.columnMeta=new $X(this.globalMeta),this.cellMeta=new WX(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){const i=this.cellMeta.getMeta(e,n);return i.visualRow=r.visualRow,i.visualCol=r.visualColumn,i.row=e,i.col=n,r.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}st(uL,En);function uH(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Ln(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":tt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Tu(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let w,b=0,E=0;for(b=0,E=d.startRows;b<E;b++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)w=$n(m),t.push(w);else if(i.dataType==="array")w=$n(m[0]),t.push(w);else{w=[];for(let C=0,M=d.startCols;C<M;C++)w.push(null);t.push(w)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ce(i.rootElement,[AD(-1),Cp(i.countCols()+(i.view?i.countRowHeaders():0))])}function cH(t,e,n){return(e=BX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BX(t){var e=jX(t,"string");return typeof e=="symbol"?e:e+""}function jX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UX{constructor(e){var n=this;cH(this,"metaManager",void 0),cH(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ne.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=qt(e,"type")?e.type:null;let c=tt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function zX(t,e,n){YX(t,e),e.set(t,n)}function YX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ey(t,e,n){return(e=GX(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GX(t){var e=qX(t,"string");return typeof e=="symbol"?e:e+""}function qX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KX(t,e){return t.get(XX(t,e))}function XX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hH=new WeakMap;class ZX{constructor(e){Ey(this,"metaManager",void 0),Ey(this,"usageTracker",new Set),Ey(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),zX(this,hH,(n,r,i)=>{if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:r,target:i,onChange:o}=e,s=typeof i=="string",a=s?i:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(i,l,o)):r&&(this.installPropWatcher(n,l,KX(hH,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const cL="gridDefault",la="editorManager.handlingEditor",QX={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},JX="hooksRefRegisterer",hL={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){_(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Oe(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};vo(hL,"MIXIN_NAME",JX,{writable:!1,enumerable:!1});function di(t,e,n){return(e=e4(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:e+""}function t4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const n4="base",Wt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class lc{static get EDITOR_TYPE(){return n4}constructor(e){di(this,"hot",void 0),di(this,"state",Wt.VIRGIN),di(this,"_opened",!1),di(this,"_fullEditMode",!1),di(this,"_closeCallback",null),di(this,"TD",null),di(this,"row",null),di(this,"col",null),di(this,"prop",null),di(this,"originalValue",null),di(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Wt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const l=this.hot.getSelectedLast();r=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),o=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");Array.isArray(a)&&([r,i]=a),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Wt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Wt.EDITING,this.isInFullEditMode()){const l=typeof e=="string"?e:wt(this.originalValue);this.setValue(l)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),r.view.scrollViewport(r._createCellCoords(i,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,n,r){let i;if(r){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),r(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Wt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Wt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:i=[[o]],this.state=Wt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Wt.FINISHED,this.discardEditor(s)}):(this.state=Wt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Wt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Wt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Wt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Wt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Wt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Rn(n),a=jt(n),l=Rn(this.hot.rootElement),u=jt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,{wtTable:w}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,b=w.name,E=["master","inline_start"].includes(b)?d:0,C=["master","top","bottom"].includes(b)?f:0,M=s.top===l.top?0:1;let H=s.top-l.top-M-E,L=0;this.hot.isRtl()?L=o.innerWidth-s.left-a-m-1+C:L=s.left-l.left-1-C,["top","top_inline_start_corner"].includes(b)&&(H+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(L+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const P=this.hot.hasColHeaders(),O=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),A=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(P&&O<=0||O===A)&&(H+=1),z<=0&&(L+=1);const Q=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,ae=Math.abs(r.inlineStartOverlay.getScrollPosition()),ee=r.topOverlay.getScrollPosition(),ce=mn(this.hot.rootDocument);let vt=n.offsetTop;if(["inline_start","master"].includes(b)&&(vt+=Q-ee),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:B,wtTable:G}=r.bottomOverlay.clone;vt+=B.getWorkspaceHeight()-G.getHeight()-ce}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=w.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=X-ae-a):["top","master","bottom"].includes(b)&&(Ne+=X-ae);const $e=o.getComputedStyle(this.TD),Ct=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",rt=parseInt($e[Ct],10)>0?0:1,at=parseInt($e.borderTopWidth,10)>0?0:1,pn=jt(n)+rt,g=Kt(n)+at,p=ME(c)?ce:0,y=IE(h)?ce:0,N=this.hot.view.maximumVisibleElementWidth(Ne)-p+rt,F=Math.max(this.hot.view.maximumVisibleElementHeight(vt)-y+at,this.hot.stylesHandler.getDefaultRowHeight());return{top:H,start:L,height:g,maxHeight:F,width:pn,maxWidth:N}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}st(lc,hL);const r4={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const r=t._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Wt.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},i4={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},o4={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},s4={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},a4={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:o}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const s=t.getSettings(),a=typeof s.enterMoves=="function"?s.enterMoves(e):s.enterMoves;n.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),oi(e))}};function l4(){return[QX,r4,i4,o4,s4,a4]}const u4={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},c4={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},h4={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},d4={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},f4={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,i.col,n),e.markEndSource()}},g4={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},m4={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},p4={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},w4={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},v4={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},C4={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},y4={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:r,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,i.row,n),e.markEndSource()}},b4={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},S4={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:r}=t.getSelectedRangeLast(),i=Math.max(r.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(o!==null){const s=t._createCellCoords(o,r.col),a=r.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function R4(){return[u4,c4,h4,d4,f4,g4,m4,p4,w4,v4,C4,y4,b4,S4]}const E4={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},T4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?1:o,i===t.countRows()-1?o=1:i+o>t.countRows()&&(o=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},_4={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},M4={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,r=t.getSettings(),i=t.getSelectedRangeLast(),o=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},I4={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},P4={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},O4={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),e.setRangeStart(t._createCellCoords(r,n))}},x4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},H4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},A4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,o)),e.markEndSource()}},N4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},D4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},k4={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},L4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},$4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},F4={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),r=n?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let o=t.countVisibleRows()+r;o=o===0?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function V4(){return[E4,T4,_4,M4,I4,P4,O4,x4,H4,A4,N4,D4,k4,L4,$4,F4]}const W4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},B4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},j4={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},U4={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},z4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},Y4=[...l4(),...R4(),...V4(),W4,B4,j4,U4,z4];function dL(t){const e={};return Y4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function G4(t){const e=t.getShortcutManager().addContext("editor"),n=dL(t),r={group:la};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSaveByEnter(i,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,o)=>n.editorCloseAndSaveByArrowKeys(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function q4(t){const e=t.getShortcutManager().addContext("grid"),n=dL(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:cL};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:la,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var i,o;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((o=t.getSelectedRangeLast())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>n.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function K4(t){[q4,G4].forEach(e=>e(t))}function X4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=dH(t),i=dH(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.before(r),n.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function dH(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="__htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ce(n,[Fu("Focus catcher")]),n}function Z4(t){const e=Q4(t);let n;const{activate:r,deactivate:i}=X4(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:YS(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:GS(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,m,w)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,w.value=!0),s){var b;n=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:cL,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?YS(t):GS(t)),u(),!1;h.preventDefault()},position:"after"}])}function YS(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function GS(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function Q4(t){return e=>{if(!e)return null;const n=YS(t),r=GS(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}function uc(t){uo(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function Fp(t){const{selection:e,view:n}=t,r=t.getSelectedRangeLast(),i=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=r.getTopStartCorner().row,m=r.getBottomEndCorner().row,w=f<=h,b=m>=d;return{getComputedColumnTarget(E){return i==="mouse"||i==="keyboard"?E.col:u&&c?r.highlight.col:u?a:c?l:E.col},getComputedRowTarget(E){return i==="mouse"||i==="keyboard"?E.row:w&&b?r.highlight.row:w?f:b?m:E.row}}}function J4(t){return e=>{const n=Fp(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const r=!!t.getSettings().colHeaders;uc(t.getCell(r?-1:0,n,!0))})}}function e6(){return()=>{}}function t6(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:n,col:r}=t.getSelectedRangeLast().highlight;uc(t.getCell(n,r,!0))})}}function n6(t){return e=>{const n=Fp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;uc(t.getCell(i,o,!0))})}}function r6(t){return e=>{const n=Fp(t),r={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{const{row:i,col:o}=r;uc(t.getCell(i,o,!0))})}}function i6(t){return e=>{const n=Fp(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const r=!!t.getSettings().rowHeaders;uc(t.getCell(n,r?-1:0,!0))})}}function o6(t){return e=>{const n=t.selection.getSelectionSource(),{row:r,col:i}=e,o=()=>{uc(t.getCell(r,i,!0))};if(r<0&&i>=0)t.scrollViewportTo({col:i},o);else if(i<0&&r>=0)t.scrollViewportTo({row:r},o);else{if(n==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:i},o)}}}function s6(t){const{selection:e}=t;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r){n=!1;return}let s;e.isFocusSelectionChanged()?s=t6(t):e.isSelectedByCorner()?s=e6():e.isSelectedByRowHeader()?s=i6(t):e.isSelectedByColumnHeader()?s=J4(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=n6(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=o6(t):e.getSelectedRange().size()>1&&(s=r6(t)),(o=s)===null||o===void 0||o(i)}}}const fH=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Of=t=>t.map(e=>{const n=e.toLowerCase();return fH.has(n)?fH.get(n):n}).sort().join("+"),a6=t=>t.split("+"),gH=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Ty=t=>{let{which:e,key:n}=t;if(gH.has(e))return gH.get(e);const r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},fL=Symbol("shortcut-context");function gL(t){return Pe(t)&&t.__kindOf===fL}const l6=t=>{const e=Ip({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:w,position:b,forwardToContext:E}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Rt(c))throw new Error("You need to define the shortcut's group.");if(tt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(nt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const C={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};le(w)&&(C.relativeToGroup=w,C.position=b),gL(E)&&(C.forwardToContext=E),l.forEach(M=>{const H=Of(M);if(e.hasItem(H)){const P=e.getItem(H);let O=P.findIndex(z=>z.group===w);O!==-1?b==="before"?O-=1:O+=1:O=P.length,P.splice(O,0,C)}else e.addItem(H,[C])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Oe(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Of(l);e.removeItem(u)};return{__kindOf:fL,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Of(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=Of(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(a6(h)):(d.length=0,d.push(...f))})}}};function u6(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const c6=["meta","alt","shift","control"],Fc=u6(),Vc=[];let xf=0;function h6(t,e,n,r,i){const o=f=>c6.includes(f),s=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),m&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Ds(f))return;const w=Ty(f);let b=[];o(w)||(b=s(f));const E=[w].concat(b);!i(f,E)&&(dm()&&b.includes("meta")||!dm()&&b.includes("control"))&&i(f,[w].concat(s(f,!0))),r(f)},l=f=>{if(typeof f.key=="string"){const m=Ty(f);o(m)&&Fc.press(m)}},u=f=>{if(typeof f.key=="string"){const m=Ty(f);o(m)&&Fc.release(m)}},c=()=>{Fc.releaseAll()};return{mount:()=>{let f=t;for(xf+=1;f;)xf===1&&(f.document.documentElement.addEventListener("keydown",l),Vc.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Vc.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=ll(f)},unmount:()=>{let f=t;for(xf-=1;f;){if(xf===0){for(let m=0;m<Vc.length;m++){const{event:w,listener:b}=Vc[m];f.document.documentElement.removeEventListener(w,b)}Vc.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=ll(f)}},isPressed:f=>Fc.isPressed(f),releasePressedKeys:()=>Fc.releaseAll()}}const d6=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Ip({errorIdExists:m=>`The "${m}" context name is already registered.`});let s="grid";const a=m=>{const w=l6(m);return o.addItem(m,w),w},l=()=>s,u=m=>o.getItem(m),c=m=>{if(!o.hasItem(m))throw new Error(nt`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=m};let h=!1;const d=function(m,w){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const E=gL(b)?b:u(b);let C=!1;if(!E.hasShortcut(w))return C;const M=E.getShortcuts(w);for(let H=0;H<M.length;H++){const{callback:L,runOnlyIf:P,preventDefault:O,stopPropagation:z,captureCtrl:K,forwardToContext:A}=M[H];if(P(m)===!0){if(h=K,C=L(m,w)===!1,h=!1,O&&m.preventDefault(),z&&(oi(m),m.stopPropagation()),C)break;A&&d(m,w,A)}}return C},f=h6(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};function mH(t){const{classNames:e}=GD(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function f6(t,e){mL(t,e),e.add(t)}function va(t,e,n){mL(t,e),e.set(t,n)}function mL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function An(t,e){return t.get(Ri(t,e))}function jr(t,e,n){return t.set(Ri(t,e),n),n}function Ri(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pH=23;var Ca=new WeakMap,Cm=new WeakMap,DT=new WeakMap,qS=new WeakMap,Is=new WeakMap,Sh=new WeakMap,ud=new WeakMap,Ji=new WeakSet;class g6{constructor(e,n){f6(this,Ji),va(this,Ca,void 0),va(this,Cm,void 0),va(this,DT,void 0),va(this,qS,void 0),va(this,Is,!0),va(this,Sh,{}),va(this,ud,{}),jr(Cm,this,e),jr(qS,this,n)}isClassicTheme(){return An(Is,this)}getCSSVariableValue(e){var n;if(An(Is,this))return null;if(An(Sh,this)[`--ht-${e}`])return An(Sh,this)[`--ht-${e}`];const r=(n=Ri(Ji,this,w6).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Ri(Ji,this,pL).call(this,`--ht-${e}`);if(r!==null)return An(Sh,this)[`--ht-${e}`]=r,r}getStyleForTD(e){var n;return(n=An(ud,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(An(Is,this))return pH;const e=Ri(Ji,this,m6).call(this);return e||pH}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){jr(Ca,this,void 0),jr(Is,this,!0),Ri(Ji,this,_y).call(this);return}if(e&&e!==An(Ca,this)){if(!/ht-theme-.*/.test(e)){Ke(`Invalid theme name: ${e}. Please provide a valid theme name.`),jr(Ca,this,void 0),jr(Is,this,!1),Ri(Ji,this,_y).call(this);return}An(Ca,this)&&Ri(Ji,this,v6).call(this),jr(Ca,this,e),jr(Is,this,!1),Ri(Ji,this,_y).call(this)}}getThemeName(){return An(Ca,this)}}function m6(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function _y(){this.isClassicTheme()||jr(DT,this,getComputedStyle(An(Cm,this)));const t=Ri(Ji,this,p6).call(this,["box-sizing","border-bottom-width"]);An(ud,this).td={...An(ud,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function p6(t){const e=An(qS,this),n=An(Cm,this),r=e.createElement("table"),i=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(r),u}function w6(t){const e=Math.ceil(parseFloat(Ri(Ji,this,pL).call(this,t)));return Number.isNaN(e)?null:e}function pL(t){const e=An(DT,this).getPropertyValue(t);return e===""?null:e}function v6(){jr(ud,this,{}),jr(Sh,this,{}),jr(Is,this,!0)}function C6(t,e){wL(t,e),e.add(t)}function wH(t,e,n){wL(t,e),e.set(t,n)}function wL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vH(t,e){return t.get(zu(t,e))}function CH(t,e,n){return t.set(zu(t,e),n),n}function zu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var KS=new WeakMap,XS=new WeakMap,Nh=new WeakSet;class y6{constructor(e){let{rowIndexMapper:n,columnIndexMapper:r}=e;C6(this,Nh),wH(this,KS,void 0),wH(this,XS,void 0),CH(KS,this,n),CH(XS,this,r)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,i=zu(Nh,this,yH).call(this,e.from,n,r);if(i===null)return null;const o=zu(Nh,this,yH).call(this,e.to,-n,-r);if(o===null)return null;const s=e.clone();return s.from=i,s.to=o,s.includes(e.highlight)||(s.highlight=i),s}}function yH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const r=zu(Nh,this,bH).call(this,vH(KS,this),t.row,e);if(r===null)return null;const i=zu(Nh,this,bH).call(this,vH(XS,this),t.col,n);return i===null?null:t.clone().assign({row:r,col:i})}function bH(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let My=null;const Iy=new Map;function vL(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const s=new Jr(o);let a,l,u,c,h,d,f=!0;UK(i)&&jK(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=wu(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,wu(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Y(this.rootElement,"ht-wrapper"),Y(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),Y(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",w=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",w),this.isRtl=function(){return w==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new g6(o.rootElement,o.rootDocument),e.language=U3(e.language);const b=Object.fromEntries(Object.entries(e).filter(g=>{let[p]=g;return!(ne.getSingleton().isRegistered(p)||ne.getSingleton().isDeprecated(p))})),E=new uL(o,b,[UX,ZX]),C=E.getTableMeta(),M=E.getGlobalMeta(),H=Ip();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),wu(this)&&ID(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${dE()}`,Iy.set(this.guid,this),this.columnIndexMapper=new jS,this.rowIndexMapper=new jS,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{o.runHooks("afterRowSequenceChange",g)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{o.runHooks("beforeCompositionStart",g)}),l=new s3(o);const L=si(this.guid);L.register("cellRangeMapper",new y6({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const P=g=>{const{row:p,col:y}=g;return o._createCellCoords(p>=0?o.rowIndexMapper.getRenderableFromVisualIndex(p):p,y>=0?o.columnIndexMapper.getRenderableFromVisualIndex(y):y)},O=g=>{const{row:p,col:y}=g;return o._createCellCoords(p>=0?o.rowIndexMapper.getVisualFromRenderableIndex(p):p,y>=0?o.columnIndexMapper.getVisualFromRenderableIndex(y):y)},z=(g,p)=>{const y=p>g?1:-1,N=Math.min(g,p),F=Math.max(g,p),B=o.rowIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.rowIndexMapper.getRenderableFromVisualIndex(B):B},K=(g,p)=>{const y=p>g?1:-1,N=Math.min(g,p),F=Math.max(g,p),B=o.columnIndexMapper.getNearestNotHiddenIndex(g,y);return B===null||y===1&&B>F||y===-1&&B<N?null:B>=0?o.columnIndexMapper.getRenderableFromVisualIndex(B):B};let A=new sL(C,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:g=>a.propToCol(g),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(g,p)=>o._createCellCoords(g,p),createCellRange:(g,p,y)=>o._createCellRange(g,p,y),visualToRenderableCoords:P,renderableToVisualCoords:O,findFirstNonHiddenRenderableRow:z,findFirstNonHiddenRenderableColumn:K,isDisabledCellSelection:(g,p)=>g<0||p<0?o.getSettings().disableVisualSelection:o.getCellMeta(g,p).disableVisualSelection});this.selection=A;const Q=g=>{let{hiddenIndexesChanged:p}=g;this.forceFullRender=!0,p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Q),this.rowIndexMapper.addLocalHook("cacheUpdated",Q),this.selection.addLocalHook("afterSetRangeEnd",(g,p)=>{const y=pr(!1),N=this.selection.getSelectedRange(),{from:F,to:B}=N.current(),G=N.size()-1;this.runHooks("afterSelection",F.row,F.col,B.row,B.col,y,G),this.runHooks("afterSelectionByProp",F.row,o.colToProp(F.col),B.row,o.colToProp(B.col),y,G),p&&(!y.isTouched()||y.isTouched()&&!y.value)&&d.scrollTo(g);const v=A.isSelectedByRowHeader(),S=A.isSelectedByColumnHeader();v&&S?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):v?(pe(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):S?(pe(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(A.getSelectionSource())||c.closeEditor(null),A.getSelectionSource()!=="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const p=pr(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(g),c.closeEditor(),o.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const p=g.length-1,{from:y,to:N}=g[p];this.runHooks("afterSelectionEnd",y.row,y.col,N.row,N.col,p),this.runHooks("afterSelectionEndByProp",y.row,o.colToProp(y.col),N.row,o.colToProp(N.col),p),A.getSelectionSource()==="refresh"&&(o.view.render(),c.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const p=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),o.view.render(),pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];return r.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),u={alter(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,F=arguments.length>4?arguments[4]:void 0;const B=G=>{if(G.length===0)return[];const v=[...G];return v.sort((R,T)=>{let[I]=R,[k]=T;return I===k?0:I>k?1:-1}),ln(v,(R,T)=>{let[I,k]=T;const W=R[R.length-1],[x,$]=W,V=x+$;if(I<=V){const j=Math.max(k-(V-I),0);W[1]+=j}else R.push([I,k]);return R},[v[0]])};switch(g){case"insert_row_below":case"insert_row_above":const G=o.countSourceRows();if(C.maxRows===G)return;const v=g==="insert_row_below"?"below":"above";p=p??(v==="below"?G:0);const{delta:S,startPhysicalIndex:R}=a.createRow(p,y,{source:N,mode:v});A.shiftRows(o.toVisualRow(R),S);break;case"insert_col_start":case"insert_col_end":const T=g==="insert_col_end"?"end":"start";p=p??(T==="end"?o.countSourceCols():0);const{delta:I,startPhysicalIndex:k}=a.createCol(p,y,{source:N,mode:T});if(I){if(Array.isArray(C.colHeaders)){const $=[o.toVisualColumn(k),0];$.length+=I,Array.prototype.splice.apply(C.colHeaders,$)}A.shiftColumns(o.toVisualColumn(k),I)}break;case"remove_row":const W=$=>{let V=0;_($,j=>{let[U,ie]=j;const se=Lt(U)?o.countRows()-1:Math.max(U-V,0);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeRow(U,ie,N))return;if(A.isSelected()){const{row:be}=o.getSelectedRangeLast().highlight;be>=U&&be<=U+ie-1&&c.closeEditor(!0)}const Fe=o.countRows(),Ve=C.fixedRowsTop;Ve>=se+1&&(C.fixedRowsTop-=Math.min(ie,Ve-se));const Re=C.fixedRowsBottom;if(Re&&se>=Fe-Re&&(C.fixedRowsBottom-=Math.min(ie,Re)),Fe===0)A.deselect();else if(N==="ContextMenu.removeRow"){const be=A.getSelectedRange(),Je=be.pop();be.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftRows(U,-ie);V+=ie})};Array.isArray(p)?W(B(p)):W([[p,y]]);break;case"remove_col":const x=$=>{let V=0;_($,j=>{let[U,ie]=j;const se=Lt(U)?o.countCols()-1:Math.max(U-V,0);let Se=o.toPhysicalColumn(se);if(Number.isInteger(U)&&(U=Math.max(U-V,0)),!a.removeCol(U,ie,N))return;if(A.isSelected()){const{col:be}=o.getSelectedRangeLast().highlight;be>=U&&be<=U+ie-1&&c.closeEditor(!0)}if(o.countCols()===0)A.deselect();else if(N==="ContextMenu.removeColumn"){const be=A.getSelectedRange(),Je=be.pop();be.clear().set(Je.from).current().setTo(Je.to),A.refresh()}else A.shiftColumns(U,-ie);const Re=C.fixedColumnsStart;Re>=se+1&&(C.fixedColumnsStart-=Math.min(ie,Re-se)),Array.isArray(C.colHeaders)&&(typeof Se>"u"&&(Se=-1),C.colHeaders.splice(Se,ie)),V+=ie})};Array.isArray(p)?x(B(p)):x([[p,y]]);break;default:throw new Error(`There is no such action "${g}"`)}F||u.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const g=C.minRows,p=C.minSpareRows,y=C.minCols,N=C.minSpareCols;if(g){const F=o.countRows();F<g&&a.createRow(F,g-F,{source:"auto"})}if(p){const F=o.countEmptyRows(!0);if(F<p){const B=p-F,G=Math.min(B,C.maxRows-o.countSourceRows());a.createRow(o.countRows(),G,{source:"auto"})}}{let F;(y||N)&&(F=o.countEmptyCols(!0));let B=o.countCols();if(y&&!C.columns&&B<y){const G=y-B;F+=G,a.createCol(B,G,{source:"auto"})}if(N&&!C.columns&&o.dataType==="array"&&F<N){B=o.countCols();const G=N-F,v=Math.min(G,C.maxCols-B);a.createCol(B,v,{source:"auto"})}}},populateFromArray(g,p,y,N,F){let B,G,v,S;const R=[],T={},I=[],k=g.row,W=g.col;if(G=p.length,G===0)return!1;let x=0,$=0;switch(Pe(y)&&(x=y.col-W+1,$=y.row-k+1),F){case"shift_down":const V=Mh(p),j=V.length,U=Math.max(j,x),ie=o.getData().slice(k),se=Mh(ie).slice(W,W+U);for(v=0;v<U;v+=1)if(v<j){for(B=0,G=V[v].length;B<$-G;B+=1)V[v].push(V[v][B%G]);v<se.length?I.push(V[v].concat(se[v])):I.push(V[v].concat(new Array(ie.length).fill(null)))}else I.push(V[v%j].concat(se[v]));o.populateFromArray(k,W,Mh(I));break;case"shift_right":const Se=p.length,Fe=Math.max(Se,$),Ve=o.getData().slice(k).map(yt=>yt.slice(W));for(B=0;B<Fe;B+=1)if(B<Se){for(v=0,S=p[B].length;v<x-S;v+=1)p[B].push(p[B][v%S]);if(B<Ve.length)for(let yt=0;yt<Ve[B].length;yt+=1)p[B].push(Ve[B][yt]);else p[B].push(...new Array(Ve[0].length).fill(null))}else p.push(p[B%G].slice(0,Fe).concat(Ve[B]));o.populateFromArray(k,W,p);break;case"overwrite":default:T.row=g.row,T.col=g.col;let Re=0,be=0,Je=!0,Qn;const yo=function(_t){let gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Xe=p[_t%p.length];return gt!==null?Xe[gt%Xe.length]:Xe},li=p.length,un=y?y.row-g.row+1:0;for(y?G=un:G=Math.max(li,un),B=0;B<G&&!(y&&T.row>y.row&&un>li||!C.allowInsertRow&&T.row>o.countRows()-1||T.row>=C.maxRows);B++){const yt=B-Re,_t=yo(yt).length,gt=y?y.col-g.col+1:0;if(y?S=gt:S=Math.max(_t,gt),T.col=g.col,Qn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Qn.skipRowOnPaste){Re+=1,T.row+=1,G+=1;continue}for(be=0,v=0;v<S&&!(y&&T.col>y.col&&gt>_t||!C.allowInsertColumn&&T.col>o.countCols()-1||T.col>=C.maxCols);v++){if(Qn=o.getCellMeta(T.row,T.col),(N==="CopyPaste.paste"||N==="Autofill.fill")&&Qn.skipColumnOnPaste){be+=1,T.col+=1,S+=1;continue}if(Qn.readOnly&&N!=="UndoRedo.undo"){T.col+=1;continue}const Xe=v-be;let Ar=yo(yt,Xe),Fn=o.getDataAtCell(T.row,T.col);if(Ar!==null&&typeof Ar=="object")if(Array.isArray(Ar)&&Fn===null&&(Fn=[]),Fn===null||typeof Fn!="object")Je=!1;else{const ua=Vu(Array.isArray(Fn)?Fn:Fn[0]||Fn),Jd=Vu(Array.isArray(Ar)?Ar:Ar[0]||Ar);yp(ua,Jd)||Array.isArray(ua)&&Array.isArray(Jd)?Ar=$n(Ar):Je=!1}else Fn!==null&&typeof Fn=="object"&&(Je=!1);Je&&R.push([T.row,T.col,Ar]),Je=!0,T.col+=1}T.row+=1}o.setDataAtCell(R,null,null,N||"populateFromArray");break}}};function X(g){const p=qk(g);xT(p)?(o.runHooks("beforeLanguageChange",p),M.language=p,o.runHooks("afterLanguageChange",p)):Kk(g)}function ae(g,p){const y=g==="className"?o.rootElement:o.table;if(f)Y(y,p);else{let N=[],F=[];M[g]&&(N=Array.isArray(M[g])?M[g]:PS(M[g])),p&&(F=Array.isArray(p)?p:PS(p));const B=IS(N,F),G=IS(F,N);B.length&&pe(y,B),G.length&&Y(y,G)}M[g]=p}this.init=function(){l.setData(C.data),o.runHooks("beforeInit"),(_i()||yE())&&Y(o.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new qK(this);const g=C.themeName||mH(o.rootContainer);o.useTheme(g),c=NS.getInstance(o,C,A),d=s6(o),h=new bG(o),wu(this)&&Z4(o),o.runHooks("init"),this.render(),f&&o.rootElement.offsetParent===null&&nk(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),typeof f=="object"&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")};function ee(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function ce(g){const p=g.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):g}function vt(g,p,y){if(!g.length){y();return}const N=o.getActiveEditor(),F=new ee;let B=!0;F.onQueueEmpty=()=>{N&&B&&N.cancelChanges(),y()};for(let G=g.length-1;G>=0;G--){const[v,S]=g[G],R=a.propToCol(S);let T;Number.isInteger(R)?T=o.getCellMeta(v,R):T={...Object.getPrototypeOf(C),...C},o.getCellValidator(T)&&(F.addValidatorToQueue(),o.validateCell(g[G][3],T,function(I,k){return function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&k.allowInvalid===!1&&(B=!1,g.splice(I,1),k.valid=!0),F.removeValidatorFormQueue()}}(G,T),p))}F.checkIfQueueIsEmpty()}function Ne(g,p){for(let N=g.length-1;N>=0;N--){let F=!1;if(g[N]===null){g.splice(N,1);continue}if(!((g[N][2]===null||g[N][2]===void 0)&&(g[N][3]===null||g[N][3]===void 0))){if(C.allowInsertRow)for(;g[N][0]>o.countRows()-1;){const{delta:B}=a.createRow(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}if(o.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(g[N][1])>o.countCols()-1;){const{delta:B}=a.createCol(void 0,void 0,{source:"auto"});if(B===0){F=!0;break}}F||a.set(g[N][0],g[N][1],g[N][3])}}if(g.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",g,p),c.closeEditor(),o.render(),c.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",g,p||"edit");const N=o.getActiveEditor();N&&le(N.refreshValue)&&N.refreshValue()}else o.render()}this._createCellCoords=function(g,p){return o.view._wt.createCellCoords(g,p)},this._createCellRange=function(g,p,y){return o.view._wt.createCellRange(g,p,y)},this.validateCell=function(g,p,y,N){let F=o.getCellValidator(p);function B(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){y(G);return}const S=p.visualCol,R=p.visualRow,T=o.getCell(R,S,!0);if(T&&T.nodeName!=="TH"){const I=o.rowIndexMapper.getRenderableFromVisualIndex(R),k=o.columnIndexMapper.getRenderableFromVisualIndex(S);o.view._wt.getSetting("cellRenderer",I,k,T)}y(G)}MD(F)&&(F=function(G){return function(v,S){S(G.test(v))}}(F)),tt(F)?(g=o.runHooks("beforeValidate",g,p.visualRow,p.prop,N),o._registerImmediate(()=>{F.call(p,g,G=>{o&&(G=o.runHooks("afterValidate",G,g,p.visualRow,p.prop,N),p.valid=G,B(G),o.runHooks("postAfterValidate",G,g,p.visualRow,p.prop,N))})})):o._registerImmediate(()=>{p.valid=!0,B(p.valid,!1)})};function $e(g,p,y){return Array.isArray(g)?g:[[g,p,y]]}function Ct(g,p){const y=o.runHooks("beforeChange",g,p||"edit"),N=g.filter(B=>B!==null);if(y===!1||N.length===0){var F;return(F=o.getActiveEditor())===null||F===void 0||F.cancelChanges(),[]}for(let B=N.length-1;B>=0;B--){const[G,v,,S]=N[B],R=a.propToCol(v);let T;Number.isInteger(R)?T=o.getCellMeta(G,R):T={...Object.getPrototypeOf(C),...C};const{type:I,checkedTemplate:k,uncheckedTemplate:W}=T;if(I==="numeric"&&typeof S=="string"&&wk(S)&&(N[B][3]=ce(S)),I==="checkbox"){const x=wt(S),$=x===wt(k),V=x===wt(W);($||V)&&(N[B][3]=$?k:W)}}return N}this.setDataAtCell=function(g,p,y,N){const F=$e(g,p,y),B=[];let G=N,v,S,R;for(v=0,S=F.length;v<S;v++){if(typeof F[v]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof F[v][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");F[v][1]>=this.countCols()?R=F[v][1]:R=a.colToProp(F[v][1]),B.push([F[v][0],R,l.getAtCell(this.toPhysicalRow(F[v][0]),F[v][1]),F[v][2]])}!G&&typeof g=="object"&&(G=p);const T=Ct(B,G);o.runHooks("afterSetDataAtCell",T,G),vt(T,G,()=>{Ne(T,G)})},this.setDataAtRowProp=function(g,p,y,N){const F=$e(g,p,y),B=[];let G=N,v,S;for(v=0,S=F.length;v<S;v++)B.push([F[v][0],F[v][1],l.getAtCell(this.toPhysicalRow(F[v][0]),F[v][1]),F[v][2]]);!G&&typeof g=="object"&&(G=p);const R=Ct(B,N);o.runHooks("afterSetDataAtRowProp",R,G),vt(R,G,()=>{Ne(R,G)})},this.listen=function(){o&&!o.isListening()&&(Iy.forEach(g=>{o!==g&&g.unlisten()}),My=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(My=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return My===o.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(g),o.view.render(),p&&A.isSelected()&&c.prepareEditor()},this.populateFromArray=function(g,p,y,N,F,B,G){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const v=typeof N=="number"?o._createCellCoords(N,F):null;return u.populateFromArray(o._createCellCoords(g,p),y,v,B,G)},this.spliceCol=function(g,p,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceCol(g,p,y,...F)},this.spliceRow=function(g,p,y){for(var N=arguments.length,F=new Array(N>3?N-3:0),B=3;B<N;B++)F[B-3]=arguments[B];return a.spliceRow(g,p,y,...F)},this.getSelected=function(){if(A.isSelected())return Le(A.getSelectedRange(),g=>{let{from:p,to:y}=g;return[p.row,p.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.getSelectedRange=function(){if(A.isSelected())return Array.from(A.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let p;return g&&g.length>0&&(p=g[g.length-1]),p},this.emptySelectedCells=function(g){if(!A.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];_(A.getSelectedRange(),y=>{if(y.isSingleHeader())return;const N=y.getTopStartCorner(),F=y.getBottomEndCorner();fe(N.row,F.row,B=>{fe(N.col,F.col,G=>{this.getCellMeta(B,G).readOnly||p.push([B,G,null])})})}),p.length>0&&this.setDataAtCell(p,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(g){this.suspendRender();const p=g();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(p),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const p=g();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!o.view)return;const g=o.view,{width:p,height:y}=g.getLastSize(),{width:N,height:F}=o.rootElement.getBoundingClientRect(),B=N!==p||F!==y;o.runHooks("beforeRefreshDimensions",{width:p,height:y},{width:N,height:F},B)!==!1&&((B||g._wt.wtOverlays.scrollableElement===o.rootWindow)&&(g.setLastSize(N,F),o.render(),g.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:p,height:y},{width:N,height:F},B))},this.updateData=function(g,p){uH(g,y=>{a=y},y=>{a=y,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),A.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:E,firstRun:f})},this.loadData=function(g,p){uH(g,y=>{a=y},()=>{E.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),A.refresh(),f&&(f=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:E,firstRun:f})},this.getInitialColumnCount=function(){const g=C.columns;let p=0;if(Array.isArray(g))p=g.length;else if(tt(g))if(o.dataType==="array"){const y=this.countSourceCols();for(let N=0;N<y;N+=1)g(N)&&(p+=1)}else(o.dataType==="object"||o.dataType==="function")&&(p=a.colToPropCache.length);else if(le(C.dataSchema)){const y=a.getSchema();p=Array.isArray(y)?y.length:bp(y)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,p,y,N){return Rt(g)?a.getAll():a.getRange(o._createCellCoords(g,p),o._createCellCoords(y,N),a.DESTINATION_RENDERER)},this.getCopyableText=function(g,p,y,N){return a.getCopyableText(o._createCellCoords(g,p),o._createCellCoords(y,N))},this.getCopyableData=function(g,p){return a.getCopyable(g,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(f?o.loadData:o.updateData).bind(this);let N=!1,F,B;if(le(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');g.language&&X(g.language);for(F in g)if(!(F==="data"||F==="language"))if(F==="className")ae("className",g.className);else if(F==="tableClassName"&&o.table)ae("tableClassName",g.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ne.getSingleton().isRegistered(F)||ne.getSingleton().isDeprecated(F)){const T=g[F];tt(T)?(ne.getSingleton().addAsFixed(F,T,o),C[F]=T):Array.isArray(T)&&(ne.getSingleton().add(F,T,o),C[F]=T)}else!p&&qt(g,F)&&(M[F]=g[F]);g.data===void 0&&C.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(a.createMap(),o.initIndexMappers());const G=o.countCols(),v=C.columns;if(v&&tt(v)&&(N=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&E.clearCache(),G>0)for(F=0,B=0;F<G;F++){if(v){const T=N?v(F):v[B];T&&E.updateColumnMeta(B,T)}B+=1}le(g.cell)&&Oe(g.cell,T=>{o.setCellMetaObject(T.row,T.col,T)}),o.runHooks("afterCellMetaReset");let S=o.rootElement.style.height;S!==""&&(S=parseInt(o.rootElement.style.height,10));let R=g.height;if(tt(R)&&(R=R()),p&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style")),R===null){const T=o.rootElement.getAttribute("data-initialstyle");T&&(T.indexOf("height")>-1||T.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",T):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else R!==void 0&&(o.rootElement.style.height=isNaN(R)?`${R}`:`${R}px`,o.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let T=g.width;tt(T)&&(T=T()),o.rootElement.style.width=isNaN(T)?`${T}`:`${T}px`}if(!p){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const T=o.getCurrentThemeName();qt(g,"themeName")&&T!==g.themeName&&o.useTheme(g.themeName)}o.runHooks("afterUpdateSettings",g)}u.adjustRowsAndCols(),o.view&&!f&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!p&&o.view&&(S===""||R===""||R===void 0)&&S!==R&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=o.getSelectedLast();if(C.getValue){if(tt(C.getValue))return C.getValue.call(o);if(g)return o.getData()[g[0][0]][C.getValue]}else if(g)return o.getDataAtCell(g[0],g[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,p,y,N,F){u.alter(g,p,y,N,F)},this.getCell=function(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=p,F=g;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;N=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;F=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return F===null||N===null||F===void 0||N===void 0?null:o.view.getCellAtCoords(o._createCellCoords(F,N),y)},this.getCoords=function(g){const p=this.view._wt.wtTable.getCoords(g);if(p===null)return null;const{row:y,col:N}=p;let F=y,B=N;return y>=0&&(F=this.rowIndexMapper.getVisualFromRenderableIndex(y)),N>=0&&(B=this.columnIndexMapper.getVisualFromRenderableIndex(N)),o._createCellCoords(F,B)},this.colToProp=function(g){return a.colToProp(g)},this.propToCol=function(g){return a.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,p){return a.get(g,a.colToProp(p))},this.getDataAtRowProp=function(g,p){return a.get(g,p)},this.getDataAtCol=function(g){const p=[],y=a.getRange(o._createCellCoords(0,g),o._createCellCoords(C.data.length-1,g),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)p.push(y[N][F]);return p},this.getDataAtProp=function(g){const p=[],y=a.getRange(o._createCellCoords(0,a.propToCol(g)),o._createCellCoords(C.data.length-1,a.propToCol(g)),a.DESTINATION_RENDERER);for(let N=0;N<y.length;N+=1)for(let F=0;F<y[N].length;F+=1)p.push(y[N][F]);return p},this.getSourceData=function(g,p,y,N){let F;return g===void 0?F=l.getData():F=l.getByRange(o._createCellCoords(g,p),o._createCellCoords(y,N)),F},this.getSourceDataArray=function(g,p,y,N){let F;return g===void 0?F=l.getData(!0):F=l.getByRange(o._createCellCoords(g,p),o._createCellCoords(y,N),!0),F},this.getSourceDataAtCol=function(g){return l.getAtColumn(g)},this.setSourceDataAtCell=function(g,p,y,N){const F=$e(g,p,y),B=this.hasHook("afterSetSourceDataAtCell"),G=[];B&&_(F,S=>{let[R,T,I]=S;G.push([R,T,l.getAtCell(R,T),I])}),_(F,S=>{let[R,T,I]=S;l.setAtCell(R,T,I)}),B&&this.runHooks("afterSetSourceDataAtCell",G,N),this.render();const v=o.getActiveEditor();v&&le(v.refreshValue)&&v.refreshValue()},this.getSourceDataAtRow=function(g){return l.getAtRow(g)},this.getSourceDataAtCell=function(g,p){return l.getAtCell(g,p)},this.getDataAtRow=function(g){return a.getRange(o._createCellCoords(g,0),o._createCellCoords(g,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,p,y,N){const F=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,p,y,N],[B,G]=F;let[,,v,S]=F,R=null,T=null;v===void 0&&(v=B),S===void 0&&(S=G);let I="mixed";return fe(Math.max(Math.min(B,v),0),Math.max(B,v),k=>{let W=!0;return fe(Math.max(Math.min(G,S),0),Math.max(G,S),x=>(T=this.getCellMeta(k,x).type,R?W=R===T:R=T,W)),I=W?T:"mixed",W}),I},this.removeCellMeta=function(g,p,y){const[N,F]=[this.toPhysicalRow(g),this.toPhysicalColumn(p)];let B=E.getCellMetaKeyValue(N,F,y);o.runHooks("beforeRemoveCellMeta",g,p,y,B)!==!1&&(E.removeCellMeta(N,F,y),o.runHooks("afterRemoveCellMeta",g,p,y,B)),B=null},this.spliceCellsMeta=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,N=new Array(y>2?y-2:0),F=2;F<y;F++)N[F-2]=arguments[F];if(N.length>0&&!Array.isArray(N[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&E.removeRow(this.toPhysicalRow(g),p),N.length>0&&_(N.reverse(),B=>{E.createRow(this.toPhysicalRow(g)),_(B,(G,v)=>this.setCellMetaObject(g,v,G))}),o.render()},this.setCellMetaObject=function(g,p,y){typeof y=="object"&&Oe(y,(N,F)=>{this.setCellMeta(g,p,F,N)})},this.setCellMeta=function(g,p,y,N){if(o.runHooks("beforeSetCellMeta",g,p,y,N)===!1)return;let B=g,G=p;g<this.countRows()&&(B=this.toPhysicalRow(g)),p<this.countCols()&&(G=this.toPhysicalColumn(p)),E.setCellMeta(B,G,y,N),o.runHooks("afterSetCellMeta",g,p,y,N)},this.getCellsMeta=function(){return E.getCellsMeta()},this.getCellMeta=function(g,p){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},N=this.toPhysicalRow(g),F=this.toPhysicalColumn(p);return N===null&&(N=g),F===null&&(F=p),E.getCellMeta(N,F,{visualRow:g,visualColumn:p,...y})},this.getColumnMeta=function(g){return E.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return E.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||C.columns)},this.getCellRenderer=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).renderer:g.renderer;return typeof y=="string"?sd(y):Rt(y)?sd("text"):y},this.getCellEditor=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).editor:g.editor;return typeof y=="string"?od(y):Rt(y)?od("text"):y},this.getCellValidator=function(g,p){const y=typeof g=="number"?o.getCellMeta(g,p).validator:g.validator;return typeof y=="string"?FE(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,p){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,g)},this.validateColumns=function(g,p){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,g)},this._validateCells=function(g,p,y){const N=new ee;g&&(N.onQueueEmpty=g);let F=o.countRows()-1;for(;F>=0;){if(p!==void 0&&p.indexOf(F)===-1){F-=1;continue}let B=o.countCols()-1;for(;B>=0;){if(y!==void 0&&y.indexOf(B)===-1){B-=1;continue}N.addValidatorToQueue(),o.validateCell(o.getDataAtCell(F,B),o.getCellMeta(F,B),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(N.valid=!1),N.removeValidatorFormQueue()},"validateCells"),B-=1}F-=1}N.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let p=C.rowHeaders,y=g;return y!==void 0&&(y=o.runHooks("modifyRowHeader",y)),y===void 0?(p=[],fe(o.countRows()-1,N=>{p.push(o.getRowHeader(N))})):Array.isArray(p)&&p[y]!==void 0?p=p[y]:tt(p)?p=p(y):p&&typeof p!="string"&&typeof p!="number"&&(p=y+1),p},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let g=0,p=o.countCols();g<p;g++)if(o.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=o.runHooks("modifyColHeader",g);if(y===void 0){const v=[],S=o.countCols();for(let R=0;R<S;R++)v.push(o.getColHeader(R));return v}let N=C.colHeaders;const F=function(v){const S=[],R=o.countCols();let T=0;for(;T<R;T++)tt(C.columns)&&C.columns(T)&&S.push(T);return S[v]},B=o.toPhysicalColumn(y),G=F(B);return C.colHeaders===!1?N=null:C.columns&&tt(C.columns)&&C.columns(G)&&C.columns(G).title?N=C.columns(G).title:C.columns&&C.columns[B]&&C.columns[B].title?N=C.columns[B].title:Array.isArray(C.colHeaders)&&C.colHeaders[B]!==void 0?N=C.colHeaders[B]:tt(C.colHeaders)?N=C.colHeaders(B):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(N=xp(y)),N=o.runHooks("modifyColumnHeaderValue",N,g,p),N},this._getColWidthFromSettings=function(g){let p;if(g>=0&&(p=o.getCellMeta(0,g).width),(p===void 0||p===C.width)&&(p=C.colWidths),p!=null){switch(typeof p){case"object":p=p[g];break;case"function":p=p(g);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(g,p){let y=o._getColWidthFromSettings(g);return y=o.runHooks("modifyColWidth",y,g,p),y===void 0&&(y=ju),y},this._getRowHeightFromSettings=function(g){const p=o.stylesHandler.getDefaultRowHeight();let y=C.rowHeights;if(y!=null){switch(typeof y){case"object":y=y[g];break;case"function":y=y(g);break}typeof y=="string"&&(y=parseInt(y,10))}return y!=null&&y<p?p:y},this.getRowHeight=function(g,p){let y=o._getRowHeightFromSettings(g);return y=o.runHooks("modifyRowHeight",y,g,p),y},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const g=C.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,p)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return LS(o.countRows()-1,y=>{if(o.isEmptyRow(y))p+=1;else if(g===!0)return!1}),p},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return LS(o.countCols()-1,y=>{if(o.isEmptyCol(y))p+=1;else if(g===!0)return!1}),p},this.isEmptyRow=function(g){return C.isEmptyRow.call(o,g)},this.isEmptyCol=function(g){return C.isEmptyCol.call(o,g)},this.selectCell=function(g,p,y,N){let F=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,B=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Rt(g)||Rt(p)?!1:this.selectCells([[g,p,y,N]],F,B)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const N=A.selectCells(g);return N&&y&&o.listen(),d.resume(),N},this.selectColumns=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectColumns(g,p,y)},this.selectRows=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return A.selectRows(g,p,y)},this.deselectCell=function(){A.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),A.selectAll(g,p,y)};const rt=(g,p)=>g.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(g,p){if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:N,col:F,considerHiddenIndexes:B}=g??{};let G=N,v=F;if(tt(p)&&this.addHookOnce("afterScroll",p),B===void 0||B){const I=Number.isInteger(N)&&N>=0,k=Number.isInteger(F)&&F>=0,W=I?rt(this.rowIndexMapper,N):void 0,x=k?rt(this.columnIndexMapper,F):void 0;if(W===null||x===null)return!1;G=I?o.rowIndexMapper.getRenderableFromVisualIndex(W):N,v=k?o.columnIndexMapper.getRenderableFromVisualIndex(x):F}const S=Number.isInteger(G),R=Number.isInteger(v);let T=!1;return S&&G>=0&&R&&v>=0?T=o.view.scrollViewport(o._createCellCoords(G,v),g.horizontalSnap,g.verticalSnap):S&&G>=0&&(R&&v<0||!R)?T=o.view.scrollViewportVertically(G,g.verticalSnap):R&&v>=0&&(S&&G<0||!S)&&(T=o.view.scrollViewportHorizontally(v,g.horizontalSnap)),tt(p)&&(T?this.view.render():(this.removeHook("afterScroll",p),this._registerMicrotask(()=>p()))),T},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;tt(g)&&this.addHookOnce("afterScroll",g);const{highlight:p}=this.getSelectedRangeLast(),y=this.scrollViewportTo(p.toObject());return y?this.view.render():tt(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),y},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),L.clear(),E.clearCache(),Iy.delete(this.guid),s.destroy(),c&&c.destroy(),o.rootContainer&&fo(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),H.getItems().forEach(g=>{let[,p]=g;p.destroy()}),H.clear(),o.runHooks("afterDestroy")},!0),ne.getSingleton().destroy(o),Oe(o,(g,p,y)=>{tt(g)?y[p]=at(p):p!=="guid"&&(y[p]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,u=null,A=null,c=null,o=null};function at(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return H.getItem(Ln(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(g)},this.getInstance=function(){return o},this.addHook=function(g,p,y){ne.getSingleton().add(g,p,o,y)},this.hasHook=function(g){return ne.getSingleton().has(g,o)||ne.getSingleton().has(g)},this.addHookOnce=function(g,p,y){ne.getSingleton().once(g,p,o,y)},this.removeHook=function(g,p){ne.getSingleton().remove(g,p,o)},this.runHooks=function(g,p,y,N,F,B,G){return ne.getSingleton().run(o,g,p,y,N,F,B,G)},this.getTranslatedPhrase=function(g,p){return tL(C.language,g,p)},this.toHTML=()=>DS(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",DS(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const p=!!f;this.stylesHandler.useTheme(g);const y=this.stylesHandler.getThemeName();wu(this)&&(pe(this.rootWrapperElement,/ht-theme-.*/g),pe(this.rootPortalElement,/ht-theme-.*/g),y&&(Y(this.rootWrapperElement,y),Y(this.rootPortalElement,y),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ke(`The "${y}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),p||(o.render(),o.scrollViewportTo(0,0),mH(this.rootContainer)&&(pe(this.rootContainer,/ht-theme-.*/g),y&&Y(this.rootContainer,y))),this.runHooks("afterSetTheme",y,p)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,p)),this.timeouts.push(y)},this._clearTimeouts=function(){_(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){_(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return c};const pn=d6({handleEvent(){return o.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&pn.releasePressedKeys()}),this.getShortcutManager=function(){return pn},this.getFocusManager=function(){return h},$E().forEach(g=>{const p=$d(g);H.addItem(g,new p(this))}),K4(o),pn.setActiveContextName("grid"),ne.getSingleton().run(o,"construct")}function SH(t,e,n){t.addEventListener(e,n,!1)}function RH(t,e,n){t.removeEventListener(e,n,!1)}function Hf(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function CL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},r=t.body,i=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;i.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Hf(s).fontSize,o.style.fontFamily=Hf(s).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);const f=parseInt(((h=Hf(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),m=parseInt(((d=Hf(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),w=o.clientWidth+f+m+1;r.removeChild(o);const b=s.style;b.height=`${n.minHeight}px`,n.minWidth>w?b.width=`${n.minWidth}px`:w>n.maxWidth?b.width=`${n.maxWidth}px`:b.width=`${w}px`;const E=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>E?b.height=`${n.minHeight}px`:n.maxHeight<E?(b.height=`${n.maxHeight}px`,b.overflowY="visible"):b.height=`${E}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(i))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(SH(s,"input",a),SH(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){RH(s,"input",a),RH(s,"keydown",l)}}}function EH(t,e){const n=TE(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Dd(e,i)}function ya(t,e,n){return(e=b6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b6(t){var e=S6(t,"string");return typeof e=="symbol"?e:e+""}function S6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R6="ht_editor_visible",Af="ht_editor_hidden",TH="textEditor",E6="text";class _l extends lc{static get EDITOR_TYPE(){return E6}constructor(e){super(e),ya(this,"eventManager",new Jr(this)),ya(this,"autoResize",CL(this.hot.rootDocument)),ya(this,"TEXTAREA",void 0),ya(this,"textareaStyle",void 0),ya(this,"TEXTAREA_PARENT",void 0),ya(this,"textareaParentStyle",void 0),ya(this,"layerClass",void 0),this.eventManager=new Jr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Oh(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Wt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Wt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Dd(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ce(this.TEXTAREA,[["data-hot-input",""],sa(-1)]),Y(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Y(this.TEXTAREA_PARENT,"handsontableInputHolder"),ye(this.TEXTAREA_PARENT,this.layerClass)&&pe(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Af),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){UD()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",pe(this.TEXTAREA_PARENT,this.layerClass),Y(this.TEXTAREA_PARENT,Af)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;fe(e.length-1,r=>{const i=e[r];if(ye(i,"handsontableEditor"))return n=!0,!1}),ye(this.TEXTAREA_PARENT,Af)&&pe(this.TEXTAREA_PARENT,Af),n?(this.layerClass=R6,Y(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Y(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Wt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){CE()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Wt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:TH},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;EH(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;EH(a,this.TEXTAREA)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TH)}}const T6="base",_6="htTextEllipsis";function jd(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Y(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(MO())):a&&c.push(MO()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(IO())):(u.push(s.invalidCellClassName),a&&c.push(IO()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(_6),pe(e,u),Y(e,l),Rl(e,c),Ce(e,h)}jd.RENDERER_TYPE=T6;const M6="text";function us(t,e,n,r,i,o,s){jd.apply(this,[t,e,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=wt(a),s.trimWhitespace&&(a=a.trim()),Js(e,a)}us.RENDERER_TYPE=M6;const I6="text",yL={CELL_TYPE:I6,editor:_l,renderer:us};Vr(yL);oe.editors={BaseEditor:lc};function oe(t,e){const n=new vL(t,e||{},t0);return n.init(),n}oe.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new vL(t,e,t0)};oe.DefaultSettings=lL();oe.hooks=ne.getSingleton();oe.CellCoords=cl;oe.CellRange=Fd;oe.packageName="handsontable";oe.buildDate="10/07/2025 10:59:01";oe.version="16.0.1";oe.languages={dictionaryKeys:L3,getLanguageDictionary:eL,getLanguagesDictionaries:B3,registerLanguageDictionary:Jk,getTranslatedPhrase:tL};function _H(t,e,n){return(e=P6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P6(t){var e=O6(t,"string");return typeof e=="symbol"?e:e+""}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MH="handsontableEditor",x6="handsontable";class kT extends _l{constructor(){super(...arguments),_H(this,"isFlippedVertically",!1),_H(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return x6}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Dd(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Xt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;r=Math.max(r+a,0)}const i=this.getDropdownHeight(),o=e.getWorkspaceHeight()-r-n.height,s=i>o&&r>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:r,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let r=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;r=Math.max(r+a,0)}const i=this.getDropdownWidth(),o=e.getWorkspaceWidth()-r+n.width,s=i>o&&r>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:r,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:MH,relativeToGroup:la,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),oi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedLast()&&(this.isFlippedVertically?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!this.isFlippedVertically)a=0;else if(s.getSelectedLast()){if(this.isFlippedVertically)a=s.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(MH)}}function H6(t,e){bL(t,e),e.add(t)}function IH(t,e,n){bL(t,e),e.set(t,n)}function bL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nf(t,e,n){return(e=A6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A6(t){var e=N6(t,"string");return typeof e=="symbol"?e:e+""}function N6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Py(t,e){return t.get(ZS(t,e))}function ZS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const D6="autocomplete";var Oy=new WeakMap,PH=new WeakMap,xy=new WeakSet;class LT extends kT{constructor(){super(...arguments),H6(this,xy),Nf(this,"query",null),Nf(this,"strippedChoices",[]),Nf(this,"rawChoices",[]),IH(this,Oy,this.hot.guid.slice(0,9)),IH(this,PH,Ld(()=>{this.focus()},100)),Nf(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=xS(wt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return D6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Y(this.htContainer,"autocompleteEditor"),Y(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[dY(),aY(),HD("listbox"),pY()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[Zr("false"),wY(`${Py(Oy,this)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",Py(PH,this)),this.htEditor.updateSettings({colWidths:e?[jt(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{us(a,l,u,c,h,d,f);const{filteringCaseSensitive:m,allowHtml:w,locale:b}=this.cellProperties,E=this.query;let C=wt(d),M,H;C&&!w&&(M=m===!0?C.indexOf(E):C.toLocaleLowerCase(b).indexOf(E.toLocaleLowerCase(b)),M!==-1&&(H=C.substr(M,E.length),C=C.replace(H,`<strong>${H}</strong>`))),n&&Ce(l,[lY(),...r?[bY(i)]:[],...r?[SY(r.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=C},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{Ce(h,[pE()]),Ce(this.TEXTAREA,...vY(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(Ce(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...qo()),Ce(this.htEditor.rootElement,[xD(),CY("polite"),yY("text"),["id",`${Py(Oy,this)}-listbox-${o}-${s}`]]),Ce(this.TEXTAREA,...Zr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ce(this.TEXTAREA,[Zr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=TE(this.TEXTAREA),r=tk(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Mh([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Dd(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:r,spaceBelow:i}=e;return this.limitDropdownIfNeeded(n?r:i),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let r=0,i=0,o=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),r+=i;while(r<e);o=r-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(r-i)}}updateDropdownDimensions(){const e=_E(),n=this.getTargetEditorWidth()+e,r=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:r}),ZS(xy,this,OH).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),ZS(xy,this,OH).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(i,o)=>o).reduce((i,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return i+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Le(e,o=>wt(o));return Le(r,o=>n?o:xS(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===de.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===de.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(sk(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function OH(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+mn(this.hot.rootDocument)})}const k6="checkbox";class SL extends lc{static get EDITOR_TYPE(){return k6}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const r=this.TD.querySelector('input[type="checkbox"]');ye(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ws=()=>window,Gr=()=>window.document,QS=(t,e)=>window.setTimeout(t,e),Zi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Oo=function(t,e,n,r){t.removeEventListener(e,n,!!r)},L6=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Rr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Hy=function(t,e){Rr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Ay=function(t,e){t.className=L6((" "+t.className+" ").replace(" "+e+" "," "))},$T=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ir=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},$6=function(t){let e=t.getDay();return e===0||e===6},F6=function(t){return t%4===0&&t%100!==0||t%400===0},xH=function(t,e){return[31,F6(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Df=function(t){Ir(t)&&t.setHours(0,0,0,0)},kf=function(t,e){return t.getTime()===e.getTime()},ym=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?Ir(e[r])?n&&(t[r]=new Date(e[r].getTime())):$T(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=ym({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},HH=function(t,e,n){let r=Gr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ym(r,n),t.dispatchEvent(r)},AH=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Vi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},NH=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},V6=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},W6=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},B6=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():W6(o,i))+"</td>"},j6=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},U6=function(t){return"<tbody>"+t.join("")+"</tbody>"},z6=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+NH(t,e)+'">'+NH(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Y6=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,m,w=!0,b=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",$T(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return m='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(r===0||u.minMonth>=r)&&(w=!1),h&&(r===11||u.maxMonth<=r)&&(b=!1),e===0&&(d+='<button class="pika-prev'+(w?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},G6=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+z6(t)+U6(e)+"</table>"};function JS(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Ws().event;let o=i.target||i.srcElement;if(o)if(Rr(o,"is-disabled")||(Rr(o,"pika-button")&&!Rr(o,"is-empty")&&!Rr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&QS(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Rr(o,"pika-prev")?e.prevMonth():Rr(o,"pika-next")&&e.nextMonth()),Rr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Ws().event;let o=i.target||i.srcElement;o&&(Rr(o,"pika-select-month")?e.gotoMonth(o.value):Rr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||Ws().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),Ir(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Gr().activeElement;do if(Rr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=QS(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Ws().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&Rr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Zi(o,"change",e._onChange)));do if(Rr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Gr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Zi(e.el,"mousedown",e._onMouseDown,!0),Zi(e.el,"touchend",e._onMouseDown,!0),Zi(e.el,"change",e._onChange),n.keyboardInput&&Zi(Gr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Gr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Zi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;Ir(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Zi(n.trigger,"click",e._onInputClick),Zi(n.trigger,"focus",e._onInputFocus),Zi(n.trigger,"blur",e._onInputBlur)):this.show()}JS.prototype={config:function(t){this._o||(this._o=ym({},Vi,!0));let e=ym(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Ir(e.minDate)||(e.minDate=!1),Ir(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),$T(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Vi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ir(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ir(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",HH(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ir(t))return;let n=this._o.minDate,r=this._o.maxDate;Ir(n)&&t<n?t=n:Ir(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Df(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),HH(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ir(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=AH(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=AH({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Df(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Vi.minDate,this._o.minYear=Vi.minYear,this._o.minMonth=Vi.minMonth,this._o.startRange=Vi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Df(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Vi.maxDate,this._o.maxYear=Vi.maxYear,this._o.maxMonth=Vi.maxMonth,this._o.endRange=Vi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Y6(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&QS(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=Ws().innerWidth||Gr().documentElement.clientWidth,i=Ws().innerHeight||Gr().documentElement.clientHeight,o=Gr().body.scrollTop||Gr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ws().pageXOffset,a=l.bottom+Ws().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Hy(this.el,u?"left-aligned":"right-aligned"),Hy(this.el,c?"bottom-aligned":"top-aligned"),Ay(this.el,u?"right-aligned":"left-aligned"),Ay(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=xH(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Df(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=xH(h,u),m=o+s,w=m;for(;w>7;)w-=7;m+=7-w;let b=!1;for(let E=0,C=0;E<m;E++){let M=new Date(t,e,1+(E-s)),H=Ir(this._d)?kf(M,this._d):!1,L=kf(M,i),P=r.events.indexOf(M.toDateString())!==-1,O=E<s||E>=o+s,z=1+(E-s),K=e,A=t,Q=r.startRange&&kf(r.startRange,M),X=r.endRange&&kf(r.endRange,M),ae=r.startRange&&r.endRange&&r.startRange<M&&M<r.endRange,ee=r.minDate&&M<r.minDate||r.maxDate&&M>r.maxDate||r.disableWeekends&&$6(M)||r.disableDayFn&&r.disableDayFn(M);O&&(E<s?(z=f+z,K=u,A=h):(z=z-o,K=c,A=d));let ce={day:z,month:K,year:A,hasEvent:P,isSelected:H,isToday:L,isDisabled:ee,isEmpty:O,isStartRange:Q,isEndRange:X,isInRange:ae,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&H&&(b=!0),l.push(V6(ce)),++C===7&&(r.showWeekNumber&&l.unshift(B6(this,E-s,e,t,r.firstWeekOfYearMinDays)),a.push(j6(l,r.isRTL,r.pickWholeWeek,b)),l=[],C=0,b=!1)}return G6(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Ay(this.el,"is-hidden"),this._o.bound&&(Zi(Gr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Oo(Gr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Hy(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Oo(this.el,"mousedown",this._onMouseDown,!0),Oo(this.el,"touchend",this._onMouseDown,!0),Oo(this.el,"change",this._onChange),t.keyboardInput&&Oo(Gr(),"keydown",this._onKeyChange),t.field&&(Oo(t.field,"change",this._onInputChange),t.bound&&(Oo(t.trigger,"click",this._onInputClick),Oo(t.trigger,"focus",this._onInputFocus),Oo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function q6(t,e){K6(t,e),e.add(t)}function K6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DH(t,e,n){return(e=X6(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X6(t){var e=Z6(t,"string");return typeof e=="symbol"?e:e+""}function Z6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ny(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RL="date",kH="dateEditor",Q6="DD/MM/YYYY";var Lf=new WeakSet;class EL extends _l{constructor(){super(...arguments),q6(this,Lf),DH(this,"parentDestroyed",!1),DH(this,"$datePicker",null)}static get EDITOR_TYPE(){return RL}init(){if(typeof q!="function")throw new Error("You need to include moment.js to your project.");if(typeof JS!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Y(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{ye(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:kH})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kH),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=Ny(Lf,this,Dy).call(this),r=this.hot.view.isMouseDown(),i=e?AE(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new JS(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(q),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!r&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,q(o,n,!0).isValid()&&this.$datePicker.setMoment(q(o,n),!0),!i&&!r&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&Nd(r,this.cellProperties.datePickerConfig);const i=r.onSelect,o=r.onClose;return r.field=n,r.trigger=n,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=(e=r.format)!==null&&e!==void 0?e:Ny(Lf,this,Dy).call(this),r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=q(a).format(Ny(Lf,this,Dy).call(this))),this.setValue(a),i&&i(),_i()&&this.hideDatepicker()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},r}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:r,columnIndexMapper:i}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Kt(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-jt(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Dy(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Q6}const J6="dropdown";class TL extends LT{static get EDITOR_TYPE(){return J6}prepare(e,n,r,i,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,r,i,o,s)}}const e9="numeric";class _L extends _l{static get EDITOR_TYPE(){return e9}}function t9(t,e,n){return(e=n9(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9(t){var e=r9(t,"string");return typeof e=="symbol"?e:e+""}function r9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const i9="password";class ML extends _l{constructor(){super(...arguments),t9(this,"autoResize",CL(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return i9}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,fo(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...sa(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ky="ht_editor_visible",LH="selectEditor",o9="select";class IL extends lc{static get EDITOR_TYPE(){return o9}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Sl()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),Y(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",ye(this.selectWrapper,ky)&&pe(this.selectWrapper,ky),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),fo(this.select),Oe(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,El(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Wt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Y(this.selectWrapper,ky)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:LH};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(LH)}}const s9="time";class PL extends _l{static get EDITOR_TYPE(){return s9}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function a9(){ur(lc),ur(LT),ur(SL),ur(EL),ur(TL),ur(kT),ur(_L),ur(ML),ur(IL),ur(_l),ur(PL)}const l9="html";function FT(t,e,n,r,i,o,s){jd.apply(this,[t,e,n,r,i,o,s]),El(e,o??"",!1)}FT.RENDERER_TYPE=l9;const u9="autocomplete";function cc(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?FT:us,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Sl()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),Y(e,"htAutocomplete"),!t.acArrowListener){const h=new Jr(t);t.acArrowListener=function(d){ye(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}cc.RENDERER_TYPE=u9;const c9="dropdown";function VT(t,e,n,r,i,o,s){cc.apply(this,[t,e,n,r,i,o,s])}VT.RENDERER_TYPE=c9;const $H=new WeakMap,FH=new WeakMap,h9="htBadValue",Yu="data-row",Gu="data-col",d9="checkboxRenderer",OL="checkbox";ne.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===OL){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function WT(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;jd.apply(this,[t,e,n,r,i,o,s]),f9(t);let u=g9(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),fo(e),o===s.checkedTemplate||wt(o).toLocaleLowerCase(s.locale)===wt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||wt(o).toLocaleLowerCase(s.locale)===wt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Lt(o)?Y(u,"noValue"):(u.style.display="none",Y(u,h9),h=!0),Ce(u,[[Yu,n],[Gu,r]]),l&&Ce(u,[Fu(u.checked?t.getTranslatedPhrase(PT):t.getTranslatedPhrase(OT)),DD(u.checked),uY()]),!h&&c){let w="";if(c.value)w=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const E=t.getDataAtRowProp(n,c.property);w=E!==null?E:""}const b=m9(a,w,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),$H.has(t)||($H.set(t,!0),d());function d(){const b=t.getShortcutManager().getContext("grid"),E={group:d9,relativeToGroup:la,position:"before"};b.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const C=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&C?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var C;return(C=t.getSelectedRangeLast())===null||C===void 0?void 0:C.highlight.isCell()}}],E)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange(),E=[],C=new Map;let M=[],H=0;if(b){for(let L=0;L<b.length;L++){const{row:P,col:O}=b[L].getTopStartCorner(),{row:z,col:K}=b[L].getBottomEndCorner();for(let A=P;A<=z;A+=1)for(let Q=O;Q<=K;Q+=1){const X=t.getCellMeta(A,Q);if(X.hidden)continue;const ae={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){w===!0&&!X.readOnly&&(C.has(E.length)?C.set(E.length,[...C.get(E.length),[A,Q,null]]):C.set(E.length,[[A,Q,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const ee=t.getDataAtCell(A,Q);w===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(ee)?M.push([A,Q,X.uncheckedTemplate,ae]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(ee)&&M.push([A,Q,X.checkedTemplate,ae]):M.push([A,Q,X.uncheckedTemplate,ae]),H+=1}E.push(H),H=0}M.every(L=>{let[,,P]=L;return P===M[0][2]})?M=M.map(L=>{let[P,O,z]=L;return[P,O,z]}):M=M.map(L=>{let[P,O,,z]=L;return[P,O,z.checkedTemplate]}),M.length>0&&E.forEach((L,P)=>{let O=M.splice(0,L);C.size&&C.has(P)&&(O=[...O,...C.get(P)]),t.setDataAtCell(O)})}}function m(){const w=t.getSelectedRange();if(w){for(let b=0;b<w.length;b++){const E=w[b].getTopStartCorner(),C=w[b].getBottomEndCorner();for(let M=E.row;M<=C.row;M++)for(let H=E.col;H<=C.col;H++){if(t.getCellMeta(M,H).readOnly)continue;const P=t.getCell(M,H);if(uo(P)&&P.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}WT.RENDERER_TYPE=OL;function f9(t){let e=FH.get(t);if(!e){const{rootElement:n}=t;e=new Jr(t),e.addEventListener(n,"click",r=>w9(r,t)),e.addEventListener(n,"mouseup",r=>p9(r,t)),e.addEventListener(n,"change",r=>v9(r,t)),FH.set(t,e)}return e}function g9(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function m9(t,e,n){const r=t.createElement("label");r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const i=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(i),r.appendChild(o)}else r.appendChild(i);return r.cloneNode(!0)}function p9(t,e){const{target:n}=t;BT(n)&&(!n.hasAttribute(Yu)||!n.hasAttribute(Gu)||setTimeout(e.listen,10))}function w9(t,e){const{target:n}=t;if(!BT(n)||!n.hasAttribute(Yu)||!n.hasAttribute(Gu))return;const r=parseInt(n.getAttribute(Yu),10),i=parseInt(n.getAttribute(Gu),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function v9(t,e){const{target:n}=t;if(!BT(n)||!n.hasAttribute(Yu)||!n.hasAttribute(Gu))return;const r=parseInt(n.getAttribute(Yu),10),i=parseInt(n.getAttribute(Gu),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function BT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const C9="handsontable";function jT(t,e,n,r,i,o,s){cc.apply(this,[t,e,n,r,i,o,s])}jT.RENDERER_TYPE=C9;var y9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function b9(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Ly,VH;function S9(){return VH||(VH=1,Ly={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),Ly}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var $y,WH;function xL(){if(WH)return $y;WH=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,m){if(!isNaN(+l))return+l;let w="",b=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==l)return-1*n(b,u,c,h,d,f);for(let P=0;P<t.length;P++){let O=t[P];if(w=l.replace(RegExp(`([0-9 ])(${O.key})$`),"$1"),w!==l)return n(w,u,c,h,d,f)*O.factor}if(w=l.replace("%",""),w!==l)return n(w,u,c,h,d,f)/100;let E=parseFloat(l);if(isNaN(E))return;let C=h(E);if(C&&C!=="."&&(w=l.replace(new RegExp(`${e(C)}$`),""),w!==l))return n(w,u,c,h,d,f);let M={};Object.keys(f).forEach(P=>{M[f[P]]=P});let H=Object.keys(M).sort().reverse(),L=H.length;for(let P=0;P<L;P++){let O=H[P],z=M[O];if(w=l.replace(O,""),w!==l){let K;switch(z){case"thousand":K=Math.pow(10,3);break;case"million":K=Math.pow(10,6);break;case"billion":K=Math.pow(10,9);break;case"trillion":K=Math.pow(10,12);break}return n(w,u,c,h,d,f)*K}}}function r(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function i(l,u,c="",h,d,f,m){if(l==="")return;if(l===d)return 0;let w=r(l,u,c);return n(w,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],m=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(m)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=YT();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),m=c.getZeroFormat(),w=c.currentAbbreviations(),b;if(typeof l=="string")o(l,h)?b=s(l):b=i(l,h,d,f,m,w);else if(typeof l=="number")b=l;else return;if(b!==void 0)return b}return $y={unformat:a},$y}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Fy,BH;function UT(){if(BH)return Fy;BH=1;let t=xL();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],r=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(b,E)=>E.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:b=>b.output==="byte"},characteristic:{type:"number",restriction:b=>b>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:r},average:"boolean",lowPrecision:{type:"boolean",restriction:(b,E)=>E.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:b=>b>=0,message:"value must be positive"},{restriction:(b,E)=>!E.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:b=>b>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(b,E)=>E.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:b=>b.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(b,E){let C=d(b),M=m(E);return C&&M}function d(b){return t.unformat(b)!==void 0}function f(b,E,C,M=!1){let H=Object.keys(b).map(L=>{if(!E[L])return console.error(`${C} Invalid key: ${L}`),!1;let P=b[L],O=E[L];if(typeof O=="string"&&(O={type:O}),O.type==="format"){if(!f(P,u,`[Validate ${L}]`,!0))return!1}else if(typeof P!==O.type)return console.error(`${C} ${L} type mismatched: "${O.type}" expected, "${typeof P}" provided`),!1;if(O.restrictions&&O.restrictions.length){let z=O.restrictions.length;for(let K=0;K<z;K++){let{restriction:A,message:Q}=O.restrictions[K];if(!A(P,b))return console.error(`${C} ${L} invalid value: ${Q}`),!1}}return O.restriction&&!O.restriction(P,b)?(console.error(`${C} ${L} invalid value: ${O.message}`),!1):O.validValues&&O.validValues.indexOf(P)===-1?(console.error(`${C} ${L} invalid value: must be among ${JSON.stringify(O.validValues)}, "${P}" provided`),!1):!(O.children&&!f(P,O.children,`[Validate ${L}]`))});return M||H.push(...Object.keys(E).map(L=>{let P=E[L];if(typeof P=="string"&&(P={type:P}),P.mandatory){let O=P.mandatory;if(typeof O=="function"&&(O=O(b)),O&&b[L]===void 0)return console.error(`${C} Missing mandatory key "${L}"`),!1}return!0})),H.reduce((L,P)=>L&&P,!0)}function m(b){return f(b,u,"[Validate format]")}function w(b){return f(b,c,"[Validate language]")}return Fy={validate:h,validateFormat:m,validateInput:d,validateLanguage:w},Fy}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function R9(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function E9(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function T9(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function _9(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function M9(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function I9(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function P9(t,e){let r=t.split(".")[0].match(/0+/);r&&(e.characteristic=r[0].length)}function O9(t,e){let n=t.split(".")[1];if(n){let r=n.match(/0+/);r&&(e.mantissa=r[0].length)}}function x9(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function H9(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function A9(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function N9(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function D9(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function k9(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function L9(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function $9(t,e={}){return typeof t!="string"?t:(t=R9(t,e),t=E9(t,e),T9(t,e),I9(t,e),P9(t,e),D9(t,e),H9(t,e),A9(t,e),O9(t,e),N9(t,e),x9(t,e),_9(t,e),M9(t,e),k9(t,e),L9(t,e),e)}var zT={parseFormat:$9};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var Vy,jH;function YT(){if(jH)return Vy;jH=1;const t=S9(),e=UT(),n=zT;let r={},i,o={},s=null,a={};function l(c){i=c}function u(){return o[i]}return r.languages=()=>Object.assign({},o),r.currentLanguage=()=>i,r.currentBytes=()=>u().bytes||{},r.currentCurrency=()=>u().currency,r.currentAbbreviations=()=>u().abbreviations,r.currentDelimiters=()=>u().delimiters,r.currentOrdinal=()=>u().ordinal,r.currentDefaults=()=>Object.assign({},u().defaults,a),r.currentOrdinalDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().ordinalFormat),r.currentByteDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().byteFormat),r.currentPercentageDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().percentageFormat),r.currentCurrencyDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().currencyFormat),r.currentTimeDefaultFormat=()=>Object.assign({},r.currentDefaults(),u().timeFormat),r.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},r.getZeroFormat=()=>s,r.setZeroFormat=c=>s=typeof c=="string"?c:null,r.hasZeroFormat=()=>s!==null,r.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},r.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},r.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(m=>m.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},r.registerLanguage(t),i=t.languageTag,Vy=r,Vy}function F9(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function V9(t,e){t.forEach(n=>{let r;try{r=F9(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}r&&e.registerLanguage(r)})}var W9=t=>({loadLanguagesInNode:e=>V9(e,t)}),HL={exports:{}};(function(t){(function(e){var n,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function m(P){var O,z,K,A=p.prototype={constructor:p,toString:null,valueOf:null},Q=new p(1),X=20,ae=4,ee=-7,ce=21,vt=-1e7,Ne=1e7,$e=!1,Ct=1,rt=0,at={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},pn="0123456789abcdefghijklmnopqrstuvwxyz",g=!0;function p(v,S){var R,T,I,k,W,x,$,V,j=this;if(!(j instanceof p))return new p(v,S);if(S==null){if(v&&v._isBigNumber===!0){j.s=v.s,!v.c||v.e>Ne?j.c=j.e=null:v.e<vt?j.c=[j.e=0]:(j.e=v.e,j.c=v.c.slice());return}if((x=typeof v=="number")&&v*0==0){if(j.s=1/v<0?(v=-v,-1):1,v===~~v){for(k=0,W=v;W>=10;W/=10,k++);k>Ne?j.c=j.e=null:(j.e=k,j.c=[v]);return}V=String(v)}else{if(!r.test(V=String(v)))return K(j,V,x);j.s=V.charCodeAt(0)==45?(V=V.slice(1),-1):1}(k=V.indexOf("."))>-1&&(V=V.replace(".","")),(W=V.search(/e/i))>0?(k<0&&(k=W),k+=+V.slice(W+1),V=V.substring(0,W)):k<0&&(k=V.length)}else{if(C(S,2,pn.length,"Base"),S==10&&g)return j=new p(v),B(j,X+j.e+1,ae);if(V=String(v),x=typeof v=="number"){if(v*0!=0)return K(j,V,x,S);if(j.s=1/v<0?(V=V.slice(1),-1):1,p.DEBUG&&V.replace(/^0\.0*|\./,"").length>15)throw Error(a+v)}else j.s=V.charCodeAt(0)===45?(V=V.slice(1),-1):1;for(R=pn.slice(0,S),k=W=0,$=V.length;W<$;W++)if(R.indexOf(T=V.charAt(W))<0){if(T=="."){if(W>k){k=$;continue}}else if(!I&&(V==V.toUpperCase()&&(V=V.toLowerCase())||V==V.toLowerCase()&&(V=V.toUpperCase()))){I=!0,W=-1,k=0;continue}return K(j,String(v),x,S)}x=!1,V=z(V,S,10,j.s),(k=V.indexOf("."))>-1?V=V.replace(".",""):k=V.length}for(W=0;V.charCodeAt(W)===48;W++);for($=V.length;V.charCodeAt(--$)===48;);if(V=V.slice(W,++$)){if($-=W,x&&p.DEBUG&&$>15&&(v>c||v!==o(v)))throw Error(a+j.s*v);if((k=k-W-1)>Ne)j.c=j.e=null;else if(k<vt)j.c=[j.e=0];else{if(j.e=k,j.c=[],W=(k+1)%u,k<0&&(W+=u),W<$){for(W&&j.c.push(+V.slice(0,W)),$-=u;W<$;)j.c.push(+V.slice(W,W+=u));W=u-(V=V.slice(W)).length}else W-=$;for(;W--;V+="0");j.c.push(+V)}}else j.c=[j.e=0]}p.clone=m,p.ROUND_UP=0,p.ROUND_DOWN=1,p.ROUND_CEIL=2,p.ROUND_FLOOR=3,p.ROUND_HALF_UP=4,p.ROUND_HALF_DOWN=5,p.ROUND_HALF_EVEN=6,p.ROUND_HALF_CEIL=7,p.ROUND_HALF_FLOOR=8,p.EUCLID=9,p.config=p.set=function(v){var S,R;if(v!=null)if(typeof v=="object"){if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(R=v[S],C(R,0,f,S),X=R),v.hasOwnProperty(S="ROUNDING_MODE")&&(R=v[S],C(R,0,8,S),ae=R),v.hasOwnProperty(S="EXPONENTIAL_AT")&&(R=v[S],R&&R.pop?(C(R[0],-f,0,S),C(R[1],0,f,S),ee=R[0],ce=R[1]):(C(R,-f,f,S),ee=-(ce=R<0?-R:R))),v.hasOwnProperty(S="RANGE"))if(R=v[S],R&&R.pop)C(R[0],-f,-1,S),C(R[1],1,f,S),vt=R[0],Ne=R[1];else if(C(R,-f,f,S),R)vt=-(Ne=R<0?-R:R);else throw Error(s+S+" cannot be zero: "+R);if(v.hasOwnProperty(S="CRYPTO"))if(R=v[S],R===!!R)if(R)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))$e=R;else throw $e=!R,Error(s+"crypto unavailable");else $e=R;else throw Error(s+S+" not true or false: "+R);if(v.hasOwnProperty(S="MODULO_MODE")&&(R=v[S],C(R,0,9,S),Ct=R),v.hasOwnProperty(S="POW_PRECISION")&&(R=v[S],C(R,0,f,S),rt=R),v.hasOwnProperty(S="FORMAT"))if(R=v[S],typeof R=="object")at=R;else throw Error(s+S+" not an object: "+R);if(v.hasOwnProperty(S="ALPHABET"))if(R=v[S],typeof R=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(R))g=R.slice(0,10)=="0123456789",pn=R;else throw Error(s+S+" invalid: "+R)}else throw Error(s+"Object expected: "+v);return{DECIMAL_PLACES:X,ROUNDING_MODE:ae,EXPONENTIAL_AT:[ee,ce],RANGE:[vt,Ne],CRYPTO:$e,MODULO_MODE:Ct,POW_PRECISION:rt,FORMAT:at,ALPHABET:pn}},p.isBigNumber=function(v){if(!v||v._isBigNumber!==!0)return!1;if(!p.DEBUG)return!0;var S,R,T=v.c,I=v.e,k=v.s;e:if({}.toString.call(T)=="[object Array]"){if((k===1||k===-1)&&I>=-f&&I<=f&&I===o(I)){if(T[0]===0){if(I===0&&T.length===1)return!0;break e}if(S=(I+1)%u,S<1&&(S+=u),String(T[0]).length==S){for(S=0;S<T.length;S++)if(R=T[S],R<0||R>=l||R!==o(R))break e;if(R!==0)return!0}}}else if(T===null&&I===null&&(k===null||k===1||k===-1))return!0;throw Error(s+"Invalid BigNumber: "+v)},p.maximum=p.max=function(){return N(arguments,-1)},p.minimum=p.min=function(){return N(arguments,1)},p.random=function(){var v=9007199254740992,S=Math.random()*v&2097151?function(){return o(Math.random()*v)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(R){var T,I,k,W,x,$=0,V=[],j=new p(Q);if(R==null?R=X:C(R,0,f),W=i(R/u),$e)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(W*=2));$<W;)x=T[$]*131072+(T[$+1]>>>11),x>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),T[$]=I[0],T[$+1]=I[1]):(V.push(x%1e14),$+=2);$=W/2}else if(crypto.randomBytes){for(T=crypto.randomBytes(W*=7);$<W;)x=(T[$]&31)*281474976710656+T[$+1]*1099511627776+T[$+2]*4294967296+T[$+3]*16777216+(T[$+4]<<16)+(T[$+5]<<8)+T[$+6],x>=9e15?crypto.randomBytes(7).copy(T,$):(V.push(x%1e14),$+=7);$=W/7}else throw $e=!1,Error(s+"crypto unavailable");if(!$e)for(;$<W;)x=S(),x<9e15&&(V[$++]=x%1e14);for(W=V[--$],R%=u,W&&R&&(x=h[u-R],V[$]=o(W/x)*x);V[$]===0;V.pop(),$--);if($<0)V=[k=0];else{for(k=-1;V[0]===0;V.splice(0,1),k-=u);for($=1,x=V[0];x>=10;x/=10,$++);$<u&&(k-=u-$)}return j.e=k,j.c=V,j}}(),p.sum=function(){for(var v=1,S=arguments,R=new p(S[0]);v<S.length;)R=R.plus(S[v++]);return R},z=function(){var v="0123456789";function S(R,T,I,k){for(var W,x=[0],$,V=0,j=R.length;V<j;){for($=x.length;$--;x[$]*=T);for(x[0]+=k.indexOf(R.charAt(V++)),W=0;W<x.length;W++)x[W]>I-1&&(x[W+1]==null&&(x[W+1]=0),x[W+1]+=x[W]/I|0,x[W]%=I)}return x.reverse()}return function(R,T,I,k,W){var x,$,V,j,U,ie,se,Se,Fe=R.indexOf("."),Ve=X,Re=ae;for(Fe>=0&&(j=rt,rt=0,R=R.replace(".",""),Se=new p(T),ie=Se.pow(R.length-Fe),rt=j,Se.c=S(L(b(ie.c),ie.e,"0"),10,I,v),Se.e=Se.c.length),se=S(R,T,I,W?(x=pn,v):(x=v,pn)),V=j=se.length;se[--j]==0;se.pop());if(!se[0])return x.charAt(0);if(Fe<0?--V:(ie.c=se,ie.e=V,ie.s=k,ie=O(ie,Se,Ve,Re,I),se=ie.c,U=ie.r,V=ie.e),$=V+Ve+1,Fe=se[$],j=I/2,U=U||$<0||se[$+1]!=null,U=Re<4?(Fe!=null||U)&&(Re==0||Re==(ie.s<0?3:2)):Fe>j||Fe==j&&(Re==4||U||Re==6&&se[$-1]&1||Re==(ie.s<0?8:7)),$<1||!se[0])R=U?L(x.charAt(1),-Ve,x.charAt(0)):x.charAt(0);else{if(se.length=$,U)for(--I;++se[--$]>I;)se[$]=0,$||(++V,se=[1].concat(se));for(j=se.length;!se[--j];);for(Fe=0,R="";Fe<=j;R+=x.charAt(se[Fe++]));R=L(R,V,x.charAt(0))}return R}}(),O=function(){function v(T,I,k){var W,x,$,V,j=0,U=T.length,ie=I%d,se=I/d|0;for(T=T.slice();U--;)$=T[U]%d,V=T[U]/d|0,W=se*$+V*ie,x=ie*$+W%d*d+j,j=(x/k|0)+(W/d|0)+se*V,T[U]=x%k;return j&&(T=[j].concat(T)),T}function S(T,I,k,W){var x,$;if(k!=W)$=k>W?1:-1;else for(x=$=0;x<k;x++)if(T[x]!=I[x]){$=T[x]>I[x]?1:-1;break}return $}function R(T,I,k,W){for(var x=0;k--;)T[k]-=x,x=T[k]<I[k]?1:0,T[k]=x*W+T[k]-I[k];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,I,k,W,x){var $,V,j,U,ie,se,Se,Fe,Ve,Re,be,Je,Qn,yo,li,un,yt,_t=T.s==I.s?1:-1,gt=T.c,Xe=I.c;if(!gt||!gt[0]||!Xe||!Xe[0])return new p(!T.s||!I.s||(gt?Xe&&gt[0]==Xe[0]:!Xe)?NaN:gt&&gt[0]==0||!Xe?_t*0:_t/0);for(Fe=new p(_t),Ve=Fe.c=[],V=T.e-I.e,_t=k+V+1,x||(x=l,V=w(T.e/u)-w(I.e/u),_t=_t/u|0),j=0;Xe[j]==(gt[j]||0);j++);if(Xe[j]>(gt[j]||0)&&V--,_t<0)Ve.push(1),U=!0;else{for(yo=gt.length,un=Xe.length,j=0,_t+=2,ie=o(x/(Xe[0]+1)),ie>1&&(Xe=v(Xe,ie,x),gt=v(gt,ie,x),un=Xe.length,yo=gt.length),Qn=un,Re=gt.slice(0,un),be=Re.length;be<un;Re[be++]=0);yt=Xe.slice(),yt=[0].concat(yt),li=Xe[0],Xe[1]>=x/2&&li++;do{if(ie=0,$=S(Xe,Re,un,be),$<0){if(Je=Re[0],un!=be&&(Je=Je*x+(Re[1]||0)),ie=o(Je/li),ie>1)for(ie>=x&&(ie=x-1),se=v(Xe,ie,x),Se=se.length,be=Re.length;S(se,Re,Se,be)==1;)ie--,R(se,un<Se?yt:Xe,Se,x),Se=se.length,$=1;else ie==0&&($=ie=1),se=Xe.slice(),Se=se.length;if(Se<be&&(se=[0].concat(se)),R(Re,se,be,x),be=Re.length,$==-1)for(;S(Xe,Re,un,be)<1;)ie++,R(Re,un<be?yt:Xe,be,x),be=Re.length}else $===0&&(ie++,Re=[0]);Ve[j++]=ie,Re[0]?Re[be++]=gt[Qn]||0:(Re=[gt[Qn]],be=1)}while((Qn++<yo||Re[0]!=null)&&_t--);U=Re[0]!=null,Ve[0]||Ve.splice(0,1)}if(x==l){for(j=1,_t=Ve[0];_t>=10;_t/=10,j++);B(Fe,k+(Fe.e=j+V*u-1)+1,W,U)}else Fe.e=V,Fe.r=+U;return Fe}}();function y(v,S,R,T){var I,k,W,x,$;if(R==null?R=ae:C(R,0,8),!v.c)return v.toString();if(I=v.c[0],W=v.e,S==null)$=b(v.c),$=T==1||T==2&&(W<=ee||W>=ce)?H($,W):L($,W,"0");else if(v=B(new p(v),S,R),k=v.e,$=b(v.c),x=$.length,T==1||T==2&&(S<=k||k<=ee)){for(;x<S;$+="0",x++);$=H($,k)}else if(S-=W,$=L($,k,"0"),k+1>x){if(--S>0)for($+=".";S--;$+="0");}else if(S+=k-x,S>0)for(k+1==x&&($+=".");S--;$+="0");return v.s<0&&I?"-"+$:$}function N(v,S){for(var R,T,I=1,k=new p(v[0]);I<v.length;I++)T=new p(v[I]),(!T.s||(R=E(k,T))===S||R===0&&k.s===S)&&(k=T);return k}function F(v,S,R){for(var T=1,I=S.length;!S[--I];S.pop());for(I=S[0];I>=10;I/=10,T++);return(R=T+R*u-1)>Ne?v.c=v.e=null:R<vt?v.c=[v.e=0]:(v.e=R,v.c=S),v}K=function(){var v=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,R=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,W,x,$){var V,j=x?W:W.replace(I,"");if(T.test(j))k.s=isNaN(j)?null:j<0?-1:1;else{if(!x&&(j=j.replace(v,function(U,ie,se){return V=(se=se.toLowerCase())=="x"?16:se=="b"?2:8,!$||$==V?ie:U}),$&&(V=$,j=j.replace(S,"$1").replace(R,"0.$1")),W!=j))return new p(j,V);if(p.DEBUG)throw Error(s+"Not a"+($?" base "+$:"")+" number: "+W);k.s=null}k.c=k.e=null}}();function B(v,S,R,T){var I,k,W,x,$,V,j,U=v.c,ie=h;if(U){e:{for(I=1,x=U[0];x>=10;x/=10,I++);if(k=S-I,k<0)k+=u,W=S,$=U[V=0],j=o($/ie[I-W-1]%10);else if(V=i((k+1)/u),V>=U.length)if(T){for(;U.length<=V;U.push(0));$=j=0,I=1,k%=u,W=k-u+1}else break e;else{for($=x=U[V],I=1;x>=10;x/=10,I++);k%=u,W=k-u+I,j=W<0?0:o($/ie[I-W-1]%10)}if(T=T||S<0||U[V+1]!=null||(W<0?$:$%ie[I-W-1]),T=R<4?(j||T)&&(R==0||R==(v.s<0?3:2)):j>5||j==5&&(R==4||T||R==6&&(k>0?W>0?$/ie[I-W]:0:U[V-1])%10&1||R==(v.s<0?8:7)),S<1||!U[0])return U.length=0,T?(S-=v.e+1,U[0]=ie[(u-S%u)%u],v.e=-S||0):U[0]=v.e=0,v;if(k==0?(U.length=V,x=1,V--):(U.length=V+1,x=ie[u-k],U[V]=W>0?o($/ie[I-W]%ie[W])*x:0),T)for(;;)if(V==0){for(k=1,W=U[0];W>=10;W/=10,k++);for(W=U[0]+=x,x=1;W>=10;W/=10,x++);k!=x&&(v.e++,U[0]==l&&(U[0]=1));break}else{if(U[V]+=x,U[V]!=l)break;U[V--]=0,x=1}for(k=U.length;U[--k]===0;U.pop());}v.e>Ne?v.c=v.e=null:v.e<vt&&(v.c=[v.e=0])}return v}function G(v){var S,R=v.e;return R===null?v.toString():(S=b(v.c),S=R<=ee||R>=ce?H(S,R):L(S,R,"0"),v.s<0?"-"+S:S)}return A.absoluteValue=A.abs=function(){var v=new p(this);return v.s<0&&(v.s=1),v},A.comparedTo=function(v,S){return E(this,new p(v,S))},A.decimalPlaces=A.dp=function(v,S){var R,T,I,k=this;if(v!=null)return C(v,0,f),S==null?S=ae:C(S,0,8),B(new p(k),v+k.e+1,S);if(!(R=k.c))return null;if(T=((I=R.length-1)-w(this.e/u))*u,I=R[I])for(;I%10==0;I/=10,T--);return T<0&&(T=0),T},A.dividedBy=A.div=function(v,S){return O(this,new p(v,S),X,ae)},A.dividedToIntegerBy=A.idiv=function(v,S){return O(this,new p(v,S),0,1)},A.exponentiatedBy=A.pow=function(v,S){var R,T,I,k,W,x,$,V,j,U=this;if(v=new p(v),v.c&&!v.isInteger())throw Error(s+"Exponent not an integer: "+G(v));if(S!=null&&(S=new p(S)),x=v.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!v.c||!v.c[0])return j=new p(Math.pow(+G(U),x?v.s*(2-M(v)):+G(v))),S?j.mod(S):j;if($=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new p(NaN);T=!$&&U.isInteger()&&S.isInteger(),T&&(U=U.mod(S))}else{if(v.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||x&&U.c[1]>=24e7:U.c[0]<8e13||x&&U.c[0]<=9999975e7)))return k=U.s<0&&M(v)?-0:0,U.e>-1&&(k=1/k),new p($?1/k:k);rt&&(k=i(rt/u+2))}for(x?(R=new p(.5),$&&(v.s=1),V=M(v)):(I=Math.abs(+G(v)),V=I%2),j=new p(Q);;){if(V){if(j=j.times(U),!j.c)break;k?j.c.length>k&&(j.c.length=k):T&&(j=j.mod(S))}if(I){if(I=o(I/2),I===0)break;V=I%2}else if(v=v.times(R),B(v,v.e+1,1),v.e>14)V=M(v);else{if(I=+G(v),I===0)break;V=I%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):T&&(U=U.mod(S))}return T?j:($&&(j=Q.div(j)),S?j.mod(S):k?B(j,rt,ae,W):j)},A.integerValue=function(v){var S=new p(this);return v==null?v=ae:C(v,0,8),B(S,S.e+1,v)},A.isEqualTo=A.eq=function(v,S){return E(this,new p(v,S))===0},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(v,S){return E(this,new p(v,S))>0},A.isGreaterThanOrEqualTo=A.gte=function(v,S){return(S=E(this,new p(v,S)))===1||S===0},A.isInteger=function(){return!!this.c&&w(this.e/u)>this.c.length-2},A.isLessThan=A.lt=function(v,S){return E(this,new p(v,S))<0},A.isLessThanOrEqualTo=A.lte=function(v,S){return(S=E(this,new p(v,S)))===-1||S===0},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&this.c[0]==0},A.minus=function(v,S){var R,T,I,k,W=this,x=W.s;if(v=new p(v,S),S=v.s,!x||!S)return new p(NaN);if(x!=S)return v.s=-S,W.plus(v);var $=W.e/u,V=v.e/u,j=W.c,U=v.c;if(!$||!V){if(!j||!U)return j?(v.s=-S,v):new p(U?W:NaN);if(!j[0]||!U[0])return U[0]?(v.s=-S,v):new p(j[0]?W:ae==3?-0:0)}if($=w($),V=w(V),j=j.slice(),x=$-V){for((k=x<0)?(x=-x,I=j):(V=$,I=U),I.reverse(),S=x;S--;I.push(0));I.reverse()}else for(T=(k=(x=j.length)<(S=U.length))?x:S,x=S=0;S<T;S++)if(j[S]!=U[S]){k=j[S]<U[S];break}if(k&&(I=j,j=U,U=I,v.s=-v.s),S=(T=U.length)-(R=j.length),S>0)for(;S--;j[R++]=0);for(S=l-1;T>x;){if(j[--T]<U[T]){for(R=T;R&&!j[--R];j[R]=S);--j[R],j[T]+=l}j[T]-=U[T]}for(;j[0]==0;j.splice(0,1),--V);return j[0]?F(v,j,V):(v.s=ae==3?-1:1,v.c=[v.e=0],v)},A.modulo=A.mod=function(v,S){var R,T,I=this;return v=new p(v,S),!I.c||!v.s||v.c&&!v.c[0]?new p(NaN):!v.c||I.c&&!I.c[0]?new p(I):(Ct==9?(T=v.s,v.s=1,R=O(I,v,0,3),v.s=T,R.s*=T):R=O(I,v,0,Ct),v=I.minus(R.times(v)),!v.c[0]&&Ct==1&&(v.s=I.s),v)},A.multipliedBy=A.times=function(v,S){var R,T,I,k,W,x,$,V,j,U,ie,se,Se,Fe,Ve,Re=this,be=Re.c,Je=(v=new p(v,S)).c;if(!be||!Je||!be[0]||!Je[0])return!Re.s||!v.s||be&&!be[0]&&!Je||Je&&!Je[0]&&!be?v.c=v.e=v.s=null:(v.s*=Re.s,!be||!Je?v.c=v.e=null:(v.c=[0],v.e=0)),v;for(T=w(Re.e/u)+w(v.e/u),v.s*=Re.s,$=be.length,U=Je.length,$<U&&(Se=be,be=Je,Je=Se,I=$,$=U,U=I),I=$+U,Se=[];I--;Se.push(0));for(Fe=l,Ve=d,I=U;--I>=0;){for(R=0,ie=Je[I]%Ve,se=Je[I]/Ve|0,W=$,k=I+W;k>I;)V=be[--W]%Ve,j=be[W]/Ve|0,x=se*V+j*ie,V=ie*V+x%Ve*Ve+Se[k]+R,R=(V/Fe|0)+(x/Ve|0)+se*j,Se[k--]=V%Fe;Se[k]=R}return R?++T:Se.splice(0,1),F(v,Se,T)},A.negated=function(){var v=new p(this);return v.s=-v.s||null,v},A.plus=function(v,S){var R,T=this,I=T.s;if(v=new p(v,S),S=v.s,!I||!S)return new p(NaN);if(I!=S)return v.s=-S,T.minus(v);var k=T.e/u,W=v.e/u,x=T.c,$=v.c;if(!k||!W){if(!x||!$)return new p(I/0);if(!x[0]||!$[0])return $[0]?v:new p(x[0]?T:I*0)}if(k=w(k),W=w(W),x=x.slice(),I=k-W){for(I>0?(W=k,R=$):(I=-I,R=x),R.reverse();I--;R.push(0));R.reverse()}for(I=x.length,S=$.length,I-S<0&&(R=$,$=x,x=R,S=I),I=0;S;)I=(x[--S]=x[S]+$[S]+I)/l|0,x[S]=l===x[S]?0:x[S]%l;return I&&(x=[I].concat(x),++W),F(v,x,W)},A.precision=A.sd=function(v,S){var R,T,I,k=this;if(v!=null&&v!==!!v)return C(v,1,f),S==null?S=ae:C(S,0,8),B(new p(k),v,S);if(!(R=k.c))return null;if(I=R.length-1,T=I*u+1,I=R[I]){for(;I%10==0;I/=10,T--);for(I=R[0];I>=10;I/=10,T++);}return v&&k.e+1>T&&(T=k.e+1),T},A.shiftedBy=function(v){return C(v,-c,c),this.times("1e"+v)},A.squareRoot=A.sqrt=function(){var v,S,R,T,I,k=this,W=k.c,x=k.s,$=k.e,V=X+4,j=new p("0.5");if(x!==1||!W||!W[0])return new p(!x||x<0&&(!W||W[0])?NaN:W?k:1/0);if(x=Math.sqrt(+G(k)),x==0||x==1/0?(S=b(W),(S.length+$)%2==0&&(S+="0"),x=Math.sqrt(+S),$=w(($+1)/2)-($<0||$%2),x==1/0?S="5e"+$:(S=x.toExponential(),S=S.slice(0,S.indexOf("e")+1)+$),R=new p(S)):R=new p(x+""),R.c[0]){for($=R.e,x=$+V,x<3&&(x=0);;)if(I=R,R=j.times(I.plus(O(k,I,V,1))),b(I.c).slice(0,x)===(S=b(R.c)).slice(0,x))if(R.e<$&&--x,S=S.slice(x-3,x+1),S=="9999"||!T&&S=="4999"){if(!T&&(B(I,I.e+X+2,0),I.times(I).eq(k))){R=I;break}V+=4,x+=4,T=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(B(R,R.e+X+2,1),v=!R.times(R).eq(k));break}}return B(R,R.e+X+1,ae,v)},A.toExponential=function(v,S){return v!=null&&(C(v,0,f),v++),y(this,v,S,1)},A.toFixed=function(v,S){return v!=null&&(C(v,0,f),v=v+this.e+1),y(this,v,S)},A.toFormat=function(v,S,R){var T,I=this;if(R==null)v!=null&&S&&typeof S=="object"?(R=S,S=null):v&&typeof v=="object"?(R=v,v=S=null):R=at;else if(typeof R!="object")throw Error(s+"Argument not an object: "+R);if(T=I.toFixed(v,S),I.c){var k,W=T.split("."),x=+R.groupSize,$=+R.secondaryGroupSize,V=R.groupSeparator||"",j=W[0],U=W[1],ie=I.s<0,se=ie?j.slice(1):j,Se=se.length;if($&&(k=x,x=$,$=k,Se-=k),x>0&&Se>0){for(k=Se%x||x,j=se.substr(0,k);k<Se;k+=x)j+=V+se.substr(k,x);$>0&&(j+=V+se.slice(k)),ie&&(j="-"+j)}T=U?j+(R.decimalSeparator||"")+(($=+R.fractionGroupSize)?U.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(R.fractionGroupSeparator||"")):U):j}return(R.prefix||"")+T+(R.suffix||"")},A.toFraction=function(v){var S,R,T,I,k,W,x,$,V,j,U,ie,se=this,Se=se.c;if(v!=null&&(x=new p(v),!x.isInteger()&&(x.c||x.s!==1)||x.lt(Q)))throw Error(s+"Argument "+(x.isInteger()?"out of range: ":"not an integer: ")+G(x));if(!Se)return new p(se);for(S=new p(Q),V=R=new p(Q),T=$=new p(Q),ie=b(Se),k=S.e=ie.length-se.e-1,S.c[0]=h[(W=k%u)<0?u+W:W],v=!v||x.comparedTo(S)>0?k>0?S:V:x,W=Ne,Ne=1/0,x=new p(ie),$.c[0]=0;j=O(x,S,0,1),I=R.plus(j.times(T)),I.comparedTo(v)!=1;)R=T,T=I,V=$.plus(j.times(I=V)),$=I,S=x.minus(j.times(I=S)),x=I;return I=O(v.minus(R),T,0,1),$=$.plus(I.times(V)),R=R.plus(I.times(T)),$.s=V.s=se.s,k=k*2,U=O(V,T,k,ae).minus(se).abs().comparedTo(O($,R,k,ae).minus(se).abs())<1?[V,T]:[$,R],Ne=W,U},A.toNumber=function(){return+G(this)},A.toPrecision=function(v,S){return v!=null&&C(v,1,f),y(this,v,S,2)},A.toString=function(v){var S,R=this,T=R.s,I=R.e;return I===null?T?(S="Infinity",T<0&&(S="-"+S)):S="NaN":(v==null?S=I<=ee||I>=ce?H(b(R.c),I):L(b(R.c),I,"0"):v===10&&g?(R=B(new p(R),X+I+1,ae),S=L(b(R.c),R.e,"0")):(C(v,2,pn.length,"Base"),S=z(L(b(R.c),I,"0"),10,v,T,!0)),T<0&&R.c[0]&&(S="-"+S)),S},A.valueOf=A.toJSON=function(){return G(this)},A._isBigNumber=!0,P!=null&&p.set(P),p}function w(P){var O=P|0;return P>0||P===O?O:O-1}function b(P){for(var O,z,K=1,A=P.length,Q=P[0]+"";K<A;){for(O=P[K++]+"",z=u-O.length;z--;O="0"+O);Q+=O}for(A=Q.length;Q.charCodeAt(--A)===48;);return Q.slice(0,A+1||1)}function E(P,O){var z,K,A=P.c,Q=O.c,X=P.s,ae=O.s,ee=P.e,ce=O.e;if(!X||!ae)return null;if(z=A&&!A[0],K=Q&&!Q[0],z||K)return z?K?0:-ae:X;if(X!=ae)return X;if(z=X<0,K=ee==ce,!A||!Q)return K?0:!A^z?1:-1;if(!K)return ee>ce^z?1:-1;for(ae=(ee=A.length)<(ce=Q.length)?ee:ce,X=0;X<ae;X++)if(A[X]!=Q[X])return A[X]>Q[X]^z?1:-1;return ee==ce?0:ee>ce^z?1:-1}function C(P,O,z,K){if(P<O||P>z||P!==o(P))throw Error(s+(K||"Argument")+(typeof P=="number"?P<O||P>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(P))}function M(P){var O=P.c.length-1;return w(P.e/u)==O&&P.c[O]%2!=0}function H(P,O){return(P.length>1?P.charAt(0)+"."+P.slice(1):P)+(O<0?"e":"e+")+O}function L(P,O,z){var K,A;if(O<0){for(A=z+".";++O;A+=z);P=A+P}else if(K=P.length,++O>K){for(A=z,O-=K;--O;A+=z);P+=A}else O<K&&(P=P.slice(0,O)+"."+P.slice(O));return P}n=m(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(y9)})(HL);var AL=HL.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Ci=YT(),B9=UT(),j9=zT,U9=AL,bn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Ud={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:NL,decimalSuffixes:bm}=Ci.currentBytes(),GT={general:{scale:1024,suffixes:bm},binary:{scale:1024,suffixes:NL},decimal:{scale:1e3,suffixes:bm}};function z9(t,e={},n){if(typeof e=="string"&&(e=j9.parseFormat(e)),!B9.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",o=e.postfix||"",s=Y9(t,e,n);return s=h8(s,i),s=d8(s,o),s}function Y9(t,e,n){switch(e.output){case"currency":return e=vu(e,Ci.currentCurrencyDefaultFormat()),e8(t,e,Ci);case"percent":return e=vu(e,Ci.currentPercentageDefaultFormat()),J9(t,e,Ci,n);case"byte":return e=vu(e,Ci.currentByteDefaultFormat()),X9(t,e,Ci,n);case"time":return e=vu(e,Ci.currentTimeDefaultFormat()),Q9(t);case"ordinal":return e=vu(e,Ci.currentOrdinalDefaultFormat()),Z9(t,e,Ci);case"number":default:return zd({instance:t,providedFormat:e})}}function G9(t){let e=GT.decimal;return Vp(t._value,e.suffixes,e.scale).suffix}function q9(t){let e=GT.binary;return Vp(t._value,e.suffixes,e.scale).suffix}function K9(t){let e=GT.general;return Vp(t._value,e.suffixes,e.scale).suffix}function Vp(t,e,n){let r=e[0],i=Math.abs(t);if(i>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=e[o],t=t/s;break}}r===e[0]&&(t=t/Math.pow(n,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function X9(t,e,n,r){let i=e.base||"binary",o=Object.assign({},Ud,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||bm,marker:"bd"},binary:{scale:1024,suffixes:s||NL,marker:"b"},decimal:{scale:1e3,suffixes:a||bm,marker:"d"}}[i],{value:c,suffix:h}=Vp(t._value,u.suffixes,u.scale);return`${zd({instance:r(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function Z9(t,e,n){let r=n.currentOrdinal(),i=Object.assign({},Ud,e),o=zd({instance:t,providedFormat:e,state:n}),s=r(t._value);return`${o}${i.spaceSeparated?" ":""}${s}`}function Q9(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),r=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}function J9(t,e,n,r){let i=e.prefixSymbol,o=zd({instance:r(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Ud,e);return i?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function e8(t,e,n){const r=n.currentCurrency();let i=Object.assign({},e),o=Object.assign({},Ud,i),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=i.currencyPosition||r.position,c=i.currencySymbol||r.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=zd({instance:t,providedFormat:i,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function t8({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&r[e]&&bn[e]?(a=r[e],t=t/bn[e]):l>=bn.trillion||n&&s(l/bn.trillion)===1?(a=r.trillion,t=t/bn.trillion):l<bn.trillion&&l>=bn.billion||n&&s(l/bn.billion)===1?(a=r.billion,t=t/bn.billion):l<bn.billion&&l>=bn.million||n&&s(l/bn.million)===1?(a=r.million,t=t/bn.million):(l<bn.million&&l>=bn.thousand||n&&s(l/bn.thousand)===1)&&(a=r.thousand,t=t/bn.thousand),a&&(a=(i?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function n8({value:t,characteristicPrecision:e}){let[n,r]=t.toExponential().split("e"),i=+n;if(!e)return{value:i,abbreviation:`e${r}`};let o=1;return o<e&&(i=i*Math.pow(10,e-o),r=+r-(e-o),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}}function $f(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function r8(t,e){let n=t.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+$f(i-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=($f(-i-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=$f(e-l.length)),n=a+l}return+i>0&&e>0&&(n+=`.${$f(e)}`),n}function i8(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?r8(t,e):new U9(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function o8(t,e,n,r,i,o){if(r===-1)return t;let s=i8(e,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let u=l.match(/0+$/);return i&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function s8(t,e,n,r){let i=t,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let l=r-o.length;for(let u=0;u<l;u++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}function a8(t,e){let n=[],r=0;for(let i=t;i>0;i--)r===e&&(n.unshift(i),r=0),r++;return n}function l8(t,e,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),a8(u.length,a).forEach((f,m)=>{u=u.slice(0,f+m)+s+u.slice(f+m)}),h&&(u=`-${u}`)),c?l=u+i+c:l=u,l}function u8(t,e){return t+e}function c8(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function h8(t,e){return e+t}function d8(t,e){return t+e}function zd({instance:t,providedFormat:e,state:n=Ci,decimalSeparator:r,defaults:i=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Ud,i,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,m=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,w=s.trimMantissa,b=s.thousandSeparated,E=s.spaceSeparated,C=s.negative,M=s.forceSign,H=s.exponential,L=s.roundingFunction,P="";if(d){let z=t8({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:E,roundingFunction:L,totalLength:a});o=z.value,P+=z.abbreviation,a&&(f=z.mantissaPrecision)}if(H){let z=n8({value:o,characteristicPrecision:l});o=z.value,P=z.abbreviation+P}let O=o8(o.toString(),o,m,f,w,L);return O=s8(O,o,u,l),O=l8(O,o,b,n,r),(d||H)&&(O=u8(O,P)),(M||o<0)&&(O=c8(O,o,C)),O}function vu(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var f8=t=>({format:(...e)=>z9(...e,t),getByteUnit:(...e)=>K9(...e,t),getBinaryByteUnit:(...e)=>q9(...e,t),getDecimalByteUnit:(...e)=>G9(...e,t),formatOrDefault:vu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ns=AL;function g8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.plus(i).toNumber(),t}function DL(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.minus(i).toNumber(),t}function m8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.times(i).toNumber(),t}function p8(t,e,n){let r=new ns(t._value),i=e;return n.isNumbro(e)&&(i=e._value),i=new ns(i),t._value=r.dividedBy(i).toNumber(),t}function w8(t,e,n){let r=e;return n.isNumbro(e)&&(r=e._value),t._value=r,t}function v8(t,e,n){let r=n(t._value);return DL(r,e,n),Math.abs(r._value)}var C8=t=>({add:(e,n)=>g8(e,n,t),subtract:(e,n)=>DL(e,n,t),multiply:(e,n)=>m8(e,n,t),divide:(e,n)=>p8(e,n,t),set:(e,n)=>w8(e,n,t),difference:(e,n)=>v8(e,n,t),BigNumber:ns});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const y8="2.5.0",Co=YT(),b8=UT(),S8=W9(Ut),R8=xL();let ba=f8(Ut),Ga=C8(Ut);const E8=zT;class kL{constructor(e){this._value=e}clone(){return Ut(this._value)}format(e={}){return ba.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=E8.parseFormat(e)),e=ba.formatOrDefault(e,Co.currentCurrencyDefaultFormat()),e.output="currency",ba.format(this,e)}formatTime(e={}){return e.output="time",ba.format(this,e)}binaryByteUnits(){return ba.getBinaryByteUnit(this)}decimalByteUnits(){return ba.getDecimalByteUnit(this)}byteUnits(){return ba.getByteUnit(this)}difference(e){return Ga.difference(this,e)}add(e){return Ga.add(this,e)}subtract(e){return Ga.subtract(this,e)}multiply(e){return Ga.multiply(this,e)}divide(e){return Ga.divide(this,e)}set(e){return Ga.set(this,LL(e))}value(){return this._value}valueOf(){return this._value}}function LL(t){let e=t;return Ut.isNumbro(t)?e=t._value:typeof t=="string"?e=Ut.unformat(t):isNaN(t)&&(e=NaN),e}function Ut(t){return new kL(LL(t))}Ut.version=y8;Ut.isNumbro=function(t){return t instanceof kL};Ut.language=Co.currentLanguage;Ut.registerLanguage=Co.registerLanguage;Ut.setLanguage=Co.setLanguage;Ut.languages=Co.languages;Ut.languageData=Co.languageData;Ut.zeroFormat=Co.setZeroFormat;Ut.defaultFormat=Co.currentDefaults;Ut.setDefaults=Co.setDefaults;Ut.defaultCurrencyFormat=Co.currentCurrencyDefaultFormat;Ut.validate=b8.validate;Ut.loadLanguagesInNode=S8.loadLanguagesInNode;Ut.unformat=R8.unformat;Ut.BigNumber=Ga.BigNumber;var T8=Ut,Sa=b9(T8);const _8="numeric";function $L(t,e){if(Nn(t)){const n=e.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if(typeof r<"u"&&!Sa.languages()[r]){const o=r.replace("-",""),s=Sa.allLanguages?Sa.allLanguages[r]:Sa[o];s&&Sa.registerLanguage(s)}Sa.setLanguage(r),t=Sa(t).format(i||"0")}return t}function qT(t,e,n,r,i,o,s){let a=o;if(Nn(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=$L(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}us(t,e,n,r,i,a,s)}qT.RENDERER_TYPE=_8;const M8="password";function KT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";fe(a-1,()=>{u+=l}),El(e,u)}KT.RENDERER_TYPE=M8;const I8="select";function XT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s])}XT.RENDERER_TYPE=I8;const P8="time";function ZT(t,e,n,r,i,o,s){us.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}ZT.RENDERER_TYPE=P8;function O8(){Er(cc),Er(jd),Er(WT),Er(VT),Er(jT),Er(FT),Er(qT),Er(KT),Er(XT),Er(us),Er(ZT)}const x8="autocomplete";function Wp(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,UH(n,e)):UH(n,e)(this.source):e(!0)}Wp.VALIDATOR_TYPE=x8;function UH(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function FL(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const H8=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:FL},Symbol.toStringTag,{value:"Module"})),A8="date";function QT(t,e){const n=fk(RL,this.instance);let r=t,i=!0;r==null&&(r="");let o=q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=N8(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}QT.VALIDATOR_TYPE=A8;function N8(t,e){const n=q(FL(t)),r=q(t,e),i=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const D8="dropdown";function JT(t,e){Wp.apply(this,[t,e])}JT.VALIDATOR_TYPE=D8;const k8="numeric";function e_(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Nn(t))}e_.VALIDATOR_TYPE=k8;const L8=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],$8="time";function t_(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=q(i,L8,!0).isValid()?q(i):q(i,n);let a=s.isValid(),l=q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),r=!0}else r=!1;e(r)}t_.VALIDATOR_TYPE=$8;function F8(){Za(Wp),Za(JT),Za(QT),Za(e_),Za(t_)}const V8="autocomplete",W8={CELL_TYPE:V8,editor:LT,renderer:cc,validator:Wp},B8="checkbox",j8={CELL_TYPE:B8,editor:SL,renderer:WT},U8="date";function VL(t,e,n,r,i,o,s){cc.apply(this,[t,e,n,r,i,o,s])}VL.RENDERER_TYPE=U8;const z8="date",Y8={CELL_TYPE:z8,editor:EL,renderer:VL,validator:QT},G8="dropdown",q8={CELL_TYPE:G8,editor:TL,renderer:VT,validator:JT,filter:!1,strict:!0},K8="handsontable",X8={CELL_TYPE:K8,editor:kT,renderer:jT},Z8="numeric",Q8={CELL_TYPE:Z8,editor:_L,renderer:qT,validator:e_,dataType:"number"},J8="password",e7={CELL_TYPE:J8,editor:ML,renderer:KT,copyable:!1},t7="select",n7={CELL_TYPE:t7,editor:IL,renderer:XT},r7="time",i7={CELL_TYPE:r7,editor:PL,renderer:ZT,validator:t_};function o7(){Vr(W8),Vr(j8),Vr(Y8),Vr(q8),Vr(X8),Vr(Q8),Vr(e7),Vr(n7),Vr(yL),Vr(i7)}function s7(t,e){WL(t,e),e.add(t)}function a7(t,e,n){WL(t,e),e.set(t,n)}function WL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return(e=l7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l7(t){var e=u7(t,"string");return typeof e=="symbol"?e:e+""}function u7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bl(t,e){return t.get(BL(t,e))}function BL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zH=new Map([["plugin",zG],["cell-type",aL],["editor",dk],["renderer",yk],["validator",bk]]),jL=Symbol("mainSetting"),c7="base",Ff=[];let Ra=null;var Ea=new WeakMap,YH=new WeakSet;class Ue{static get PLUGIN_KEY(){return c7}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){s7(this,YH),Wl(this,"eventManager",new Jr(this)),Wl(this,"pluginName",null),Wl(this,"pluginsInitializedCallbacks",[]),Wl(this,"isPluginsReady",!1),Wl(this,"enabled",!1),Wl(this,"initialized",!1),a7(this,Ea,{}),vo(this,"hot",e,{writable:!1}),Ra=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!zH.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);zH.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Ff.push(o)}}if(Ra||(Ra=$E()),Ra.indexOf(this.pluginName)>=0&&Ra.splice(Ra.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ra.length===0){if(Ff.length>0){const i=[`${Ff.join(`
`)}
`,"You have to import and register them manually."].join("");throw Ff.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return n;const r=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(n)||Pe(n))&&r[jL]===e){var i;return Array.isArray(n)?n:(i=n[e])!==null&&i!==void 0?i:r[e]}if(Pe(n)){var o;return(o=n[e])!==null&&o!==void 0?o:r[e]}return r[e]}addHook(e,n,r){Bl(Ea,this)[e]=Bl(Ea,this)[e]||[];const i=Bl(Ea,this)[e];this.hot.addHook(e,n,r),i.push(n),Bl(Ea,this)[e]=i}removeHooks(e){_(Bl(Ea,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Bl(Ea,this);Oe(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){_(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=BL(YH,this,h7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Oe(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function h7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ta(t,e,n){return(e=d7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d7(t){var e=f7(t,"string");return typeof e=="symbol"?e:e+""}function f7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let n_=class{constructor(e){Ta(this,"hot",null),Ta(this,"container",null),Ta(this,"injected",!1),Ta(this,"rows",[]),Ta(this,"columns",[]),Ta(this,"samples",null),Ta(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Y(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),_(this.rows,n=>{const{height:r}=n.table.getBoundingClientRect();e(n.row,Math.ceil(r))})}getWidths(e){this.injected||this.injectTable(),_(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{_(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{_(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{_(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),_(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{_(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.getColWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Y(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Y(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Vf(t,e,n){return(e=g7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g7(t){var e=m7(t,"string");return typeof e=="symbol"?e:e+""}function m7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bp{static get SAMPLE_COUNT(){return 3}constructor(e){Vf(this,"samples",null),Vf(this,"dataFactory",null),Vf(this,"customSampleCount",null),Vf(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Bp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return fe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return fe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Pe(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${wt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}function p7(t,e){UL(t,e),e.add(t)}function Wy(t,e,n){UL(t,e),e.set(t,n)}function UL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wc(t,e,n){return(e=w7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w7(t){var e=v7(t,"string");return typeof e=="symbol"?e:e+""}function v7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bs(t,e){return t.get(dr(t,e))}function Sm(t,e,n){return t.set(dr(t,e),n),n}function dr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutoColumnSizeSeed");const By="autoColumnSize",C7=10,y7="autoColumnSize";var r_=new WeakMap,Cu=new WeakMap,qu=new WeakMap,_r=new WeakSet;class Dh extends Ue{static get PLUGIN_KEY(){return By}static get PLUGIN_PRIORITY(){return C7}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),p7(this,_r),Wc(this,"ghostTable",new n_(this.hot)),Wc(this,"samplesGenerator",new Bp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Wc(this,"inProgress",!1),Wc(this,"measuredColumns",0),Wc(this,"columnWidthsMap",new aa),Wy(this,r_,!1),Wy(this,Cu,[]),Wy(this,qu,[]),this.hot.columnIndexMapper.registerMap(y7,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>dr(_r,this,GH).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[By]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dr(_r,e,R7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dr(_r,e,E7).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dr(_r,e,_7).call(e,...i)}),this.addHook("beforeRender",()=>dr(_r,this,S7).call(this)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("init",()=>dr(_r,this,T7).call(this)),super.enablePlugin()}updatePlugin(){Sm(qu,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>dr(_r,this,GH).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;fe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&dr(_r,this,zL).call(this,s,o)}),this.ghostTable.columns.length&&(dr(_r,this,YL).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){nd(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:r,to:Math.min(r+Dh.CALCULATION_STEP,i)},e,n),r=r+Dh.CALCULATION_STEP+1,r<i?o=td(s):(nd(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),r=a+1),r<i?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[By];let n=Dh.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Pe(e)&&(n=e.syncLimit,fE(n)?n=kE(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,ju))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((r,i,o)=>{const s=Bs(Cu,this).length;return(s-1<o||Bs(Cu,this)[o]!==i)&&r.push(this.hot.toVisualColumn(o)),s-1<o?Bs(Cu,this).push(i):Bs(Cu,this)[o]=i,r},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function b7(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const r=this.hot.toPhysicalColumn(n);r!==null&&(this.hot._getColWidthFromSettings(r)||dr(_r,this,zL).call(this,n,e))}),this.ghostTable.columns.length&&(dr(_r,this,YL).call(this),this.ghostTable.clean())}function zL(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((r,i)=>this.ghostTable.addColumn(i,r))}function YL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function S7(){this.calculateVisibleColumnsWidth(),this.inProgress||(dr(_r,this,b7).call(this,Bs(qu,this)),Sm(qu,this,[]))}function R7(t,e){e||this.recalculateAllColumnsWidth()}function E7(t){const e=t.reduce((n,r)=>{let[,i]=r;const o=this.hot.propToCol(i);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Bs(qu,this).push(...e)}function GH(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function T7(){Sm(Cu,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Sm(r_,this,!0)}function _7(t){if(!Bs(r_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Bs(qu,this).push(...e)}const tl={horizontal:"horizontal",vertical:"vertical"};function M7(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function I7(t){const e={};return t===!0?(e.directions=Object.keys(tl),e.autoInsertRow=!0):Pe(t)?(le(t.autoInsertRow)?t.direction===tl.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(tl)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function P7(t,e){O7(t,e),e.add(t)}function O7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jl(t,e,n){return(e=x7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=H7(t,"string");return typeof e=="symbol"?e:e+""}function H7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("modifyAutofillRange");ne.getSingleton().register("beforeAutofill");ne.getSingleton().register("afterAutofill");const qH="autofill",A7=20,N7=["fillHandle"],D7="insert_row_below",k7=200;var Ul=new WeakSet;class L7 extends Ue{constructor(){super(...arguments),P7(this,Ul),jl(this,"addingStarted",!1),jl(this,"mouseDownOnCellCorner",!1),jl(this,"mouseDragOutside",!1),jl(this,"handleDraggedCells",0),jl(this,"directions",[]),jl(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return qH}static get PLUGIN_PRIORITY(){return A7}static get SETTING_KEYS(){return[qH,...N7]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Bc(Ul,this,F7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Bc(Ul,this,$7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Bc(Ul,this,V7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return _(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),_(a,c=>{const h=[];_(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=M7(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=o.clone(),w=this.hot._createCellRange(h,h,d),b=this.hot.runHooks("beforeAutofill",f,m,w,c);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let E=b;const C=b;if(["up","left"].indexOf(c)>-1&&!(C.length===1&&C[0].length===0))if(E=[],c==="up"){const M=d.row-h.row+1,H=M%C.length;for(let L=0;L<M;L++)E.push(C[(L+(C.length-H))%C.length])}else{const M=d.col-h.col+1,H=M%C[0].length;for(let L=0;L<C.length;L++){E.push([]);for(let P=0;P<M;P++)E[L].push(C[L][(P+(C[L].length-H))%C[L].length])}}this.hot.populateFromArray(h.row,h.col,E,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",E,m,w,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(tl.vertical)&&this.directions.includes(tl.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(tl.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(tl.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(D7,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},k7)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!Lt(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!Lt(s)||!Lt(a))&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Le(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Rn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Kt(this.hot.table),i=Rn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+jt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Bc(Ul,this,W7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Bc(Ul,this,B7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=I7(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function $7(){this.selectAdjacent()&&this.fillIn()}function F7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function V7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function W7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function B7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function j7(t,e){GL(t,e),e.add(t)}function KH(t,e,n){GL(t,e),e.set(t,n)}function GL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zl(t,e,n){return(e=U7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U7(t){var e=z7(t,"string");return typeof e=="symbol"?e:e+""}function z7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qL(t,e,n){return t.set(ro(t,e),n),n}function Rm(t,e){return t.get(ro(t,e))}function ro(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jy="autoRowSize",Y7=40,G7="autoRowSize";var cd=new WeakMap,i_=new WeakMap,Lo=new WeakSet;class kh extends Ue{static get PLUGIN_KEY(){return jy}static get PLUGIN_PRIORITY(){return Y7}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),j7(this,Lo),zl(this,"headerHeight",null),zl(this,"ghostTable",new n_(this.hot)),zl(this,"samplesGenerator",new Bp((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),zl(this,"inProgress",!1),zl(this,"measuredRows",0),zl(this,"rowHeightsMap",new aa),KH(this,cd,[]),KH(this,i_,!1),this.hot.rowIndexMapper.registerMap(G7,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>ro(Lo,this,XH).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[jy];return e===!0||Pe(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ro(Lo,e,X7).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ro(Lo,e,Z7).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ro(Lo,e,J7).call(e,...i)}),this.addHook("beforeRender",()=>ro(Lo,this,K7).call(this)),this.addHook("modifyRowHeight",(r,i)=>this.getRowHeight(i,r)),this.addHook("init",()=>ro(Lo,this,Q7).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>ro(Lo,this,XH).call(this,e,n,r))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const r=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}fe(i.from,i.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(r||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=0;const i=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){nd(o),this.inProgress=!1;return}this.calculateRowsHeight({from:r,to:Math.min(r+kh.CALCULATION_STEP,i)},e,n),r=r+kh.CALCULATION_STEP+1,r<i?o=td(s):(nd(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),r=a+1),r<i?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[jy];let n=kh.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Pe(e)&&(n=e.syncLimit,fE(n)?n=kE(r,n):n>>=0),Math.min(n,r)}getRowHeight(e,n){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{fe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function q7(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((i,o)=>this.ghostTable.addRow(o,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,r)=>{const i=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(i,r)})},!0),this.ghostTable.clean())}function K7(){this.calculateVisibleRowsHeight(),this.inProgress||(ro(Lo,this,q7).call(this,Rm(cd,this)),qL(cd,this,[]))}function XH(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function X7(t,e){e||this.recalculateAllRowsHeight()}function Z7(t){const e=t.reduce((n,r)=>{let[i]=r;return n.indexOf(i)===-1&&n.push(i),n},[]);Rm(cd,this).push(...e)}function Q7(){this.recalculateAllRowsHeight(),qL(i_,this,!0)}function J7(t){if(!Rm(i_,this))return;const e=t.reduce((n,r)=>{var i;const o=(i=r.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Rm(cd,this).push(...e)}const{getListWithInsertedItems:e5,getListWithRemovedItems:t5}=jk("physicallyIndexed");class n5 extends Tl{constructor(){super(e=>e)}insert(e,n){const r=l0(this.indexedValues,n);this.indexedValues=e5(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=t5(this.indexedValues,e);this.indexedValues=a0(n,e),super.remove(e)}}const{getListWithInsertedItems:r5,getListWithRemovedItems:i5}=jk("physicallyIndexed");class o5 extends Tl{constructor(){super(e=>e)}insert(e,n){this.indexedValues=r5(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=i5(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function s5(t,e){a5(t,e),e.add(t)}function a5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l5(t,e,n){return(e=u5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u5(t){var e=c5(t,"string");return typeof e=="symbol"?e:e+""}function c5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ZH="bindRowsWithHeaders",d5=210,f5="loose",QH=new Map([["loose",n5],["strict",o5]]);var JH=new WeakSet;class g5 extends Ue{constructor(){super(...arguments),s5(this,JH),l5(this,"headerIndexes",null)}static get PLUGIN_KEY(){return ZH}static get PLUGIN_PRIORITY(){return d5}isEnabled(){return!!this.hot.getSettings()[ZH]}enablePlugin(){var e;if(this.enabled)return;const n=(e=QH.get(this.getSetting()))!==null&&e!==void 0?e:QH.get(f5);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>h5(JH,this,m5).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function m5(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function p5(t,e){KL(t,e),e.add(t)}function w5(t,e,n){KL(t,e),e.set(t,n)}function KL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eA(t,e,n){return(e=v5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v5(t){var e=C5(t,"string");return typeof e=="symbol"?e:e+""}function C5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tA(t,e){return t.get(_u(t,e))}function Uy(t,e,n){return t.set(_u(t,e),n),n}function _u(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yg="collapsibleColumns",y5=290,b5=["nestedHeaders"],ku="collapsibleIndicator",nA=Yg,rA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Yl=new WeakMap,jc=new WeakSet;class S5 extends Ue{constructor(){super(...arguments),p5(this,jc),eA(this,"nestedHeadersPlugin",null),eA(this,"headerStateManager",null),w5(this,Yl,null)}static get PLUGIN_KEY(){return Yg}static get PLUGIN_PRIORITY(){return y5}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Yg,...b5]}isEnabled(){return!!this.hot.getSettings()[Yg]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ke("You need to configure the Nested Headers plugin in order to use collapsible headers."),Uy(Yl,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_u(jc,this,T5).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _u(jc,e,_5).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _u(jc,e,R5).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>_u(jc,this,E5).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Uy(Yl,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};if(i)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight.isHeader())},group:nA,relativeToGroup:la,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};fe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;fe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${ku}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${ku}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${ku}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!rA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=Zs(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;_(r,f=>{var m;let{row:w,col:b}=f;const{collapsible:E,isCollapsed:C}=(m=this.headerStateManager.getHeaderSettings(w,b))!==null&&m!==void 0?m:{};if(!E||C&&n==="collapse"||!C&&n==="expand")return i=!1,!1});const o=[],s=[];i&&_(r,f=>{let{row:m,col:w}=f;const{colspanCompensation:b,affectedColumns:E,rollbackModification:C}=this.headerStateManager.triggerNodeModification(n,m,w);b>0&&(s.push(...E),o.push(C))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=_D([...a,...s]):n==="expand"&&(l=Zs(a,f=>!s.includes(f)));const u=rA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){_(o,f=>{f()});return}this.hot.batchExecution(()=>{_(s,f=>{tA(Yl,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(n==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&s.includes(m)){const b=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,E=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;b!==null&&E!==null&&this.hot.selectCell(b,E)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return tA(Yl,this).getHiddenIndexes()}destroy(){Uy(Yl,this,null),super.destroy()}}function R5(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${ku}`);if(Rl(e,[Zr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Y(u,ku),e.querySelector("div:first-child").appendChild(u)),pe(u,["collapsed","expanded"]),s?(Y(u,"collapsed"),Js(u,"+"),l&&Ce(e,...Zr(!1))):(Y(u,"expanded"),Js(u,"-"),l&&Ce(e,...Zr(!0))),l&&Ce(u,...Sl());else{var c;(c=u)===null||c===void 0||c.remove()}}function E5(t,e){ye(t.target,ku)&&(ye(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):ye(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),oi(t))}function T5(){this.updatePlugin()}function _5(t,e){e||this.updatePlugin()}function _a(t,e,n){return(e=M5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M5(t){var e=I5(t,"string");return typeof e=="symbol"?e:e+""}function I5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const P5=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],O5=!1,x5=!0,H5=!0;class A5{constructor(e,n){_a(this,"hot",void 0),_a(this,"sortingStates",new Ap),_a(this,"sortEmptyCells",O5),_a(this,"indicator",x5),_a(this,"headerAction",H5),_a(this,"compareFunctionFactory",void 0),_a(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Pe(e)&&Oe(e,(n,r)=>{P5.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Pe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function XL(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?co:Lt(i)?Lt(o)?co:s&&t==="asc"?Dt:kt:Lt(o)?s&&t==="asc"?kt:Dt:isNaN(i)&&!isNaN(o)?t==="asc"?kt:Dt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Dt:kt:i>o?t==="asc"?kt:Dt:co}}const ZL="default";function N5(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return co;if(a){if(Lt(r))return t==="asc"?Dt:kt;if(Lt(i))return t==="asc"?kt:Dt}return isNaN(o)?kt:isNaN(s)?Dt:o<s?t==="asc"?Dt:kt:o>s?t==="asc"?kt:Dt:co}}const D5="numeric";function k5(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Lt(s),u=Lt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return kt;if(l===!1&&u)return Dt}return d===!1&&f?t==="asc"?Dt:kt:d&&f===!1?t==="asc"?kt:Dt:d===!1&&f===!1?XL(t,e,n)(s,a):c===i&&h===r?t==="asc"?Dt:kt:c===r&&h===i?t==="asc"?kt:Dt:co}}const L5="checkbox";function $5(t,e,n){return r$(t,e.dateFormat,n)}const F5="date";function V5(t,e,n){return r$(t,e.timeFormat,n)}const W5="time",{register:Yd,getItem:iA,hasItem:B5}=si("sorting.compareFunctionFactory"),{register:QL,getItem:j5}=si("sorting.mainSortComparator");function JL(t){return B5(t)?iA(t):iA(ZL)}Yd(L5,k5);Yd(F5,$5);Yd(ZL,XL);Yd(D5,N5);Yd(W5,V5);const co=0,Dt=-1,kt=1;function U5(t,e){const n=j5(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}const Em="asc",Tm="desc",e$="colHeader";function z5(t){if(Pe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Em,Tm].includes(n)}function Y5(t){if(t.some(n=>z5(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function oA(t){if(t!==Tm)return t===Em?Tm:Em}function t$(t){return t.querySelector(`.${e$}`)}function n$(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function o_(t,e,n){return t===-1&&e>=0&&ea(n)===!1}function r$(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return co;if(Lt(r))return Lt(i)?co:o&&t==="asc"?Dt:kt;if(Lt(i))return o&&t==="asc"?kt:Dt;const s=q(r,e),a=q(i,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?Dt:kt:a.isBefore(s)?t==="asc"?kt:Dt:co:Dt:kt}}function G5(t,e){Ke(nt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const q5="ascending",K5="descending",i$="indicatorDisabled",o$="columnSorting",s$="sortAction",a$=new Map([[Em,q5],[Tm,K5]]);function X5(t,e,n,r){const i=[o$];if(r&&i.push(s$),n===!1)return i.push(i$),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(a$.get(o)),i}function Z5(){return Array.from(a$.values()).concat(s$,i$,o$)}function Q5(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:JL(u.type))(l,u,d)(c,h)}(0)}}function J5(t,e){eZ(t,e),e.add(t)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wf(t,e,n){return(e=tZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _m="columnSorting",rZ=50,Mm="append",iZ="replace",sA=_m;QL(_m,Q5);ne.getSingleton().register("beforeColumnSort");ne.getSingleton().register("afterColumnSort");const Uc=new WeakMap;var qa=new WeakSet;class l$ extends Ue{constructor(){super(...arguments),J5(this,qa),Wf(this,"columnStatesManager",null),Wf(this,"columnMetaCache",null),Wf(this,"pluginKey",_m),Wf(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return rZ}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Uc.has(this.hot)&&Uc.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),G5(Uc.get(this.hot),this.pluginKey);return}this.enabled||(Uc.set(this.hot,this.pluginKey),this.columnStatesManager=new A5(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new aa(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>yu(qa,this,oZ).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yu(qa,e,aZ).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>yu(qa,this,eR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return yu(qa,e,sZ).call(e,...r)}),this.hot.view&&yu(qa,this,eR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=t$(r);n$(n,r)===!1||i===null||this.updateHeaderClasses(i)};Uc.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.row===-1&&r.col>=0},relativeToGroup:la,position:"before",group:sA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sA)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Uk),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Y5(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Le(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Le(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=oA(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:oA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mm;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Rt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Mm)return[...o.slice(0,r),...o.slice(r+1),s];if(n===iZ)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if(Pe(e)){const n=e[this.pluginKey];if(Pe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):tt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],r=this.hot.countRows(),i=u=>Le(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Le(n,u=>u[0]);U5(n,this.pluginKey,Le(e,u=>u.sortOrder),Le(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Le(n,u=>u[0]),a=new Map(Le(o,(u,c)=>[u,s[c]])),l=Le(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Pe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Pe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(pe(e,Z5()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Y(e,X5(...r))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&ye(e.target,e$)}onAfterOnCellMouseDown(e,n){if(o_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const r=this.hot.getActiveEditor(),i=this.getColumnNextConfig(n.col);r!=null&&r.isOpened()&&this.hot.getCellValidator(r.row,r.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function eR(){const t=this.getAllSavedSortSettings();if(Pe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function oZ(t,e){const n=t$(e);if(n$(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ce(e,...mY(s?`${s}ending`:"none"))}}function sZ(t){t===!0&&this.hot.view&&yu(qa,this,eR).call(this)}function aZ(t,e,n,r){o_(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ma(t,e,n){return(e=lZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lZ(t){var e=uZ(t,"string");return typeof e=="symbol"?e:e+""}function uZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cZ{constructor(e,n){Ma(this,"plugin",void 0),Ma(this,"hot",void 0),Ma(this,"endpoints",[]),Ma(this,"settings",void 0),Ma(this,"settingsType","array"),Ma(this,"currentEndpoint",null),Ma(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),_(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();_(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;_(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?_(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):_(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){_(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];_(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),_(i,o=>{let s=[];_(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,r=>{_(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],_(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],_(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],_(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&_(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),_(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const r=this.hot.getCellMeta(n,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ke("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function zy(t){return t==null||isNaN(t)}function hZ(t,e){dZ(t,e),e.add(t)}function dZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fZ(t,e,n){return(e=gZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gZ(t){var e=mZ(t,"string");return typeof e=="symbol"?e:e+""}function mZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yy="columnSummary",pZ=220;var zc=new WeakSet;class wZ extends Ue{constructor(){super(...arguments),hZ(this,zc),fZ(this,"endpoints",null)}static get PLUGIN_KEY(){return Yy}static get PLUGIN_PRIORITY(){return pZ}isEnabled(){return!!this.hot.getSettings()[Yy]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Yy],this.endpoints=new cZ(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bf(zc,e,vZ).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bf(zc,e,yZ).call(e,...r)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bf(zc,e,CZ).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Bf(zc,e,bZ).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Oe(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=zy(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Oe(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=zy(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=zy(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Oe(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(nt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function vZ(){this.endpoints.initEndpoints()}function CZ(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function yZ(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function bZ(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function SZ(t,e){u$(t,e),e.add(t)}function Gy(t,e,n){u$(t,e),e.set(t,n)}function u$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bu(t,e){return t.get(s_(t,e))}function tR(t,e,n){return t.set(s_(t,e),n),n}function s_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Im=new WeakMap,jf=new WeakMap,Uf=new WeakMap,aA=new WeakSet;class c${constructor(){SZ(this,aA),Gy(this,Im,!0),Gy(this,jf,null),Gy(this,Uf,new ResizeObserver(e=>s_(aA,this,RZ).call(this,e)))}setObservedElement(e){tR(jf,this,e)}unobserve(){bu(Uf,this).unobserve(bu(jf,this))}observe(){tR(Im,this,!0),bu(Uf,this).observe(bu(jf,this))}destroy(){bu(Uf,this).disconnect()}}function RZ(t){if(bu(Im,this)||!Array.isArray(t)||!t.length){tR(Im,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:r,blockSize:i}=n[0];this.runLocalHooks("resize",r,i)})}st(c$,En);function fs(t,e,n){EZ(t,e),e.set(t,n)}function EZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(h$(t,e))}function Wi(t,e,n){return t.set(h$(t,e),n),n}function h$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gl=new WeakMap,qy=new WeakMap,Ky=new WeakMap,xo=new WeakMap,gs=new WeakMap,ms=new WeakMap,zf=new WeakMap,ql=new WeakMap;class nl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,r){var i=this;fs(this,Gl,void 0),fs(this,qy,void 0),fs(this,Ky,!1),fs(this,xo,null),fs(this,gs,void 0),fs(this,ms,void 0),fs(this,zf,!0),fs(this,ql,new c$),Wi(Gl,this,e),Wi(qy,this,r),Wi(Ky,this,n),Wi(gs,this,this.createEditor()),Wi(ms,this,lt(gs,this).style),lt(ql,this).setObservedElement(this.getInputElement()),lt(ql,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){lt(ms,this).left=`${e}px`,lt(ms,this).top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:jt(this.getInputElement()),height:Kt(this.getInputElement())}}observeSize(){lt(ql,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){lt(ms,this).display="block",Wi(zf,this,!1)}hide(){lt(ql,this).unobserve(),lt(zf,this)||(lt(ms,this).display="none"),Wi(zf,this,!0)}isVisible(){return lt(ms,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return lt(Gl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=lt(Gl,this).createElement("div"),n=lt(Gl,this).createElement("textarea");return e.style.display="none",Wi(xo,this,lt(Gl,this).createElement("div")),lt(xo,this).setAttribute("dir",lt(Ky,this)?"rtl":"ltr"),Y(lt(xo,this),nl.CLASS_EDITOR_CONTAINER),lt(qy,this).appendChild(lt(xo,this)),Y(e,nl.CLASS_EDITOR),Y(n,nl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),lt(xo,this).appendChild(e),e}getInputElement(){return lt(gs,this).querySelector(`.${nl.CLASS_INPUT}`)}getEditorElement(){return lt(gs,this)}destroy(){const e=lt(xo,this)?lt(xo,this).parentNode:null;lt(gs,this).parentNode.removeChild(lt(gs,this)),Wi(gs,this,null),Wi(ms,this,null),lt(ql,this).destroy(),e&&e.removeChild(lt(xo,this))}}st(nl,En);function Xy(t,e,n){return(e=TZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TZ(t){var e=_Z(t,"string");return typeof e=="symbol"?e:e+""}function _Z(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MZ=250,IZ=250;class d${constructor(e){Xy(this,"wasLastActionShow",!0),Xy(this,"showDebounced",null),Xy(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},IZ)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MZ;this.showDebounced=Ld(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}st(d$,En);function PZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function OZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ia(t,e){const n={};return _(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ps(t,e,n,r,i){_(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&xZ(s,a,e,n,r,i)})})}function xZ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=PZ(s.className,r):a=OZ(s.className,r)),o(t,e,"className",a)}function f$(t){return`<span class="selected">â</span>${t}`}function Gg(t,e){let n=!1;return Array.isArray(t)&&_(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function jp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ae="---------";function HZ(){return{name:Ae}}const Ur="alignment";function AZ(){return{key:Ur,name(){return this.getTranslatedPhrase(A0)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ur}:left`,name(){return this.getTranslatedPhrase(N0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ur}:center`,name(){return this.getTranslatedPhrase(D0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ur}:right`,name(){return this.getTranslatedPhrase(k0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ur}:justify`,name(){return this.getTranslatedPhrase(L0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ae},{key:`${Ur}:top`,name(){return this.getTranslatedPhrase($0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ur}:middle`,name(){return this.getTranslatedPhrase(F0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ur}:bottom`,name(){return this.getTranslatedPhrase(V0)},callback(){const t=this.getSelectedRange(),e=Ia(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ps(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Up="clear_column";function NZ(){return{key:Up,name(){return this.getTranslatedPhrase(C0)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,r)=>{if(n<0||r<0)return!0;const{readOnly:i}=this.getCellMeta(n,r);return i?!0:(e=!0,!1)}),!e}}}const Gd="col_left";function DZ(){return{key:Gd,name(){return this.getTranslatedPhrase(f0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const qd="col_right";function kZ(){return{key:qd,name(){return this.getTranslatedPhrase(g0)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Kd="make_read_only";function LZ(){return{key:Kd,checkable:!0,ariaChecked(){return Gg(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(pm)},name(){let t=this.getTranslatedPhrase(pm);return Gg(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=f$(t)),t},callback(){const t=this.getSelectedRange(),e=Gg(t,(n,r)=>this.getCellMeta(n,r).readOnly);_(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const zp="redo";function $Z(){return{key:zp,name(){return this.getTranslatedPhrase(v0)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Xd="remove_col";function FZ(){return{key:Xd,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(p0,e)},callback(){this.alter("remove_col",hX(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Yp="remove_row";function VZ(){return{key:Yp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(m0,e)},callback(){this.alter("remove_row",dX(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Gp="row_above";function WZ(){return{key:Gp,name(){return this.getTranslatedPhrase(h0)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const qp="row_below";function BZ(){return{key:qp,name(){return this.getTranslatedPhrase(d0)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const hd="no_items";function jZ(){return{key:hd,name(){return this.getTranslatedPhrase(c0)},disabled:!0,isCommand:!1}}const Kp="undo";function UZ(){return{key:Kp,name(){return this.getTranslatedPhrase(w0)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const zZ=[Gp,qp,Gd,qd,Up,Yp,Xd,Kp,zp,Kd,Ur,Ae,hd],YZ={[Ae]:HZ,[hd]:jZ,[Gp]:WZ,[qp]:BZ,[Gd]:DZ,[qd]:kZ,[Up]:NZ,[Yp]:VZ,[Xd]:FZ,[Kp]:UZ,[zp]:$Z,[Kd]:LZ,[Ur]:AZ};function g$(){const t={};return Oe(YZ,(e,n)=>{t[n]=e()}),t}function GZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(O0):this.getTranslatedPhrase(P0)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function qZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(x0)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function KZ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(H0);return Gg(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,qg))?f$(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,qg);t.updateCommentMeta(n,r,{[qg]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function XZ(t,e){m$(t,e),e.add(t)}function Kl(t,e,n){m$(t,e),e.set(t,n)}function m$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZZ(t,e,n){return(e=QZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QZ(t){var e=JZ(t,"string");return typeof e=="symbol"?e:e+""}function JZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function js(t,e,n){return t.set(Tr(t,e),n),n}function He(t,e){return t.get(Tr(t,e))}function Tr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Pm="comments",eQ=60,Bo="comment",Rh="value",p$="style",qg="readOnly",Yc=Pm,nR=`plugin:${Pm}`;var ct=new WeakMap,eo=new WeakMap,Xp=new WeakMap,Kg=new WeakMap,rR=new WeakMap,Om=new WeakMap,Fr=new WeakSet;class tQ extends Ue{constructor(){super(...arguments),XZ(this,Fr),ZZ(this,"range",{}),Kl(this,ct,null),Kl(this,eo,null),Kl(this,Xp,!1),Kl(this,Kg,!1),Kl(this,rR,null),Kl(this,Om,"")}static get PLUGIN_KEY(){return Pm}static get PLUGIN_PRIORITY(){return eQ}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Pm]}enablePlugin(){var e=this;this.enabled||(He(ct,this)||(js(ct,this,new nl(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),He(ct,this).addLocalHook("resize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tr(Fr,e,uQ).call(e,...r)}),this.hot.addHook("afterSetTheme",(n,r)=>{r||this.hide()})),He(eo,this)||js(eo,this,new d$(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,r,i,o,s,a)=>Tr(Fr,this,sQ).call(this,n,a)),this.addHook("afterScroll",()=>Tr(Fr,this,cQ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Tr(Fr,this,lA).call(this,n)),this.addHook("beforeCompositionStart",n=>Tr(Fr,this,lA).call(this,n)),He(eo,this).addLocalHook("hide",()=>this.hide()),He(eo,this).addLocalHook("show",(n,r)=>this.showAtCell(n,r)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){He(eo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(nR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();js(Kg,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(nR),this.hot._registerTimeout(()=>{js(Kg,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:Yc}),r.addShortcut({keys:[["Escape"]],callback:()=>{He(ct,this).setValue(He(Om,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ct,this).isVisible()&&He(ct,this).isFocused(),group:Yc}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>He(ct,this).isVisible()&&He(ct,this).isFocused(),group:Yc}),r.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{He(ct,this).setValue(He(ct,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:Yc})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Yc)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Tr(Fr,this,iQ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Tr(Fr,this,nQ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Tr(Fr,this,oQ).call(this)),this.eventManager.addEventListener(n,"focus",()=>Tr(Fr,this,lQ).call(this)),this.eventManager.addEventListener(n,"blur",()=>Tr(Fr,this,aQ).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",r=>Tr(Fr,this,rQ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Qs(e.target,"TD","TBODY");return!!(n&&ye(n,"htCommentCell")&&Qs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=He(ct,this).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Rh]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Bo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Rh)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Rh)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return He(eo,this).cancelHiding(),He(ct,this).setValue((e=i[Bo]?i[Bo][Rh]:null)!==null&&e!==void 0?e:""),He(ct,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){He(ct,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!He(ct,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{row:i,col:o}=this.range.from;let s=n.getRenderableFromVisualIndex(i),a=r.getRenderableFromVisualIndex(o);const l=s===null;He(ct,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1))),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,m=d.getCell({row:s,col:a},!0),w=this.getCommentMeta(i,o,p$);w?He(ct,this).setSize(w.width,w.height):He(ct,this).resetSize();const b=c?0:f.getColumnWidth(a),E=l&&!u?Kt(m):0,{left:C,top:M,width:H,height:L}=m.getBoundingClientRect(),{width:P,height:O}=He(ct,this).getSize(),{innerWidth:z,innerHeight:K}=this.hot.rootWindow,A=this.hot.rootDocument.documentElement,Q=mn(this.hot.rootDocument),X=ME(this.hot.rootWindow)?Q:0,ae=IE(this.hot.rootWindow)?Q:0;let ee=C+h.scrollX+b,ce=M+h.scrollY+E;this.hot.isRtl()&&(ee-=P+b),this.hot.isLtr()&&C+H+P>z-X?ee=C+h.scrollX-P-1:this.hot.isRtl()&&ee<-(A.scrollWidth-A.clientWidth)&&(ee=C+h.scrollX+b+1),M+O>K-ae&&(ce-=O-L+1),He(ct,this).setPosition(ee,ce),He(ct,this).setReadOnlyState(this.getCommentMeta(i,o,qg)),He(ct,this).observeSize()}focusEditor(){He(ct,this).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Bo];let o;i?(o=$n(i),Nd(o,r)):o=r,this.hot.setCellMeta(e,n,Bo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Bo])return i[Bo][r]}addToContextMenu(e){e.items.push({name:Ae},GZ(this),qZ(this),KZ(this))}getEditorInputElement(){return He(ct,this).getInputElement()}destroy(){var e,n;(e=He(ct,this))===null||e===void 0||e.destroy(),(n=He(eo,this))===null||n===void 0||n.destroy(),super.destroy()}}function nQ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!He(Xp,this)&&!this.targetIsCommentTextArea(t)){const e=Qs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function rQ(t){t.stopPropagation()}function iQ(t){const{rootDocument:e}=this.hot;if(!(He(Xp,this)||He(ct,this).isFocused()||ye(t.target,"wtBorder")||He(rR,this)===t.target||!He(ct,this)))if(js(rR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));He(eo,this).show(n)}else Gs(t.target,e)&&!this.targetIsCommentTextArea(t)&&He(eo,this).hide()}function oQ(){js(Xp,this,!1)}function sQ(t,e){e[Bo]&&e[Bo][Rh]&&Y(t,e.commentedCellClassName)}function aQ(){js(Om,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function lQ(){js(Om,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(nR)}function uQ(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[p$]:{width:t,height:e}})}function lA(t){He(ct,this).isFocused()&&oi(t)}function cQ(){He(Kg,this)||this.hide()}function Zy(t,e,n){return(e=hQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hQ(t){var e=dQ(t,"string");return typeof e=="symbol"?e:e+""}function dQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w${constructor(e){Zy(this,"hot",void 0),Zy(this,"commands",{}),Zy(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=fQ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||qt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),_(u,c=>c.apply(this.hot,r))}}function fQ(t,e){let n;return _(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Qy(t,e,n){return(e=gQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:e+""}function mQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Qy(this,"hot",void 0),Qy(this,"predefinedItems",g$()),Qy(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Oe(e,(r,i)=>{let o="";r.name===Ae?(n[Ae]=r,o=Ae):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return pQ(e,this.defaultOrderPattern,this.predefinedItems)}}function pQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Pe(i)?Oe(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Pe(o)?Xt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):_(i,(o,s)=>{let a=n[o];!a&&zZ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Pe(o)&&Xt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ps(t,e,n){return(e=wQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wQ(t){var e=vQ(t,"string");return typeof e=="symbol"?e:e+""}function vQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CQ{constructor(e,n){ps(this,"top",void 0),ps(this,"topRelative",void 0),ps(this,"left",void 0),ps(this,"leftRelative",void 0),ps(this,"scrollTop",void 0),ps(this,"scrollLeft",void 0),ps(this,"cellHeight",void 0),ps(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Gc(t,e,n){yQ(t,e),e.set(t,n)}function yQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(t,e){return t.get(C$(t,e))}function Yf(t,e,n){return t.set(C$(t,e),n),n}function C$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bn=new WeakMap,rr=new WeakMap,ir=new WeakMap,Jy=new WeakMap,Xl=new WeakMap;class bQ{constructor(e){Gc(this,Bn,void 0),Gc(this,rr,void 0),Gc(this,ir,void 0),Gc(this,Jy,!1),Gc(this,Xl,{above:0,below:0,left:0,right:0}),Yf(Jy,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _e(Xl,this)[e]=n,this}setElement(e){return Yf(Bn,this,e),this}setParentElement(e){return Yf(rr,this,e),this}updatePosition(e){Yf(ir,this,new CQ(e,_e(Bn,this).ownerDocument.defaultView)),_e(Jy,this)?(_e(ir,this).fitsBelow(_e(Bn,this))?this.setPositionBelowCursor():_e(ir,this).fitsAbove(_e(Bn,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_e(Bn,this).dir==="rtl"?_e(ir,this).fitsOnLeft(_e(Bn,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_e(ir,this).fitsOnRight(_e(Bn,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=_e(Xl,this).above+_e(ir,this).top-_e(Bn,this).offsetHeight;if(_e(rr,this)){const r=_e(rr,this).ownerDocument.defaultView.getComputedStyle(_e(rr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(ir,this).top+_e(ir,this).cellHeight-_e(Bn,this).scrollHeight+i+o}_e(Bn,this).style.top=`${e}px`}setPositionBelowCursor(){let e=_e(Xl,this).below+_e(ir,this).top+1;if(_e(rr,this)){const r=_e(rr,this).ownerDocument.defaultView.getComputedStyle(_e(rr,this).querySelector(".ht_master")),i=Number.parseInt(r.paddingTop,10),o=Number.parseInt(r.borderTop,10);e=_e(ir,this).top-i-o-1}_e(Bn,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=_e(ir,this).left;if(_e(rr,this)){const n=_e(rr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(rr,this).querySelector(".htCore")).borderRightWidth,10);e+=_e(ir,this).cellWidth+r}else e+=_e(Xl,this).right;_e(Bn,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=_e(Xl,this).left+_e(ir,this).left-_e(Bn,this).offsetWidth;if(_e(rr,this)){const n=_e(rr,this).ownerDocument.defaultView,r=Number.parseInt(n.getComputedStyle(_e(rr,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}_e(Bn,this).style.left=`${e}px`}}function y$(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=We(e,-1,w()-1);function a(E,C){const M=w()-1;return E<0&&(E=M),E>M&&(E=0),o.has(E)?-1:(o.add(E),r(E,!1)===!1&&(E=a(C===1?++E:--E,C)),E)}function l(E){E>-1&&E<w()&&r(E,!0)!==!1&&(s=E)}function u(E){E>-1&&E<w()&&(s=E)}function c(){return s}function h(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function m(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function b(){o.clear(),s=e,i()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:w,clear:b}}function SQ(t){return Le(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function iR(t){return qt(t,"submenu")}function oR(t){return new RegExp(Ae,"i").test(t.name)}function Xg(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function uA(t){return qt(t,"disableSelection")}function RQ(t){return ye(t,"htSeparator")}function EQ(t){return ye(t,"htSubmenu")}function TQ(t){return ye(t,"htDisabled")}function _Q(t){return ye(t,"htSelectionDisabled")}function MQ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function b$(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function IQ(t,e){let n=t.slice(0);return n.reverse(),n=b$(n,e),n.reverse(),n}function PQ(t){const e=[];return _(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function OQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae,n=t.slice(0);return n=b$(n,e),n=IQ(n,e),n=PQ(n),n}function xQ(t){return t.checkable===!0}function HQ(t){return y$({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||RQ(r)||TQ(r)||_Q(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function AQ(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,i)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(r):o.tabMoves;i.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const r=n.getSelectedLast();if(r){const i=t.openSubMenu(r[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:r=>{const i=n.getSelectedLast();i&&(n.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(r),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const S$="menu",cA=S$;function NQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(AQ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:S$})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${cA}:${u}`:cA}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function DQ(t){return(e,n,r,i,o,s)=>{const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(fo(n),Y(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!Xg(a,t)&&!uA(a)&&!oR(a);Ce(n,[...xQ(a)?[sY(),Fu(c),DD(h)]:[oY(),Fu(u)],...d?[sa(-1)]:[],...Xg(a,t)?[fY()]:[],...iR(a)?[Zr(!1)]:[]])}n.className="",n.appendChild(l),oR(a)?Y(n,"htSeparator"):typeof a.renderer=="function"?(Y(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):El(l,u),Xg(a,t)?Y(n,"htDisabled"):uA(a)?Y(n,"htSelectionDisabled"):iR(a)&&Y(n,"htSubmenu")}}function eb(t,e,n){kQ(t,e),e.set(t,n)}function kQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bi(t,e,n){return(e=LQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LQ(t){var e=$Q(t,"string");return typeof e=="symbol"?e:e+""}function $Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tb(t,e,n){return t.set(R$(t,e),n),n}function ws(t,e){return t.get(R$(t,e))}function R$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hA=215;var Zl=new WeakMap,Gf=new WeakMap,qf=new WeakMap;class hc{get tableBorderWidth(){return ws(qf,this)===void 0&&this.hotMenu&&tb(qf,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ws(qf,this)}constructor(e,n){var r=this;Bi(this,"hot",void 0),Bi(this,"options",void 0),Bi(this,"eventManager",new Jr(this)),Bi(this,"container",void 0),Bi(this,"positioner",void 0),Bi(this,"hotMenu",null),Bi(this,"hotSubMenus",{}),Bi(this,"parentMenu",void 0),Bi(this,"menuItems",null),Bi(this,"origOutsideClickDeselects",null),eb(this,Zl,void 0),eb(this,Gf,void 0),eb(this,qf,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:hA,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new bQ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(i,o)=>{this.options.container!==this.hot.rootPortalElement&&(pe(this.options.container,/ht-theme-.*/g),Y(this.options.container,i)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=ll(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ws(Zl,this)}getKeyboardShortcutsCtrl(){return ws(Gf,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Ld(a=>this.openSubMenu(a),300),n=this.options.minWidth||hA;let r=!1,i=Zs(this.menuItems,a=>(a.key===hd&&(r=!0),MQ(a,this.hot)));if(i.length<1&&!r)i.push(g$()[hd]);else if(i.length===0)return;i=OQ(i,Ae);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:DQ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?ws(Zl,this).setCurrentPage(l.row):ws(Zl,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),hm()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!hm()||!ea(a))&&o&&this.hasSelectedItem()&&(_i()||yE()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),tb(Zl,this,HQ(this.hotMenu)),tb(Gf,this,NQ(this)),ws(Gf,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ws(Zl,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ce(r,[Zr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!EQ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new hc(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ce(n,[Zr(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ce(i,[Zr(!1)])}}closeAllSubMenus(){_(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?SQ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||oR(e)||Xg(e,this.hot)||iR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=ln(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?Kt(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ae?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(tt(r)&&(r=r.call(this.hot),r===null||Rt(r)?r="":r=r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Y(i,`htMenu handsontable ${this.options.className}`),r&&Y(i,r),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ce(this.hotMenu.rootElement,[iY(),sa(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Gs(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Gs(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&ye(e.target,"htCore")&&Gs(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}st(hc,En);function FQ(t,e){VQ(t,e),e.add(t)}function VQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nb(t,e,n){return(e=WQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WQ(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Eh="contextMenu",jQ=70,dA=Eh;ne.getSingleton().register("afterContextMenuDefaultOptions");ne.getSingleton().register("beforeContextMenuShow");ne.getSingleton().register("afterContextMenuShow");ne.getSingleton().register("afterContextMenuHide");ne.getSingleton().register("afterContextMenuExecute");var qc=new WeakSet;class Zp extends Ue{constructor(){super(...arguments),FQ(this,qc),nb(this,"commandExecutor",new w$(this.hot)),nb(this,"itemsFactory",null),nb(this,"menu",null)}static get PLUGIN_KEY(){return Eh}static get PLUGIN_PRIORITY(){return jQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Gp,qp,Ae,Gd,qd,Ae,Yp,Xd,Ae,Kp,zp,Ae,Kd,Ae,Ur]}isEnabled(){return!!this.hot.getSettings()[Eh]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Eh];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new hc(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Kf(qc,this,zQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Kf(qc,this,YQ).call(this)),this.menu.addLocalHook("afterClose",()=>Kf(qc,this,GQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Kf(qc,this,UQ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=jp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:dA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dA)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((n=this.menu)!==null&&n!==void 0&&n.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Oe(r,(o,s)=>{const a=["below","right"].includes(s)?o+1:o-1;this.menu.setOffset(s,i?o:a)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new v$(this.hot,Zp.DEFAULT_ITEMS);const e=this.hot.getSettings()[Eh],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),_(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function UQ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),ye(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(ye(o,"current")&&ye(o,"wtBorder"))))return;const s=jp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function zQ(){this.hot.runHooks("beforeContextMenuShow",this)}function YQ(){this.hot.runHooks("afterContextMenuShow",this)}function GQ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Zp.SEPARATOR={name:Ae};function qQ(t){return{key:"copy",name(){return this.getTranslatedPhrase(y0)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function KQ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(R0,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function XQ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(S0,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function ZQ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?We(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(b0,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function QQ(t){return{key:"cut",name(){return this.getTranslatedPhrase(E0)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class JQ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class eJ{constructor(){this.clipboardData=new JQ}preventDefault(){}composedPath(){return[]}}function tJ(t,e){E$(t,e),e.add(t)}function Ql(t,e,n){E$(t,e),e.set(t,n)}function E$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e){return t.get(Mu(t,e))}function Jl(t,e,n){return t.set(Mu(t,e),n),n}function Mu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var vs=new WeakMap,rb=new WeakMap,Kc=new WeakMap,sR=new WeakMap,aR=new WeakMap,Xc=new WeakMap,Zc=new WeakSet;class nJ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;tJ(this,Zc),Ql(this,vs,void 0),Ql(this,rb,void 0),Ql(this,Kc,void 0),Ql(this,sR,void 0),Ql(this,aR,void 0),Ql(this,Xc,void 0),Jl(rb,this,n),Jl(Kc,this,r),Jl(sR,this,i),Jl(aR,this,o),Jl(Xc,this,s)}setSelectedRange(e){Jl(vs,this,e)}getCellsRange(){if(zn(rb,this).call(this)===0||zn(Kc,this).call(this)===0)return null;const{row:e,col:n}=zn(vs,this).getTopStartCorner(),{row:r,col:i}=zn(vs,this).getBottomEndCorner(),o=Mu(Zc,this,rJ).call(this,e,r),s=Mu(Zc,this,ib).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(zn(Kc,this).call(this)===0||zn(Xc,this).call(this)===0)return null;const{col:e}=zn(vs,this).getTopStartCorner(),{col:n}=zn(vs,this).getBottomEndCorner(),r=Mu(Zc,this,ib).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(zn(Kc,this).call(this)===0||zn(Xc,this).call(this)===0)return null;const{col:e}=zn(vs,this).getTopStartCorner(),{col:n}=zn(vs,this).getBottomEndCorner(),r=Mu(Zc,this,ib).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-zn(Xc,this).call(this),startCol:e,endRow:-1,endCol:r}}}function ib(t,e){return Math.min(e,Math.max(t+zn(aR,this).call(this)-1,t))}function rJ(t,e){return Math.min(e,Math.max(t+zn(sR,this).call(this)-1,t))}function T$(t){const e=[],n=[];return _(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);fe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);fe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function iJ(t,e){_$(t,e),e.add(t)}function Cs(t,e,n){_$(t,e),e.set(t,n)}function _$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qc(t,e,n){return(e=oJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oJ(t){var e=sJ(t,"string");return typeof e=="symbol"?e:e+""}function sJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hr(t,e){return t.get(fr(t,e))}function wi(t,e,n){return t.set(fr(t,e),n),n}function fr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterCopyLimit");ne.getSingleton().register("modifyCopyableRange");ne.getSingleton().register("beforeCut");ne.getSingleton().register("afterCut");ne.getSingleton().register("beforePaste");ne.getSingleton().register("afterPaste");ne.getSingleton().register("beforeCopy");ne.getSingleton().register("afterCopy");const ob="copyPaste",aJ=80,lJ=["fragmentSelection"],fA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var lR=new WeakMap,uR=new WeakMap,cR=new WeakMap,eu=new WeakMap,Xf=new WeakMap,Zf=new WeakMap,tu=new WeakMap,xm=new WeakMap,Mr=new WeakSet;class uJ extends Ue{constructor(){super(...arguments),iJ(this,Mr),Qc(this,"columnsLimit",1/0),Qc(this,"rowsLimit",1/0),Qc(this,"pasteMode","overwrite"),Qc(this,"uiContainer",this.hot.rootDocument.body),Cs(this,lR,!1),Cs(this,uR,!1),Cs(this,cR,!1),Cs(this,eu,"cells-only"),Cs(this,Xf,!1),Cs(this,Zf,!1),Cs(this,tu,new nJ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Cs(this,xm,!1),Qc(this,"copyableRanges",[])}static get PLUGIN_KEY(){return ob}static get SETTING_KEYS(){return[ob,...lJ]}static get PLUGIN_PRIORITY(){return aJ}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[ob]}enablePlugin(){var e,n,r=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),wi(lR,this,this.getSetting("copyColumnHeaders")),wi(uR,this,this.getSetting("copyColumnGroupHeaders")),wi(cR,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>fr(Mr,this,dJ).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return fr(Mr,r,fJ).call(r,...o)}),this.addHook("afterSelectionEnd",()=>fr(Mr,this,gJ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return r.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return r.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return r.onPaste(...arguments)}),Wu()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return fr(Mr,r,mJ).call(r,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return fr(Mr,r,pJ).call(r,...o)}),this.addHook("afterSelection",()=>fr(Mr,this,wJ).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";wi(eu,this,e),wi(Xf,this,!0),fr(Mr,this,gA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){wi(Zf,this,!0),fr(Mr,this,gA).call(this,"cut")}getRangedCopyableData(e){return Ah(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=T$(e);return _(r,o=>{const s=[];_(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new eJ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}hr(tu,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);hr(eu,this)==="column-headers-only"?n.set("headers",hr(tu,this).getMostBottomColumnHeadersRange()):(hr(eu,this)==="with-column-headers"?n.set("headers",hr(tu,this).getMostBottomColumnHeadersRange()):hr(eu,this)==="with-column-group-headers"&&n.set("headers",hr(tu,this).getAllColumnHeadersRange()),n.set("cells",hr(tu,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:m,visualRow:w}=this.hot.getCellMeta(c,a);if(c=w+1,m===!0)continue;d=w,h=a;const b=[],E=o.length%r;for(;b.length<i||h<=u;){const{skipColumnOnPaste:C,visualCol:M}=this.hot.getCellMeta(s,h);if(h=M+1,C===!0)continue;f=M;const H=b.length%i;b.push(e[E][H])}o.push(b)}return wi(xm,this,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!hr(Xf,this)||this.isEditorOpened()||uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Oh(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),wi(Xf,this,!1);const o=this.getRangedData(this.copyableRanges),s=fr(Mr,this,cJ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,s)){const l=Ah(o);if(e&&e.clipboardData){const u=kS(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[fA,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",o,this.copyableRanges,s)}wi(eu,this,"cells-only")}onCut(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!hr(Zf,this)||this.isEditorOpened()||uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Oh(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),wi(Zf,this,!1);const o=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",o,this.copyableRanges)){const a=Ah(o);if(e&&e.clipboardData){const l=kS(o,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[fA,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}}onPaste(e){const n=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),i=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||uo(n)&&(i&&n!==r||!i&&n!==this.hot.rootDocument.body&&!Oh(n,this.hot.rootElement)))return;e.preventDefault();let o;if(e&&typeof e.clipboardData<"u"){const c=vp(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?o=pk(c,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=wX(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[s,a,l,u]=this.populateValues(o);this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function gA(t){if(Wu()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&rk(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function cJ(t){const{rows:e}=T$(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function hJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&OE(r)}}}function M$(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&xE(r)}}}function dJ(t){t.items.push({name:"---------"},qQ(this)),hr(lR,this)&&t.items.push(ZQ(this)),hr(uR,this)&&t.items.push(XQ(this)),hr(cR,this)&&t.items.push(KQ(this)),t.items.push(QQ(this))}function fJ(t,e,n,r,i){hr(xm,this)&&(i.value=!0),wi(xm,this,!1)}function gJ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function mJ(){fr(Mr,this,M$).call(this)}function pJ(){fr(Mr,this,hJ).call(this)}function wJ(){fr(Mr,this,M$).call(this)}function I$(t,e){return`border_row${t}col${e}`}function Th(){return{width:1,color:"#000"}}function Ko(){return{hide:!0}}function vJ(){return{width:1,color:"#000",cornerVisible:!1}}function sb(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Jc(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function ab(t,e){return{id:I$(t,e),border:vJ(),row:t,col:e,top:Ko(),bottom:Ko(),start:Ko(),end:Ko()}}function CJ(t,e){return qt(e,"border")&&e.border&&(t.border=e.border),qt(e,"top")&&le(e.top)&&(e.top?(Pe(e.top)||(e.top=Th()),t.top=e.top):(e.top=Ko(),t.top=e.top)),qt(e,"bottom")&&le(e.bottom)&&(e.bottom?(Pe(e.bottom)||(e.bottom=Th()),t.bottom=e.bottom):(e.bottom=Ko(),t.bottom=e.bottom)),qt(e,"start")&&le(e.start)&&(e.start?(Pe(e.start)||(e.start=Th()),t.start=e.start):(e.start=Ko(),t.start=e.start)),qt(e,"end")&&le(e.end)&&(e.end?(Pe(e.end)||(e.end=Th()),t.end=e.end):(e.end=Ko(),t.end=e.end)),t}function rs(t,e){let n=!1;return _(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!qt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Qp(t){return`<span class="selected">â</span>${t}`}function yJ(t){return t.some(e=>le(e.left)||le(e.right))}function bJ(t){return t.some(e=>le(e.start)||le(e.end))}const SJ=new Map([["left","start"],["right","end"]]);function RJ(t){var e;return(e=SJ.get(t))!==null&&e!==void 0?e:t}function EJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(U0);return rs(this,"bottom")&&(e=Qp(e)),e},callback(e,n){const r=rs(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function TJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(z0);return rs(this,e)&&(n=Qp(n)),n},callback(n,r){const i=rs(this,e);t.prepareBorder(r,e,i)}}}function _J(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Y0)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!rs(this)}}}function MJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(j0);return rs(this,e)&&(n=Qp(n)),n},callback(n,r){const i=rs(this,e);t.prepareBorder(r,e,i)}}}function IJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(B0);return rs(this,"top")&&(e=Qp(e)),e},callback(e,n){const r=rs(this,"top");t.prepareBorder(n,"top",r)}}}function PJ(t,e){OJ(t,e),e.add(t)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xJ(t,e,n){return(e=HJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:e+""}function AJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zg="customBorders",NJ=90;var lb=new WeakSet;class DJ extends Ue{constructor(){super(...arguments),PJ(this,lb),xJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Zg}static get PLUGIN_PRIORITY(){return NJ}isEnabled(){return!!this.hot.getSettings()[Zg]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>mA(lb,this,kJ).call(this,e)),this.addHook("init",()=>mA(lb,this,LJ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=sb(n));const o=Uu(e),s=ld(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});_(e,a=>{s(a).forAll((l,u)=>{_(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,RJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Uu(e),r=ld(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return _(e,o=>{r(o).forAll((s,a)=>{_(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Jc(l))})})}),i}clearBorders(e){e?this.setBorders(e):(_(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=ab(e,n);r&&(a=CJ(a,r),_(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Jc(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);fe(e.from.row,r,o=>{fe(e.from.col,i,s=>{const a=ab(o,s);let l=0;o===e.from.row&&qt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&qt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&qt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&qt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Jc(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=I$(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=ab(e,n):o=sb(o),i?(o[r]=Ko(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Jc(o)))):(o[r]=Th(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Jc(o)))}prepareBorder(e,n,r){_(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":fe(o.col,s.col,a=>{fe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":fe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":fe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":fe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":fe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){_(e,n=>{const r=sb(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return ln([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Le(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){_(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){_(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Le(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):_(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return _(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return _(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):_(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);_(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Zg];if(Array.isArray(e)){const n=$n(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=yJ(e),r=bJ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function kJ(t){this.hot.getSettings()[Zg]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(W0)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[IJ(this),MJ(this),EJ(this),TJ(this),_J(this)]}})}function LJ(){this.changeBorderSettings()}function $J(t,e){FJ(t,e),e.add(t)}function FJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ub(t,e,n){return(e=VJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VJ(t){var e=WJ(t,"string");return typeof e=="symbol"?e:e+""}function WJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wA="dragToScroll",BJ=100;var cb=new WeakSet;class jJ extends Ue{constructor(){super(...arguments),$J(this,cb),ub(this,"boundaries",null),ub(this,"callback",null),ub(this,"listening",!1)}static get PLUGIN_KEY(){return wA}static get PLUGIN_PRIORITY(){return BJ}isEnabled(){return!!this.hot.getSettings()[wA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>pA(cb,this,vA).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>pA(cb,this,vA).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=ll(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function vA(t){if(ea(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function UJ(t,e){P$(t,e),e.add(t)}function zJ(t,e,n){P$(t,e),e.set(t,n)}function P$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hb(t,e,n){return(e=YJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=GJ(t,"string");return typeof e=="symbol"?e:e+""}function GJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qJ(t,e){return t.get(zr(t,e))}function O$(t,e,n){return t.set(zr(t,e),n),n}function zr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("afterDropdownMenuDefaultOptions");ne.getSingleton().register("beforeDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuShow");ne.getSingleton().register("afterDropdownMenuHide");ne.getSingleton().register("afterDropdownMenuExecute");const Qg="dropdownMenu",KJ=230,dd="changeType",db=Qg;var Jp=new WeakMap,yi=new WeakSet;class ew extends Ue{static get PLUGIN_KEY(){return Qg}static get PLUGIN_PRIORITY(){return KJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Gd,qd,Ae,Xd,Ae,Up,Ae,Kd,Ae,Ur]}constructor(e){super(e),UJ(this,yi),hb(this,"commandExecutor",new w$(this.hot)),hb(this,"itemsFactory",null),hb(this,"menu",null),zJ(this,Jp,!1),this.hot.addHook("afterGetColHeader",(n,r)=>zr(yi,this,ZJ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Qg]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new v$(this.hot,ew.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zr(yi,e,ree).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return zr(yi,e,nee).call(e,...o)});const n=this.hot.getSettings()[Qg],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new hc(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>zr(yi,this,QJ).call(this)),this.menu.addLocalHook("afterOpen",()=>zr(yi,this,JJ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>zr(yi,this,eee).call(this,o)),this.menu.addLocalHook("afterClose",()=>zr(yi,this,tee).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),_(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=jp(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0).querySelector(`.${dd}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:db},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:db}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(db)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>zr(yi,this,XJ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Oe(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function x$(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function XJ(t){if(ye(t.target,dd)){const e=jp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),O$(Jp,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function ZJ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${dd}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=dd,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ce(s,[Sl(),Fu(" ")]),Ce(e,[HD("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function QJ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function JJ(){this.hot.runHooks("afterDropdownMenuShow",this),zr(yi,this,x$).call(this,this.menu)}function eee(t){zr(yi,this,x$).call(this,t)}function tee(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function nee(t){return qJ(Jp,this)?null:t}function ree(t){ye(t.target,dd)&&O$(Jp,this,!0)}ew.SEPARATOR={name:Ae};function CA(t,e,n){return(e=iee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iee(t){var e=oee(t,"string");return typeof e=="symbol"?e:e+""}function oee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class see{constructor(e){CA(this,"hot",void 0),CA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return fe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(fe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();fe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();fe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function yA(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a_{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){yA(this,"dataProvider",void 0),yA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=xi(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Xt(xi(a_.DEFAULT_OPTIONS),n),n=Xt(n,e),n.filename=gE(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}function uee(t,e){cee(t,e),e.add(t)}function cee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const H$="\r",hee='"',dee=`
`,fee="=",gee="+",mee="-",pee="@",wee="	";var fb=new WeakSet;class vee extends a_{constructor(){super(...arguments),uee(this,fb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return i&&(r=Le(r,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),_(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=wt(e);return i===""||(r&&(n=!0),r instanceof RegExp?i=bA(fb,this,yee).call(this,i,r):typeof r=="function"?i=r(i):r&&(i=bA(fb,this,Cee).call(this,i)),(n||i.indexOf(H$)>=0||i.indexOf(hee)>=0||i.indexOf(dee)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function Cee(t){return t.startsWith(fee)||t.startsWith(gee)||t.startsWith(mee)||t.startsWith(pee)||t.startsWith(wee)||t.startsWith(H$)?`'${t}`:t}function yee(t,e){return e.test(t)?`'${t}`:t}const bee="csv",hR={[bee]:vee};function See(t,e,n){return typeof hR[t]=="function"?new hR[t](e,n):null}const Ree="exportFile",Eee=240;class Tee extends Ue{static get PLUGIN_KEY(){return Ree}static get PLUGIN_PRIORITY(){return Eee}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!hR[e])throw new Error(`Export format type "${e}" is not supported.`);return See(e,new see(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function nu(t,e,n){return(e=_ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:e+""}function Mee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zd{constructor(e,n){let{id:r,stateless:i=!0}=n;nu(this,"hot",void 0),nu(this,"id",void 0),nu(this,"elements",[]),nu(this,"hidden",!1),nu(this,"stateId",""),nu(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ap)}getElements(){return this.elements}reset(){_(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}st(Zd,En);const fd={};function ta(t,e){if(!fd[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=fd[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function rl(t){if(!fd[t])throw Error(`Filter condition "${t}" does not exist.`);return fd[t].descriptor}function Jt(t,e,n){n.key=t,fd[t]={condition:e,descriptor:n}}const yn="none";function Iee(){return!0}Jt(yn,Iee,{name:Np,inputsCount:0,showOperators:!1});const Lh="empty";function Pee(t){return Lt(t.value)}Jt(Lh,Pee,{name:J0,inputsCount:0,showOperators:!0});const Jg="not_empty";function Oee(t,e){return!ta(Lh,e)(t)}Jt(Jg,Oee,{name:eT,inputsCount:0,showOperators:!0});const $h="eq";function xee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale)===wt(n)}Jt($h,xee,{name:tT,inputsCount:1,showOperators:!0});const em="neq";function Hee(t,e){return!ta($h,e)(t)}Jt(em,Hee,{name:nT,inputsCount:1,showOperators:!0});const A$="gt";function Aee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Jt(A$,Aee,{name:aT,inputsCount:1,showOperators:!0});const N$="gte";function Nee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Jt(N$,Nee,{name:lT,inputsCount:1,showOperators:!0});const D$="lt";function Dee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Jt(D$,Dee,{name:uT,inputsCount:1,showOperators:!0});const k$="lte";function kee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Jt(k$,kee,{name:cT,inputsCount:1,showOperators:!0});const l_="date_after";function Lee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Jt(l_,Lee,{name:fT,inputsCount:1,showOperators:!0});const u_="date_before";function $ee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Jt(u_,$ee,{name:gT,inputsCount:1,showOperators:!0});const Hm="between";function Fee(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ta(u_,[o]),a=ta(l_,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Jt(Hm,Fee,{name:hT,inputsCount:2,showOperators:!0});const L$="not_between";function Vee(t,e){return!ta(Hm,e)(t)}Jt(L$,Vee,{name:dT,inputsCount:2,showOperators:!0});const $$="begins_with";function Wee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(wt(n))}Jt($$,Wee,{name:rT,inputsCount:1,showOperators:!0});const F$="ends_with";function Bee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(wt(n))}Jt(F$,Bee,{name:iT,inputsCount:1,showOperators:!0});const c_="contains";function jee(t,e){let[n]=e;return wt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(wt(n))>=0}Jt(c_,jee,{name:oT,inputsCount:1,showOperators:!0});const V$="not_contains";function Uee(t,e){return!ta(c_,e)(t)}Jt(V$,Uee,{name:sT,inputsCount:1,showOperators:!0});const W$="date_tomorrow";function zee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(-1,"days").startOf("day"),"d"):!1}Jt(W$,zee,{name:pT,inputsCount:0});const B$="date_today";function Yee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().startOf("day"),"d"):!1}Jt(B$,Yee,{name:mT,inputsCount:0});const j$="date_yesterday";function Gee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(1,"days").startOf("day"),"d"):!1}Jt(j$,Gee,{name:wT,inputsCount:0});FD();function qee(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Qd(t){const e=new Set(t);return function(n){return e.has(n)}}function h_(t){return t??""}function dR(t){return Array.from(new Set(t)).map(e=>h_(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function SA(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Qd(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:qee(a,n)};r&&r(u),i.push(u)}),i}const il="by_value";function Kee(t,e){let[n]=e;return n(t.value)}Jt(il,Kee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Qd(e)]},showOperators:!1});const gd={};function Xee(t){if(!gd[t])throw Error(`Operation with id "${t}" does not exist.`);const e=gd[t].func;return function(n,r){return e(n,r)}}function Zee(t){return gd[t].name}function d_(t,e,n){gd[t]={name:e,func:n}}const Ks="conjunction",Qee=yT;function Jee(t,e){return t.every(n=>n.func(e))}d_(Ks,Qee,Jee);const Am="disjunction",ete=Dp;function tte(t,e){return t.some(n=>n.func(e))}d_(Am,ete,tte);const f_="disjunctionWithExtraCondition",nte=Dp;function rte(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}d_(f_,nte,rte);const ite="numeric",U$="text",ote="date",RA={[ite]:[yn,Ae,Lh,Jg,Ae,$h,em,Ae,A$,N$,D$,k$,Hm,L$],[U$]:[yn,Ae,Lh,Jg,Ae,$h,em,Ae,$$,F$,Ae,c_,V$],[ote]:[yn,Ae,Lh,Jg,Ae,$h,em,Ae,u_,l_,Hm,Ae,W$,B$,j$]};function ste(t){const e=[];let n=t;return RA[n]||(n=U$),_(RA[n],r=>{let i;r===Ae?i={name:Ae}:i=xi(rl(r)),e.push(i)}),e}function eh(t,e,n){return(e=ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ate(t){var e=lte(t,"string");return typeof e=="symbol"?e:e+""}function lte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gb="built",mb="building",EA=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ii=class z${static get DEFAULTS(){return xi({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){eh(this,"hot",void 0),eh(this,"eventManager",new Jr(this)),eh(this,"options",void 0),eh(this,"_element",void 0),eh(this,"buildState",void 0),this.hot=e,this.options=Xt(z$.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===mb?this._element:this.buildState===gb?(this.update(),this._element):(this.buildState=mb,this.build(),this.buildState=gb,this._element)}isBuilt(){return this.buildState===gb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=mb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Y(this._element,this.options.className),this.options.children.length)_(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Oe(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),_(EA,r=>e(n,r))}else _(EA,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};st(Ii,En);function ute(t,e){Y$(t,e),e.add(t)}function cte(t,e,n){Y$(t,e),e.set(t,n)}function Y$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qf(t,e){return t.get(g_(t,e))}function hte(t,e,n){return t.set(g_(t,e),n),n}function g_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ru=new WeakMap,TA=new WeakSet;class Xs extends Ii{static get DEFAULTS(){return xi({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Xt(Xs.DEFAULTS,n)),ute(this,TA),cte(this,ru,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>g_(TA,this,dte).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");hte(ru,this,this._element.firstChild),Y(this._element,"htUIInput"),Y(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Qf(ru,this).type=this.options.type,Qf(ru,this).placeholder=this.translateIfPossible(this.options.placeholder),Qf(ru,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Qf(ru,this).focus()}}function dte(t){this.options.value=t.target.value}function fte(t,e){G$(t,e),e.add(t)}function th(t,e,n){G$(t,e),e.set(t,n)}function G$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iu(t,e,n){return t.set(Fh(t,e),n),n}function Ot(t,e){return t.get(Fh(t,e))}function Fh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hn=new WeakMap,Jf=new WeakMap,eg=new WeakMap,pb=new WeakMap,tg=new WeakMap,ng=new WeakSet;class md extends Ii{static get DEFAULTS(){return xi({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Xt(md.DEFAULTS,n)),fte(this,ng),th(this,hn,null),th(this,Jf,[]),th(this,eg,void 0),th(this,pb,void 0),th(this,tg,void 0),this.registerHooks()}getMenu(){return Ot(hn,this)}registerHooks(){this.addLocalHook("click",()=>Fh(ng,this,pte).call(this))}setItems(e){iu(Jf,this,this.translateNames(e)),Ot(hn,this)&&Ot(hn,this).setMenuItems(Ot(Jf,this))}translateNames(e){return _(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),iu(hn,this,new hc(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ot(hn,this).setMenuItems(Ot(Jf,this));const e=new Ii(this.hot,{className:"htUISelectCaption"}),n=new Ii(this.hot,{className:"htUISelectDropdown"});iu(eg,this,e),iu(pb,this,e.element),iu(tg,this,n),this.hot.getSettings().ariaTags&&(Ce(n.element,[Sl()]),Ce(this._element,[xD()])),_([e,n],r=>this._element.appendChild(r.element)),Ot(hn,this).addLocalHook("select",r=>Fh(ng,this,gte).call(this,r)),Ot(hn,this).addLocalHook("afterClose",()=>Fh(ng,this,mte).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ot(hn,this).hot.getTranslatedPhrase(Np),Ot(pb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ot(hn,this)&&(Ot(hn,this).open(),Ot(hn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ot(hn,this).getNavigator().toFirstItem(),Ot(hn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ot(hn,this)&&Ot(hn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ot(hn,this)&&(Ot(hn,this).destroy(),iu(hn,this,null)),Ot(eg,this)&&Ot(eg,this).destroy(),Ot(tg,this)&&Ot(tg,this).destroy(),super.destroy()}}function gte(t){t.name!==Ae&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function mte(){this.runLocalHooks("afterClose")}function pte(){this.openOptions()}function wte(t,e){vte(t,e),e.add(t)}function vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _A(t,e,n){return(e=Cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cte(t){var e=yte(t,"string");return typeof e=="symbol"?e:e+""}function yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wb=new WeakSet;class fR extends Zd{constructor(e,n){super(e,{id:n.id,stateless:!1}),wte(this,wb),_A(this,"name",""),_A(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new md(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Xs(this.hot,{placeholder:_T})),this.elements.push(new Xs(this.hot,{placeholder:MT})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>MA(wb,this,bte).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),_(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>MA(wb,this,Ste).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=xi(e.command);n.name.startsWith($t)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),_(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||rl(yn),n=[];return _(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=rl(e?e.name:yn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||_(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof md)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Xs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Y(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[rl(yn)];if(e!==null){const{visualIndex:r}=e;n=ste(this.hot.getDataType(0,r,this.hot.countRows(),r))}_(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function bte(t){_(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Ste(t){sc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),oi(t))}function IA(t,e,n){Rte(t,e),e.set(t,n)}function Rte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nh(t,e){return t.get(q$(t,e))}function PA(t,e,n){return t.set(q$(t,e),n),n}function q$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ou=new WeakMap,vb=new WeakMap;class Nm extends Ii{static get DEFAULTS(){return xi({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Xt(Nm.DEFAULTS,n)),IA(this,ou,void 0),IA(this,vb,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),PA(vb,this,e),PA(ou,this,this._element.firstChild),nh(ou,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(nh(vb,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?nh(ou,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(nh(ou,this).checked=e)}focus(){this.isBuilt()&&nh(ou,this).focus()}}function Ete(t,e){Tte(t,e),e.add(t)}function Tte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _te(t,e,n){return(e=Mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mte(t){var e=Ite(t,"string");return typeof e=="symbol"?e:e+""}function Ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OA=0;var xA=new WeakSet;class Ote extends Zd{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ete(this,xA),_te(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuOperators"),_(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Ks,Am];_(e,n=>{const r=new Nm(this.hot,{name:"operator",label:{htmlFor:n,textContent:Zee(n)},value:n,checked:n===e[OA],id:n});r.addLocalHook("change",i=>Pte(xA,this,xte).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(nt`Radio button with index ${e} doesn't exist.`);_(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Nm&&n.isChecked());return e?e.getValue():Ks}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&_(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ks,n=arguments.length>1?arguments[1]:void 0,r=e;r===f_&&(r=Am),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(OA)}}function xte(t){this.setState(t.target.value)}function Hte(t,e,n){Ate(t,e),e.set(t,n)}function Ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cb(t,e){return t.get(K$(t,e))}function Nte(t,e,n){return t.set(K$(t,e),n),n}function K$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var rh=new WeakMap;class pd extends Ii{static get DEFAULTS(){return xi({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Xt(pd.DEFAULTS,n)),Hte(this,rh,void 0)}build(){super.build(),Nte(rh,this,this._element.firstChild)}update(){this.isBuilt()&&(Cb(rh,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Cb(rh,this).focus()}activate(){Cb(rh,this).click()}}function Dte(t,e){X$(t,e),e.add(t)}function su(t,e,n){X$(t,e),e.set(t,n)}function X$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Me(t,e){return t.get(Iu(t,e))}function fi(t,e,n){return t.set(Iu(t,e),n),n}function Iu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HA="multipleSelect.itemBox";var bi=new WeakMap,Yt=new WeakMap,yb=new WeakMap,Ho=new WeakMap,ys=new WeakMap,bs=new WeakMap,ih=new WeakSet;class wd extends Ii{static get DEFAULTS(){return xi({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Xt(wd.DEFAULTS,n)),Dte(this,ih),su(this,bi,[]),su(this,Yt,void 0),su(this,yb,void 0),su(this,Ho,void 0),su(this,ys,void 0),su(this,bs,void 0),fi(Ho,this,new Xs(this.hot,{placeholder:TT,className:"htUIMultipleSelectSearch"})),fi(ys,this,new pd(this.hot,{textContent:bT,className:"htUISelectAll"})),fi(bs,this,new pd(this.hot,{textContent:ST,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Me(Yt,this)}registerHooks(){Me(Ho,this).addLocalHook("keydown",e=>Iu(ih,this,Lte).call(this,e)),Me(Ho,this).addLocalHook("input",e=>Iu(ih,this,kte).call(this,e)),Me(ys,this).addLocalHook("click",e=>Iu(ih,this,$te).call(this,e)),Me(bs,this).addLocalHook("click",e=>Iu(ih,this,Fte).call(this,e))}setItems(e){var n;fi(bi,this,e),(n=Me(Yt,this))===null||n===void 0||n.loadData(Me(bi,this))}setLocale(e){fi(yb,this,e)}getLocale(){return Me(yb,this)}getItems(){return[...Me(bi,this)]}getValue(){return Wte(Me(bi,this))}getSearchInputElement(){return Me(Ho,this)}getSelectAllElement(){return Me(ys,this)}getClearAllElement(){return Me(bs,this)}isSelectedAllValues(){return Me(bi,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Ii(this.hot,{className:"htUISelectionControls",children:[Me(ys,this),Me(bs,this)]});this._element.appendChild(Me(Ho,this).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{var s;if(!this._element)return;(s=Me(Yt,this))===null||s===void 0||s.destroy(),Y(o,"htUIMultipleSelectHot"),fi(Yt,this,new this.hot.constructor(o,{data:Me(bi,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Me(Yt,this).listen()},modifyColWidth:u=>{const c=Me(Yt,this).container.scrollWidth-mn(e);return u!==void 0&&u<c?c:u},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Me(Yt,this).init();const l=Me(Yt,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:HA}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{Me(Yt,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:HA})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Me(Yt,this).listen()}reset(){Me(Ho,this).reset(),Me(ys,this).reset(),Me(bs,this).reset()}update(){this.isBuilt()&&(Me(Yt,this).loadData(Vte(Me(bi,this),this.options.value)),super.update())}destroy(){var e;(e=Me(Yt,this))===null||e===void 0||e.destroy(),Me(Ho,this).destroy(),Me(bs,this).destroy(),Me(ys,this).destroy(),fi(Ho,this,null),fi(bs,this,null),fi(ys,this,null),fi(Yt,this,null),fi(bi,this,null),super.destroy()}}function kte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Me(bi,this)]:n=Me(bi,this).filter(r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Me(Yt,this).loadData(n)}function Lte(t){this.runLocalHooks("keydown",t,this),HE(sc,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),oi(t),Me(Yt,this).listen(),Me(Yt,this).selectCell(0,0))}function $te(t){const e=[];t.preventDefault(),Me(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!0,e.push(n0(n,r)[0])}),Me(Yt,this).setSourceDataAtCell(e)}function Fte(t){const e=[];t.preventDefault(),Me(Yt,this).getSourceData().forEach((n,r)=>{n.checked=!1,e.push(n0(n,r)[0])}),Me(Yt,this).setSourceDataAtCell(e)}function Vte(t,e){const n=Qd(e);return t.map(r=>(r.checked=n(r.value),r))}function Wte(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Bte(t,e){jte(t,e),e.add(t)}function jte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ute(t,e,n){return(e=zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:e+""}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oh=new WeakSet;class Gte extends Zd{constructor(e,n){super(e,{id:n.id,stateless:!1}),Bte(this,oh),Ute(this,"name",""),this.name=n.name,this.elements.push(new wd(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>rg(oh,this,qte).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>rg(oh,this,Kte).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===il){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?yn:il},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=Zs(i,h=>h.name===il),u={},c=this.hot.getTranslatedPhrase(wm);if(l){const h=s(r,a),d=Le(h,C=>C.value),f=new Map(h.map(C=>[C.value,this.hot.getCellMeta(C.meta.visualRow,C.meta.visualCol)])),m=dR(d);o&&(l.args[0]=o);const w=[],b=SA(m,l.args[0],c,C=>{C.checked&&w.push(C.value),rg(oh,this,AA).call(this,C,f)}),E=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,E).locale,u.args=[w],u.command=rl(il),u.itemsSnapshot=b}else u.args=[],u.command=rl(yn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof wd)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Y(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Y(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||_(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(wm),n=this._getColumnVisibleValues(),r=n.map(l=>l.value),i=new Map(n.map(l=>[l.value,l.meta])),o=dR(r),s=SA(o,o,e,l=>{rg(oh,this,AA).call(this,l,i)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Le(this.hot.getDataAtCol(e.visualIndex),(n,r)=>({value:h_(n),meta:this.hot.getCellMeta(r,e.visualIndex)}))}}function qte(t){sc(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),oi(t))}function AA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Kte(t,e){switch(e.type){case"numeric":return $L(t,e);default:return t}}var Z$;function Xte(t,e){Zte(t,e),e.add(t)}function Zte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qte(t,e,n){return(e=Jte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=ene(t,"string");return typeof e=="symbol"?e:e+""}function ene(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tne(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var NA=new WeakSet;class vd extends Zd{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Xte(this,NA),Qte(this,"name",""),this.name=n.name,this.elements.push(new Xs(this.hot,{type:"button",value:RT,className:"htUIButton htUIButtonOK",identifier:vd.BUTTON_OK})),this.elements.push(new Xs(this.hot,{type:"button",value:ET,className:"htUIButton htUIButtonCancel",identifier:vd.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){_(this.elements,e=>{e.addLocalHook("click",(n,r)=>tne(NA,this,nne).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Y(n.parentNode,"htFiltersMenuActionBar"),_(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}Z$=vd;function nne(t,e){e.options.identifier===Z$.BUTTON_OK?this.accept():this.cancel()}function bb(t,e,n){return(e=rne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rne(t){var e=ine(t,"string");return typeof e=="symbol"?e:e+""}function ine(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DA="ConditionCollection.filteringStates";class m_{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;bb(this,"hot",void 0),bb(this,"isMapRegistrable",void 0),bb(this,"filteringStates",new Ap),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(DA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ks;return e.length?Xee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ks,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(nt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Rt(gd[r]))throw new Error(nt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ta(a,s)}]},i):u.push({name:a,args:s,func:ta(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(DA),this.filteringStates=null,this.clearLocalHooks()}}st(m_,En);function kA(t,e,n){return(e=one(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function one(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q${constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];kA(this,"conditionCollection",void 0),kA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return _(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return _(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return _(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}function ane(t,e){lne(t,e),e.add(t)}function lne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ig=new WeakSet;class J${constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];ane(this,ig),Pa(this,"hot",void 0),Pa(this,"conditionCollection",void 0),Pa(this,"columnDataFactory",void 0),Pa(this,"changes",[]),Pa(this,"grouping",!1),Pa(this,"latestEditedColumnPosition",-1),Pa(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Sb(ig,this,hne).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Sb(ig,this,dne).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Sb(ig,this,fne).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,_(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=ok(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new m_(r.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const w=r.columnDataFactory(h);let b;f.isEmpty()?b=w:b=new Q$(f,C=>r.columnDataFactory(C)).filter(),b=Le(b,C=>C.meta.visualRow);const E=Qd(b);return f.destroy(),Zs(w,C=>E(C.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Oe(this,(e,n)=>{this[n]=null})}}function hne(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function dne(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function fne(){_(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}st(J$,En);function gne(t){return y$({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof wd)return r;if(i.element&&!ul(i.element))return!1;i.focus()}})}const sh="filters";function mne(t,e){let n=-1,r;const i=gne(e),o=h=>()=>{r.isOpened()&&r.getKeyboardShortcutsCtrl().listen(sh),i.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof Ii&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=r.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();i.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(sh),callback:()=>{h.isSubMenu()&&h.close(),d.listen(sh)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:m=>{const w=r.getNavigator();w.getCurrentPage()>-1&&(n=w.getCurrentPage()),w.clear(),m.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{r.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:m=>{const w=e[i.getCurrentPage()];w instanceof md&&(w.openOptions(),m.preventDefault()),w instanceof pd&&(w.activate(),m.preventDefault()),w instanceof Ii||m.preventDefault()}}],sh)}function a(){r.focus(),r.getKeyboardShortcutsCtrl().listen(sh)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||i.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),r=h}function u(){return r}function c(){return n}return{...i,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function pne(t,e){eF(t,e),e.add(t)}function Rb(t,e,n){eF(t,e),e.set(t,n)}function eF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ah(t,e,n){return(e=wne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wne(t){var e=vne(t,"string");return typeof e=="symbol"?e:e+""}function vne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tm(t,e,n){return t.set(ar(t,e),n),n}function Yr(t,e){return t.get(ar(t,e))}function ar(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gR="filters",Cne=250,LA=gR;var $o=new WeakMap,mR=new WeakMap,Qa=new WeakMap,Cr=new WeakSet;class yne extends Ue{static get PLUGIN_KEY(){return gR}static get PLUGIN_PRIORITY(){return Cne}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,pne(this,Cr),ah(this,"dropdownMenuPlugin",null),ah(this,"conditionCollection",null),ah(this,"conditionUpdateObserver",null),ah(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ah(this,"filtersRowsMap",null),Rb(this,$o,void 0),Rb(this,mR,new WeakSet),Rb(this,Qa,[]),this.hot.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ar(Cr,n,Mne).call(n,...i)})}isEnabled(){return!!this.hot.getSettings()[gR]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Bd),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,r=n&&n.uiContainer||this.hot.rootPortalElement,i=a=>(a.addLocalHook("accept",()=>ar(Cr,this,$A).call(this,"accept")),a.addLocalHook("cancel",()=>ar(Cr,this,$A).call(this,"cancel")),a.addLocalHook("change",l=>ar(Cr,this,_ne).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(vT)}:`,s=()=>`${this.hot.getTranslatedPhrase(CT)}:`;if(!this.components.get("filter_by_condition")){const a=new fR(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:r});a.addLocalHook("afterClose",()=>ar(Cr,this,FA).call(this)),this.components.set("filter_by_condition",i(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new Ote(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new fR(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});a.addLocalHook("afterClose",()=>ar(Cr,this,FA).call(this)),this.components.set("filter_by_condition2",i(a))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new Gte(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new vd(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new m_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new J$(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>ar(Cr,this,Ine).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return ar(Cr,e,Tne).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>ar(Cr,this,Ene).call(this)),this.addHook("afterDropdownMenuShow",()=>ar(Cr,this,Sne).call(this)),this.addHook("afterDropdownMenuHide",()=>ar(Cr,this,Rne).call(this)),this.addHook("afterChange",a=>ar(Cr,this,bne).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Yr($o,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Yr($o,this).getMenu(),c=u.getNavigator(),h=Yr($o,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];tm($o,this,mne(this.dropdownMenuPlugin.menu,a));const l=u=>{Yr($o,this).listen(),u.preventDefault(),sc(u.keyCode,"TAB")&&(u.shiftKey?Yr($o,this).toPreviousItem():Yr($o,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:LA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ks;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,Yr(Qa,this));if(s!==!1&&r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Le(n.filter(),u=>u.meta.visualRow);const l=Qd(i);fe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),_(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),tm(Qa,this,this.exportConditions())}else s!==!1&&!r?(tm(Qa,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Yr(Qa,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return _(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(o,n),w=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:h_(w)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=dR(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Am&&n.command.key!==yn&&r.command.key!==yn&&i.command.key!==yn?o=f_:i.command.key!==yn&&(n.command.key===yn||r.command.key===yn)&&(o=Ks),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Q$(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _(i,s=>{_(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function bne(t){t&&_(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Sne(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Rne(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Ene(){const t=this.dropdownMenuPlugin.menu;Yr(mR,this).has(t)||Yr($o,this).setMenu(t),Yr(mR,this).add(t)}function Tne(t){t.items.push({name:Ae}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function $A(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==yn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==yn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==yn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function _ne(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===fR&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function FA(){this.setListeningDropdownMenu()}function Mne(t,e,n){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?Y(e,"htFiltersActive"):pe(e,"htFiltersActive")}function Ine(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=t;Array.isArray(i)&&tm(Qa,this,Yr(Qa,this).map(a=>(a.column===r&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...i]])}),a)));const o=n.filter(a=>a.name===il),s=n.filter(a=>a.name!==il);if(o.length>=2||s.length>=3)Ke(nt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(a,r),this.components.get("filter_by_value").updateState(t)}}const tF="internal-use-in-handsontable",pR={licenseKey:tF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function nF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Dn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function rF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Pne(t){var e;const n=t[Dn],r=rF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=nF(t);return{...pR,...r,...i}}function One(t){var e;const n=t[Dn],r=rF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=nF(t);return{...r,...i}}function xne(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function tw(){const t="engine_relationship",e=si(Dn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function p_(){const t="shared_engine_usage",e=si(Dn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Hne(t){const e=t.getSettings(),n=e[Dn],r=n?.engine;if(n===!0||Rt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Ane((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Rt(r.hyperformula)){const o=tw(),s=p_().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:tF}),(r.getConfig().leapYear1900!==pR.leapYear1900||yp(r.getConfig().nullDate,pR.nullDate)===!1)&&Ke(nt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Ane(t,e,n){const r=e[Dn],i=Pne(e),o=tw(),s=p_();Nne(t,r.functions),Dne(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),kne(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function VA(t){var e;const n=tw(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function WA(t,e){if(t){const n=tw(),r=n.get(t),i=p_(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Nne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Ke(s.message)}})}function Dne(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Ke(r.message)}}}function kne(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Ke(a.message)}}),t.resumeEvaluation())}function Lne(t,e){return(Rt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const iF="DD/MM/YYYY";function $ne(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Fne(t){return $ne(t)?t.substr(1):t}function Vne(t){return typeof t=="string"&&t.startsWith("=")}function w_(t,e){return typeof t=="string"&&e==="date"}function oF(t,e){return q(t,e,!0).isValid()}function sF(t,e){return q(t,e,!0).format(iF)}function Wne(t,e){return q(t,iF,!0).format(e)}function aF(t,e){const r=new Date(Date.UTC(0,0,t+-1));return q(r).format(e)}function Bne(t,e,n){const r=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var i;return(i=r[e])!==null&&i!==void 0?i:0}return r[e-1]+1}function jne(t,e){const n=[];return t.forEach(r=>{const i={from:r,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=i.from;o.from>i.from&&a&&s&&(i.from+=1)}),i.from>=e&&(e+=1),n.push(i)}),n}function Une(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(i=>{const o=i.from<i.to;i.from>e.from&&o&&(i.from-=1)})}),t}function v_(t,e,n){const r=jne(t,Bne(t,e,n));return Une(r)}function Oa(t,e,n){zne(t,e),e.set(t,n)}function zne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function St(t,e){return t.get(lF(t,e))}function Ss(t,e,n){return t.set(lF(t,e),n),n}function lF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lh=new WeakMap,Rs=new WeakMap,yr=new WeakMap,og=new WeakMap,Eb=new WeakMap,Tb=new WeakMap,sg=new WeakMap;class BA{constructor(e,n,r){Oa(this,lh,void 0),Oa(this,Rs,void 0),Oa(this,yr,void 0),Oa(this,og,[]),Oa(this,Eb,[]),Oa(this,Tb,void 0),Oa(this,sg,[]),Ss(lh,this,e),Ss(Rs,this,n),Ss(yr,this,r)}setRemovedHfIndexes(e){return Ss(sg,this,e.map(n=>{const r=St(Rs,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),St(sg,this)}getRemovedHfIndexes(){return St(sg,this)}getHfIndexFromVisualIndex(e){const n=St(Rs,this).getIndexesSequence(),r=St(Rs,this).getNotTrimmedIndexes();return n.indexOf(r[e],e)}syncMoves(e){const r=`move${Ln(St(lh,this))}s`;St(yr,this).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&St(yr,this).getEngine()[r](St(yr,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Ss(Eb,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ss(Tb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(St(yr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const r=v_(St(Eb,this),St(Tb,this),St(Rs,this).getNumberOfIndexes());St(yr,this).getSheetId()===null?St(yr,this).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Ln(St(lh,this))}Order`;return n=>{if(St(yr,this).isPerformingUndoRedo())return;const r=St(Rs,this).getIndexesSequence();if(n==="update"&&r.length>0){const i=St(og,this).map(l=>r.indexOf(l)),o=St(yr,this).getEngine().getSheetDimensions(St(yr,this).getSheetId());let s;St(lh,this)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);St(yr,this).getEngine()[e](St(yr,this).getSheetId(),i)}Ss(og,this,r)}}init(){Ss(og,this,St(Rs,this).getIndexesSequence())}}function xa(t,e,n){Yne(t,e),e.set(t,n)}function Yne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e){return t.get(uF(t,e))}function Ha(t,e,n){return t.set(uF(t,e),n),n}function uF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ag=new WeakMap,lg=new WeakMap,_b=new WeakMap,Mb=new WeakMap,Ib=new WeakMap,Pb=new WeakMap,Ob=new WeakMap;class Gne{constructor(e,n,r){xa(this,ag,void 0),xa(this,lg,void 0),xa(this,_b,void 0),xa(this,Mb,!1),xa(this,Ib,!1),xa(this,Pb,null),xa(this,Ob,null),Ha(ag,this,new BA("row",e,this)),Ha(lg,this,new BA("column",n,this)),Ha(_b,this,r)}getForAxis(e){return e==="row"?Ao(ag,this):Ao(lg,this)}setPerformUndo(e){Ha(Mb,this,e)}setPerformRedo(e){Ha(Ib,this,e)}isPerformingUndoRedo(){return Ao(Mb,this)||Ao(Ib,this)}getSheetId(){return Ao(Ob,this)}getEngine(){return Ao(Pb,this)}getPostponeAction(){return Ao(_b,this)}setupSyncEndpoint(e,n){Ha(Pb,this,e),Ha(Ob,this,n),Ao(ag,this).init(),Ao(lg,this).init()}}function qne(t,e){cF(t,e),e.add(t)}function Aa(t,e,n){return(e=Kne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kne(t){var e=Xne(t,"string");return typeof e=="symbol"?e:e+""}function Xne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xb(t,e,n){cF(t,e),e.set(t,n)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function na(t,e,n){return t.set(ze(t,e),n),n}function al(t,e){return t.get(ze(t,e))}function ze(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Dn="formulas",Zne=["maxRows","maxColumns","language"],Qne=260;ne.getSingleton().register("afterNamedExpressionAdded");ne.getSingleton().register("afterNamedExpressionRemoved");ne.getSingleton().register("afterSheetAdded");ne.getSingleton().register("afterSheetRemoved");ne.getSingleton().register("afterSheetRenamed");ne.getSingleton().register("afterFormulasValuesUpdate");const dc=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var is=new WeakMap,nw=new WeakMap,uh=new WeakMap,qe=new WeakSet;class Jne extends Ue{constructor(){var e;super(...arguments),e=this,qne(this,qe),xb(this,is,!1),xb(this,nw,!1),xb(this,uh,[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,mre).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,pre).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,wre).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,vre).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,Cre).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ze(qe,e,yre).call(e,...r)}]]),Aa(this,"staticRegister",si("formulas")),Aa(this,"engine",null),Aa(this,"sheetId",null),Aa(this,"sheetName",null),Aa(this,"indexSyncer",null),Aa(this,"rowAxisSyncer",null),Aa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Dn}static get PLUGIN_PRIORITY(){return Qne}static get SETTING_KEYS(){return[Dn,...Zne]}isEnabled(){return!!this.hot.getSettings()[Dn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Hne(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ke("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&ze(qe,this,Vh).call(this,r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,jA).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,UA).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,jA).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,UA).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,rre).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,ire).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,ere).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,ore).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,zA).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,zA).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,sre).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,are).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,cre).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,hre).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,lre).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,ure).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,dre).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,fre).call(n,...i)}),this.indexSyncer=new Gne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,nre).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,gre).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ze(qe,n,tre).call(n,...i)}),al(uh,this).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){al(uh,this).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),WA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=One(this.hot.getSettings());xne(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Dn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Dn].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const o=this.addSheet(i??void 0,this.hot.getSourceDataArray());ze(qe,this,Vh).call(this,o)}}super.updatePlugin(e)}destroy(){al(uh,this).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),na(uh,this,null),WA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!Wk(n))return Ke("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ke("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Ke(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){NE(`The sheet named \`${e}\` does not exist, switch aborted.`);return}ze(qe,this,Vh).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Ln(Dn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),VA(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o?.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=VA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Ke(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return w_(r,o.type)&&(oF(r,o.dateFormat)?r=sF(r,o.dateFormat):Vne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Vh(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function ere(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Nn(s)&&(s=aF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function tre(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:w}=h.start,{row:b,col:E}=h.end,C=b-m+1,M=E-w+1;for(let H=0;H<f.length;H+=1)for(let L=0;L<f[H].length;L+=1){const P=f[H][L],O=m+H%C,z=w+L%M,K=this.hot.getCellMeta(O,z);w_(P,K.type)&&(P.startsWith("'")?f[H][L]=P.slice(1):this.isFormulaCellType(O,z,this.sheetId)===!1&&(f[H][L]=Wne(P,K.dateFormat)))}return f}function jA(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ln(Dn))||na(nw,this,Rt(this.hot.getSettings().data))}function nre(){if(al(nw,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o,{skipMetaExtension:!0}),a=s.dateFormat;w_(i,s.type)&&(oF(i,a)?t[r][o]=sF(i,a):i.startsWith("=")||(t[r][o]=`'${i}`))})}),na(is,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),na(is,this,!1)}function UA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Ln(Dn)))return;const r=Lne(this.engine,this.hot.getSettings()[Dn].sheetName);if(ze(qe,this,Vh).call(this,r),n!=="updateSettings")if(al(nw,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){na(is,this,!0);const o=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),na(is,this,!1)}}}function rre(t,e,n,r){if(r!=="get"||al(is,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){n.value=Fne(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Nn(s)&&(s=aF(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function ire(t,e,n,r){if(r!=="get"||al(is,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null)return;const s=this.getCellType(i,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function zA(t,e){if(dc(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function ore(t,e){if(dc(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Nn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){Ke(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function sre(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function are(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function lre(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function ure(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function cre(t,e,n){if(dc(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function hre(t,e,n){if(dc(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function dre(t,e,n,r){if(dc(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function fre(t,e,n,r){if(dc(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function gre(t,e,n){var r;na(is,this,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());na(is,this,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function mre(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function pre(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function wre(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function vre(t){this.hot.runHooks("afterSheetAdded",t)}function Cre(t,e){ze(qe,this,Vh).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function yre(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function bre(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(K0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Sre(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(X0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Le(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Rre(t,e){hF(t,e),e.add(t)}function Ere(t,e,n){hF(t,e),e.set(t,n)}function hF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e){return t.get(xs(t,e))}function YA(t,e,n){return t.set(xs(t,e),n),n}function xs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideColumns");ne.getSingleton().register("afterHideColumns");ne.getSingleton().register("beforeUnhideColumns");ne.getSingleton().register("afterUnhideColumns");const GA="hiddenColumns",Tre=310;var ji=new WeakMap,Da=new WeakSet;class _re extends Ue{constructor(){super(...arguments),Rre(this,Da),Ere(this,ji,null)}static get PLUGIN_KEY(){return GA}static get PLUGIN_PRIORITY(){return Tre}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[GA]}enablePlugin(){var e=this;this.enabled||(YA(ji,this,new Hp),Na(ji,this).addLocalHook("init",()=>xs(Da,this,Hre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Na(ji,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(Da,e,xre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>xs(Da,this,Ire).call(this,n,r,i)),this.addHook("modifyColWidth",(n,r)=>xs(Da,this,Mre).call(this,n,r),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return xs(Da,e,Ore).call(e,...r)}),this.addHook("modifyCopyableRange",n=>xs(Da,this,Pre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=Na(ji,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));_(l,u=>{o[u]=!1}),i=ln(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Na(ji,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{Na(ji,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Le(Na(ji,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Na(ji,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){YA(ji,this,null),super.destroy()}}function Mre(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Ire(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Pre(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Ore(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Y(e,n)}function xre(t){t.items.push({name:Ae},bre(this),Sre(this))}function Hre(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function Are(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Z0,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Nre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Q0,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Le(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(m=>n.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return _(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Dre(t,e){dF(t,e),e.add(t)}function kre(t,e,n){dF(t,e),e.set(t,n)}function dF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ka(t,e){return t.get(Hs(t,e))}function qA(t,e,n){return t.set(Hs(t,e),n),n}function Hs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeHideRows");ne.getSingleton().register("afterHideRows");ne.getSingleton().register("beforeUnhideRows");ne.getSingleton().register("afterUnhideRows");const KA="hiddenRows",Lre=320;var Ui=new WeakMap,La=new WeakSet;class $re extends Ue{constructor(){super(...arguments),Dre(this,La),kre(this,Ui,null)}static get PLUGIN_KEY(){return KA}static get PLUGIN_PRIORITY(){return Lre}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[KA]}enablePlugin(){var e=this;this.enabled||(qA(Ui,this,new Hp),ka(Ui,this).addLocalHook("init",()=>Hs(La,this,Ure).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ka(Ui,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(La,e,jre).call(e,...r)}),this.addHook("afterGetCellMeta",(n,r,i)=>Hs(La,this,Vre).call(this,n,r,i)),this.addHook("modifyRowHeight",(n,r)=>Hs(La,this,Fre).call(this,n,r)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hs(La,e,Bre).call(e,...r)}),this.addHook("modifyCopyableRange",n=>Hs(La,this,Wre).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=ka(Ui,this).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));_(l,u=>{o[u]=!1}),i=ln(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&ka(Ui,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{ka(Ui,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Le(ka(Ui,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return ka(Ui,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){_(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){qA(Ui,this,null),super.destroy()}}function Fre(t,e){return this.isHidden(e)?0:t}function Vre(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Wre(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return _(t,r=>{let i=!0,o=0;fe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Bre(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Y(e,n)}function jre(t){t.items.push({name:Ae},Are(this),Nre(this))}function Ure(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function zre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(T0)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Yre(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(_0)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Gre(t,e){fF(t,e),e.add(t)}function qre(t,e,n){fF(t,e),e.set(t,n)}function fF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wR(t,e){return t.get(Dm(t,e))}function Hb(t,e,n){return t.set(Dm(t,e),n),n}function Dm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnFreeze");ne.getSingleton().register("afterColumnFreeze");ne.getSingleton().register("beforeColumnUnfreeze");ne.getSingleton().register("afterColumnUnfreeze");const XA="manualColumnFreeze",Kre=110;var Ka=new WeakMap,Ab=new WeakSet;class Xre extends Ue{constructor(){super(...arguments),Gre(this,Ab),qre(this,Ka,!1)}static get PLUGIN_KEY(){return XA}static get PLUGIN_PRIORITY(){return Kre}isEnabled(){return!!this.hot.getSettings()[XA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Dm(Ab,this,Zre).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Dm(Ab,this,Qre).call(this,e,n)),super.enablePlugin())}disablePlugin(){Hb(Ka,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;wR(Ka,this)||Hb(Ka,this,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;wR(Ka,this)||Hb(Ka,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Zre(t){t.items.push({name:"---------"},zre(this),Yre(this))}function Qre(t,e){if(wR(Ka,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function ug(t,e,n){return(e=Jre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jre(t){var e=eie(t,"string");return typeof e=="symbol"?e:e+""}function eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Nb=0,ZA=1,QA=2,au="px";let gF=class{constructor(e){ug(this,"hot",void 0),ug(this,"_element",null),ug(this,"state",Nb),ug(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=QA}build(){this.state===Nb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ZA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Nb}isAppended(){return this.state===QA}isBuilt(){return this.state>=ZA}setPosition(e,n){Nn(e)&&(this._element.style.top=e+au),Nn(n)&&(this._element.style[this.inlineProperty]=n+au)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Nn(e)&&(this._element.style.width=e+au),Nn(n)&&(this._element.style.height=n+au)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Nn(e)&&(this._element.style.marginTop=e+au),Nn(n)&&(this._element.style[`margin${Ln(this.inlineProperty)}`]=n+au)}getOffset(){const e=this._element.style,n=`margin${Ln(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const tie="ht__manualColumnMove--backlight";let nie=class extends gF{build(){super.build(),Y(this._element,tie)}};const rie="ht__manualColumnMove--guideline";let iie=class extends gF{build(){super.build(),Y(this._element,rie)}};function oie(t,e){mF(t,e),e.add(t)}function gi(t,e,n){mF(t,e),e.set(t,n)}function mF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gr(t,e,n){return t.set(As(t,e),n),n}function he(t,e){return t.get(As(t,e))}function As(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeColumnMove");ne.getSingleton().register("afterColumnMove");const Db="manualColumnMove",sie=120,JA="ht__manualColumnMove",km="show-ui",vR="on-moving--columns",CR="after-selection--columns";var Gn=new WeakMap,ks=new WeakMap,Xo=new WeakMap,nm=new WeakMap,Us=new WeakMap,Yn=new WeakMap,cg=new WeakMap,Wr=new WeakMap,Su=new WeakMap,Lm=new WeakMap,Wh=new WeakMap,$a=new WeakSet;class aie extends Ue{constructor(){super(...arguments),oie(this,$a),gi(this,Gn,new nie(this.hot)),gi(this,ks,new iie(this.hot)),gi(this,Xo,[]),gi(this,nm,0),gi(this,Us,!1),gi(this,Yn,{}),gi(this,cg,void 0),gi(this,Wr,void 0),gi(this,Su,void 0),gi(this,Lm,void 0),gi(this,Wh,void 0)}static get PLUGIN_KEY(){return Db}static get PLUGIN_PRIORITY(){return sie}isEnabled(){return!!this.hot.getSettings()[Db]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,lie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,cie).call(e,...r)}),this.addHook("afterScrollVertically",()=>As($a,this,die).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return As($a,e,fie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,JA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,JA),this.unregisterEvents(),he(Gn,this).destroy(),he(ks,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=he(cg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(gr(cg,this,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return gr(cg,this,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=ln(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Db];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return fe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(he(Wr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,he(Wr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=he(Gn,this).getOffset().start,u=he(Gn,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,w=jt(this.hot.rootElement),b=m.innerWidth-he(Su,this)-w;h=m.innerWidth-he(Yn,this).eventPageX-b-(r.scrollX===void 0?i:0)}else h=he(Yn,this).eventPageX-(he(Su,this)-(r.scrollX===void 0?i:0));if(he(Lm,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(he(Wr,this))&&(o+=i),o+=c,he(Wr,this)<0)he(Wh,this)>0?he(Yn,this).col=0:he(Yn,this).col=e>0?e-1:e;else if(he(Yn,this).TD.offsetWidth/2+o<=h){const m=he(Wr,this)>=he(nm,this)?he(nm,this)-1:he(Wr,this);he(Yn,this).col=m+1,o+=he(Yn,this).TD.offsetWidth}else he(Yn,this).col=he(Wr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&he(Wr,this)<he(Wh,this)&&(f-=he(Su,this)<=r.scrollX?he(Su,this):0),he(Gn,this).setPosition(null,d),he(ks,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>As($a,this,uie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>As($a,this,hie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){he(Gn,this).build(),he(ks,this).build()}destroy(){he(Gn,this).destroy(),he(ks,this).destroy(),super.destroy()}}function lie(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=ye(t.target,"sortAction");if(!s||!o||he(Us,this)||t.button!==0||a){gr(Us,this,!1),he(Xo,this).length=0,pe(this.hot.rootElement,[vR,km]);return}const l=he(ks,this).isBuilt()&&!he(ks,this).isAppended(),u=he(Gn,this).isBuilt()&&!he(Gn,this).isAppended();l&&u&&(he(ks,this).appendTo(i.hider),he(Gn,this).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,gr(Us,this,!0);const m=n.firstChild?uk(t,n.firstChild).x:t.offsetX;he(Yn,this).eventPageX=t.pageX,gr(Wr,this,e.col),he(Yn,this).TD=n,he(Yn,this).col=e.col,gr(Xo,this,this.prepareColumnsToMoving(d,f)),gr(Lm,this,!!this.hot.getSettings().rowHeaders),gr(nm,this,this.hot.countCols()),gr(Wh,this,this.hot.getSettings().fixedColumnsStart),gr(Su,this,Rn(this.hot.rootElement).left);const w=he(Lm,this)?-1:0,b=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,E=e.col<he(Wh,this),C=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(m-(this.hot.isRtl()?n.offsetWidth:0)),H=this.getColumnsWidth(d,e.col-1)+M,L=this.getColumnsWidth(w,d-1)+(E?C:0)+H;he(Gn,this).setPosition(b,L),he(Gn,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-b),he(Gn,this).setOffset(null,-H),Y(this.hot.rootElement,vR)}else pe(this.hot.rootElement,CR),gr(Us,this,!1),he(Xo,this).length=0}function uie(t){he(Us,this)&&(he(Yn,this).eventPageX=t.pageX,this.refreshPositions())}function cie(t,e,n,r){!this.hot.getSelectedRangeLast()||!he(Us,this)||(he(Xo,this).indexOf(e.col)>-1?pe(this.hot.rootElement,km):Y(this.hot.rootElement,km),r.row=!0,r.column=!0,r.cell=!0,gr(Wr,this,e.col),he(Yn,this).TD=n)}function hie(){const t=he(Yn,this).col,e=he(Xo,this).length;if(gr(Wr,this,void 0),gr(Us,this,!1),pe(this.hot.rootElement,[vR,km,CR]),this.hot.selection.isSelectedByColumnHeader()&&Y(this.hot.rootElement,CR),e<1||t===void 0)return;const n=he(Xo,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(he(Xo,this),t);if(he(Xo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function die(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;he(Gn,this).setPosition(r),he(Gn,this).setSize(null,t.hider.offsetHeight-r)}function fie(){this.moveBySettingsOrLoad()}function gie(t,e){pF(t,e),e.add(t)}function In(t,e,n){pF(t,e),e.set(t,n)}function pF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e,n){return t.set(Si(t,e),n),n}function re(t,e){return t.get(Si(t,e))}function Si(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $m="manualColumnResize",mie=130,e1="manualColumnWidths";var jo=new WeakMap,hg=new WeakMap,Pr=new WeakMap,Fm=new WeakMap,ao=new WeakMap,pie=new WeakMap,Lu=new WeakMap,dg=new WeakMap,sr=new WeakMap,Fo=new WeakMap,gl=new WeakMap,Vm=new WeakMap,Bh=new WeakMap,jh=new WeakMap,xr=new WeakMap,Uh=new WeakMap,zi=new WeakSet;class wie extends Ue{static get PLUGIN_KEY(){return $m}static get PLUGIN_PRIORITY(){return mie}constructor(e){super(e),gie(this,zi),In(this,jo,null),In(this,hg,null),In(this,Pr,[]),In(this,Fm,null),In(this,ao,null),In(this,pie,null),In(this,Lu,null),In(this,dg,null),In(this,sr,this.hot.rootDocument.createElement("DIV")),In(this,Fo,this.hot.rootDocument.createElement("DIV")),In(this,gl,null),In(this,Vm,!1),In(this,Bh,0),In(this,jh,null),In(this,xr,void 0),In(this,Uh,void 0),Y(re(sr,this),"manualColumnResizer"),Y(re(Fo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[$m]}enablePlugin(){var e=this;this.enabled||(Bt(xr,this,new aa),re(xr,this).addLocalHook("init",()=>Si(zi,this,vie).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,re(xr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(zi,e,Eie).call(e,...r)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(zi,e,Tie).call(e,...r)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Si(zi,e,_ie).call(e,...r)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Bt(Uh,this,re(xr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",e1,re(xr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",e1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return re(xr,this).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);re(xr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Bt(jo,this,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(re(jo,this)),i=r.col;if(i<0)return;const o=Kt(re(jo,this)),s=re(jo,this).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(re(jo,this),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(re(jo,this),r.row,r.col)),Bt(hg,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Bt(Pr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();_(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;fe(d,f,m=>{re(Pr,this).includes(m)||re(Pr,this).push(m)})})}re(Pr,this).includes(re(hg,this))||Bt(Pr,this,[re(hg,this)]),Bt(dg,this,l.start-6),Bt(Lu,this,parseInt(s.width,10)),re(sr,this).style.top=`${l.top}px`,re(sr,this).style[this.inlineDir]=`${re(dg,this)+re(Lu,this)}px`,re(sr,this).style.height=`${o}px`,this.hot.rootElement.appendChild(re(sr,this))}refreshHandlePosition(){re(sr,this).style[this.inlineDir]=`${re(dg,this)+re(Fm,this)}px`}setupGuidePosition(){const e=parseInt(Kt(re(sr,this)),10),n=parseInt(re(sr,this).style.top,10)+e,r=this.hot.view.getTableHeight();Y(re(sr,this),"active"),Y(re(Fo,this),"active"),re(Fo,this).style.top=`${n}px`,this.refreshGuidePosition(),re(Fo,this).style.height=`${r-e}px`,this.hot.rootElement.appendChild(re(Fo,this))}refreshGuidePosition(){re(Fo,this).style[this.inlineDir]=re(sr,this).style[this.inlineDir]}hideHandleAndGuide(){pe(re(sr,this),"active"),pe(re(Fo,this),"active")}checkIfColumnHeader(e){const n=Qs(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",re(ao,this),r,!0);o!==void 0&&Bt(ao,this,o),this.setManualSize(r,re(ao,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(ao,this),r,!0),i&&e()};re(Bh,this)>=2&&(re(Pr,this).length>1?(_(re(Pr,this),i=>{n(i)}),e()):_(re(Pr,this),i=>{n(i,!0)})),Bt(Bh,this,0),Bt(jh,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Si(zi,this,Cie).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Si(zi,this,yie).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Si(zi,this,bie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Si(zi,this,Sie).call(this)),this.eventManager.addEventListener(re(sr,this),"contextmenu",()=>Si(zi,this,Rie).call(this))}destroy(){super.destroy()}}function vie(){const t=this.hot.getSettings()[$m],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{re(xr,this).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{re(xr,this).setValueAtIndex(r,n)})},!0),Bt(Uh,this,t)):t===!0&&Array.isArray(re(Uh,this))&&this.hot.batchExecution(()=>{re(Uh,this).forEach((n,r)=>{re(xr,this).setValueAtIndex(r,n)})},!0)}function Cie(t){if(!PE(t.target)&&re(Vm,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(re(gl,this)||this.setupHandlePosition(e))}}function yie(t){t.target.parentNode===this.hot.rootElement&&ye(t.target,"manualColumnResizer")&&(this.setupHandlePosition(re(jo,this)),this.setupGuidePosition(),Bt(gl,this,!0),re(jh,this)===null&&(Bt(jh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(re(jh,this))),Bt(Bh,this,re(Bh,this)+1),this.startX=t.pageX,Bt(ao,this,re(Lu,this)))}function bie(t){if(re(gl,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Bt(Fm,this,re(Lu,this)+e),_(re(Pr,this),n=>{Bt(ao,this,this.setManualSize(n,re(Fm,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Sie(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",re(ao,this),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",re(ao,this),n,!1)};re(gl,this)&&(this.hideHandleAndGuide(),Bt(gl,this,!1),re(ao,this)!==re(Lu,this)&&(re(Pr,this).length>1?(_(re(Pr,this),r=>{e(r)}),t()):_(re(Pr,this),r=>{e(r,!0)})),this.setupHandlePosition(re(jo,this)))}function Rie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(re(sr,this)),this.hot.rootElement.removeChild(re(Fo,this)),Bt(gl,this,!1),Bt(Vm,this,!0),this.hot._registerImmediate(()=>{Bt(Vm,this,!1)})}function Eie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=re(xr,this).getValueAtIndex(r);this.hot.getSettings()[$m]&&i&&(n=i)}return n}function Tie(t,e){const n=re(xr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function _ie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function kb(t,e,n){return(e=Mie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mie(t){var e=Iie(t,"string");return typeof e=="symbol"?e:e+""}function Iie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lb=0,t1=1,n1=2,lu="px";let wF=class{constructor(e){kb(this,"hot",void 0),kb(this,"_element",null),kb(this,"state",Lb),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=n1}build(){this.state===Lb&&(this._element=this.hot.rootDocument.createElement("div"),this.state=t1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Lb}isAppended(){return this.state===n1}isBuilt(){return this.state>=t1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+lu),n!==void 0&&(this._element.style.left=n+lu)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+lu),n&&(this._element.style.height=n+lu)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+lu),n&&(this._element.style.marginLeft=n+lu)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const Pie="ht__manualRowMove--backlight";class Oie extends wF{build(){super.build(),Y(this._element,Pie)}}const xie="ht__manualRowMove--guideline";class Hie extends wF{build(){super.build(),Y(this._element,xie)}}function Aie(t,e){vF(t,e),e.add(t)}function uu(t,e,n){vF(t,e),e.set(t,n)}function vF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ol(t,e,n){return t.set(Ns(t,e),n),n}function Ee(t,e){return t.get(Ns(t,e))}function Ns(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeRowMove");ne.getSingleton().register("afterRowMove");const $b="manualRowMove",Nie=140,r1="ht__manualRowMove",Wm="show-ui",yR="on-moving--rows",bR="after-selection--rows";var qn=new WeakMap,Ls=new WeakMap,Zo=new WeakMap,zs=new WeakMap,mr=new WeakMap,fg=new WeakMap,Fa=new WeakSet;class Die extends Ue{constructor(){super(...arguments),Aie(this,Fa),uu(this,qn,new Oie(this.hot)),uu(this,Ls,new Hie(this.hot)),uu(this,Zo,[]),uu(this,zs,void 0),uu(this,mr,{}),uu(this,fg,void 0)}static get PLUGIN_KEY(){return $b}static get PLUGIN_PRIORITY(){return Nie}isEnabled(){return!!this.hot.getSettings()[$b]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ns(Fa,e,kie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ns(Fa,e,$ie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Ns(Fa,this,Vie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ns(Fa,e,Wie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Y(this.hot.rootElement,r1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){pe(this.hot.rootElement,r1),this.unregisterEvents(),Ee(qn,this).destroy(),Ee(Ls,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Ee(fg,this),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(ol(fg,this,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return ol(fg,this,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=ln(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[$b];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return fe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Ee(mr,this).coords,n=this.hot.getFirstFullyVisibleRow(),r=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Ee(mr,this).TD,a=this.hot.rootElement,l=Rn(a),u=Bu(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=Ee(mr,this).eventPageY-d+c,m=o.hider.offsetHeight,w=o.TBODY.offsetTop,b=Ee(qn,this).getOffset().top,E=Ee(qn,this).getSize().height,C=s.offsetHeight/2,M=s.offsetHeight;let H=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const L=f>=H+C;this.isFixedRowTop(e.row)&&(H+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Ee(mr,this).row=n>0?n-1:n:L?(Ee(mr,this).row=e.row+1,H+=e.row===0?M-1:M):Ee(mr,this).row=e.row;let P=f,O=H;f+E+b>=m?P=m-E-b:f+b<w&&(P=w+Math.abs(b)),H>=m-1&&(O=m-1),Ee(qn,this).setPosition(P),Ee(Ls,this).setPosition(O)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ns(Fa,this,Lie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ns(Fa,this,Fie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Ee(qn,this).build(),Ee(Ls,this).build()}destroy(){Ee(qn,this).destroy(),Ee(Ls,this).destroy(),super.destroy()}}function kie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Ee(zs,this)||t.button!==0){ol(zs,this,!1),Ee(Zo,this).length=0,pe(this.hot.rootElement,[yR,Wm]);return}const l=Ee(Ls,this).isBuilt()&&!Ee(Ls,this).isAppended(),u=Ee(qn,this).isBuilt()&&!Ee(qn,this).isAppended();l&&u&&(Ee(Ls,this).appendTo(i.hider),Ee(qn,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,ol(zs,this,!0),Ee(mr,this).eventPageY=t.pageY,Ee(mr,this).coords=e,Ee(mr,this).TD=n,ol(Zo,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+o.getRowHeaderWidth(),w=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);Ee(qn,this).setPosition(null,m),Ee(qn,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),Ee(qn,this).setOffset(-w,null),Y(this.hot.rootElement,yR),this.refreshPositions()}else pe(this.hot.rootElement,bR),ol(zs,this,!1),Ee(Zo,this).length=0}function Lie(t){Ee(zs,this)&&(Ee(mr,this).eventPageY=t.pageY,this.refreshPositions())}function $ie(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ee(zs,this)||(Ee(Zo,this).indexOf(e.row)>-1?pe(this.hot.rootElement,Wm):Y(this.hot.rootElement,Wm),r.row=!0,r.column=!0,r.cell=!0,Ee(mr,this).coords=e,Ee(mr,this).TD=n)}function Fie(){const t=Ee(mr,this).row,e=Ee(Zo,this).length;if(ol(zs,this,!1),pe(this.hot.rootElement,[yR,Wm,bR]),this.hot.selection.isSelectedByRowHeader()&&Y(this.hot.rootElement,bR),e<1||t===void 0)return;const n=Ee(Zo,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Ee(Zo,this),t);if(Ee(Zo,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Vie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Ee(qn,this).setPosition(null,r),Ee(qn,this).setSize(t.hider.offsetWidth-r)}function Wie(){this.moveBySettingsOrLoad()}function Bie(t,e){CF(t,e),e.add(t)}function Pn(t,e,n){CF(t,e),e.set(t,n)}function CF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(t,e,n){return t.set(Uo(t,e),n),n}function te(t,e){return t.get(Uo(t,e))}function Uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bm="manualRowResize",jie=30,i1="manualRowHeights";var to=new WeakMap,gg=new WeakMap,Or=new WeakMap,zh=new WeakMap,$s=new WeakMap,C_=new WeakMap,$u=new WeakMap,mg=new WeakMap,Un=new WeakMap,Qi=new WeakMap,ml=new WeakMap,jm=new WeakMap,Yh=new WeakMap,Gh=new WeakMap,Ei=new WeakMap,qh=new WeakMap,Es=new WeakSet;class Uie extends Ue{static get PLUGIN_KEY(){return Bm}static get PLUGIN_PRIORITY(){return jie}constructor(e){super(e),Bie(this,Es),Pn(this,to,null),Pn(this,gg,null),Pn(this,Or,[]),Pn(this,zh,null),Pn(this,$s,null),Pn(this,C_,null),Pn(this,$u,null),Pn(this,mg,null),Pn(this,Un,this.hot.rootDocument.createElement("DIV")),Pn(this,Qi,this.hot.rootDocument.createElement("DIV")),Pn(this,ml,!1),Pn(this,jm,!1),Pn(this,Yh,0),Pn(this,Gh,null),Pn(this,Ei,void 0),Pn(this,qh,void 0),Y(te(Un,this),"manualRowResizer"),Y(te(Qi,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Bm]}enablePlugin(){this.enabled||(Nt(Ei,this,new aa),te(Ei,this).addLocalHook("init",()=>Uo(Es,this,Zie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,te(Ei,this)),this.addHook("modifyRowHeight",(e,n)=>Uo(Es,this,Xie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Nt(qh,this,te(Ei,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",i1,te(Ei,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",i1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return te(Ei,this).setValueAtIndex(r,i),i}getLastDesiredRowHeight(){return te(zh,this)}setupHandlePosition(e){Nt(to,this,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(te(to,this)),o=i.row;if(o<0)return;const s=jt(te(to,this)),a=te(to,this).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(te(to,this),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(te(to,this),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(te(to,this),i.row,i.col)),Nt(gg,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Nt(Or,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();_(d,f=>{const m=f.getTopStartCorner().row,w=f.getBottomStartCorner().row;fe(m,w,b=>{te(Or,this).includes(b)||te(Or,this).push(b)})})}te(Or,this).includes(te(gg,this))||Nt(Or,this,[te(gg,this)]),Nt(mg,this,c.top-6),Nt($u,this,parseInt(a.height,10)),te(Un,this).style.top=`${te(mg,this)+te($u,this)}px`,te(Un,this).style[this.inlineDir]=`${c.start}px`,te(Un,this).style.width=`${s}px`,this.hot.rootElement.appendChild(te(Un,this))}refreshHandlePosition(){te(Un,this).style.top=`${te(mg,this)+te(zh,this)}px`}setupGuidePosition(){const e=parseInt(jt(te(Un,this)),10),n=parseInt(te(Un,this).style[this.inlineDir],10)+e,r=this.hot.view.getTableWidth();Y(te(Un,this),"active"),Y(te(Qi,this),"active"),te(Qi,this).style.top=te(Un,this).style.top,te(Qi,this).style[this.inlineDir]=`${n}px`,te(Qi,this).style.width=`${r-e}px`,this.hot.rootElement.appendChild(te(Qi,this))}refreshGuidePosition(){te(Qi,this).style.top=te(Un,this).style.top}hideHandleAndGuide(){pe(te(Un,this),"active"),pe(te(Qi,this),"active")}checkIfRowHeader(e){const n=Qs(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&te($s,this)<n?n:te($s,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Nt($s,this,o),this.setManualSize(r,te($s,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};te(Yh,this)>=2&&(te(Or,this).length>1?(_(te(Or,this),i=>{n(i)}),e()):_(te(Or,this),i=>{n(i,!0)})),Nt(Yh,this,0),Nt(Gh,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Uo(Es,this,zie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Uo(Es,this,Yie).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Uo(Es,this,Gie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Uo(Es,this,qie).call(this)),this.eventManager.addEventListener(te(Un,this),"contextmenu",()=>Uo(Es,this,Kie).call(this))}destroy(){super.destroy()}}function zie(t){if(!PE(t.target)&&te(jm,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(te(ml,this)||this.setupHandlePosition(e))}}function Yie(t){ye(t.target,"manualRowResizer")&&(this.setupHandlePosition(te(to,this)),this.setupGuidePosition(),Nt(ml,this,!0),te(Gh,this)===null&&(Nt(Gh,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(te(Gh,this))),Nt(Yh,this,te(Yh,this)+1),Nt(C_,this,t.pageY),Nt($s,this,te($u,this)))}function Gie(t){te(ml,this)&&(Nt(zh,this,te($u,this)+(t.pageY-te(C_,this))),_(te(Or,this),e=>{Nt($s,this,this.setManualSize(e,te(zh,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function qie(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};te(ml,this)&&(this.hideHandleAndGuide(),Nt(ml,this,!1),te($s,this)!==te($u,this)&&(te(Or,this).length>1?(_(te(Or,this),r=>{e(r)}),t()):_(te(Or,this),r=>{e(r,!0)})),this.setupHandlePosition(te(to,this)))}function Kie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(te(Un,this)),this.hot.rootElement.removeChild(te(Qi,this)),Nt(ml,this,!1),Nt(jm,this,!0),this.hot._registerImmediate(()=>{Nt(jm,this,!1)})}function Xie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=te(Ei,this).getValueAtIndex(r);this.hot.getSettings()[Bm]&&i&&(n=i)}return n}function Zie(){const t=this.hot.getSettings()[Bm],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{te(Ei,this).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{te(Ei,this).setValueAtIndex(r,n)}),Nt(qh,this,t)):t===!0&&Array.isArray(te(qh,this))&&te(qh,this).forEach((n,r)=>{te(Ei,this).setValueAtIndex(r,n)})},!0)}var o1={},s1;function Qie(){if(s1)return o1;s1=1;var t=Mp();return t("flatMap"),o1}Qie();var a1={},l1={},Fb,u1;function Jie(){if(u1)return Fb;u1=1;var t=on(),e=an(),n=mo(),r=$R();return Fb=function(i,o){(!o||typeof i!="string")&&e(i);var s=r(i);return n(e(s!==void 0?t(s,i):i))},Fb}var c1;function eoe(){if(c1)return l1;c1=1;var t=ft(),e=on(),n=wr(),r=an(),i=mo(),o=Jie(),s=WR(),a=vr(),l=ra(),u=BR(),c=oa(),h=!l&&!u("flatMap",function(){}),d=!l&&!h&&c("flatMap",TypeError),f=l||h||d,m=s(function(){for(var w=this.iterator,b=this.mapper,E,C;;){if(C=this.inner)try{if(E=r(e(C.next,C.iterator)),!E.done)return E.value;this.inner=null}catch(M){a(w,"throw",M)}if(E=r(e(this.next,w)),this.done=!!E.done)return;try{this.inner=o(b(E.value,this.counter++),!1)}catch(M){a(w,"throw",M)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(b){r(this);try{n(b)}catch(E){a(this,"throw",E)}return d?e(d,this,b):new m(i(this),{mapper:b,inner:null})}}),l1}var h1;function toe(){return h1||(h1=1,eoe()),a1}toe();function noe(t,e,n){roe(t,e),e.set(t,n)}function roe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Va(t,e,n){return(e=ioe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ioe(t){var e=ooe(t,"string");return typeof e=="symbol"?e:e+""}function ooe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d1(t,e){return t.get(yF(t,e))}function pg(t,e,n){return t.set(yF(t,e),n),n}function yF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Wa=new WeakMap;class no{constructor(e,n,r,i,o,s){Va(this,"row",void 0),Va(this,"col",void 0),Va(this,"rowspan",void 0),Va(this,"colspan",void 0),Va(this,"removed",!1),Va(this,"cellCoordsFactory",void 0),Va(this,"cellRangeFactory",void 0),noe(this,Wa,null),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return nt`The merged cell declared with {row: ${n}, col: ${r},\x20
      rowspan: ${i}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:r,rowspan:i,colspan:o}=e;return n<0||r<0||i<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:r}=e;return r===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:r}=e;return r===0||n===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),pg(Wa,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,pg(Wa,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return pg(Wa,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return d1(Wa,this)||pg(Wa,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),d1(Wa,this)}}function soe(t,e){aoe(t,e),e.add(t)}function aoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wg(t,e,n){return(e=loe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function loe(t){var e=uoe(t,"string");return typeof e=="symbol"?e:e+""}function uoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ba(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ts=new WeakSet;class Um{constructor(e){soe(this,Ts),wg(this,"plugin",void 0),wg(this,"mergedCells",[]),wg(this,"mergedCellsMatrix",new Map),wg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:r}=e;return nt`The merged cell declared at [${n}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var r;return this.mergedCellsMatrix.has(e)&&(r=this.mergedCellsMatrix.get(e).get(n))!==null&&r!==void 0?r:!1}getByRange(e){const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=i&&h>=r&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(i=>{const{row:o,col:s,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ke(Um.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=r;l<=o;l++)for(let u=i;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new no(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Ba(Ts,this,f1).call(this,a),a):(u&&Ke(Um.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.get(e,n),i=r?this.mergedCells.indexOf(r):-1;return r&&i!==-1?(this.mergedCells.splice(i,1),Ba(Ts,this,coe).call(this,r),r):!1}clear(){_(this.mergedCells,e=>{let{row:n,col:r,rowspan:i,colspan:o}=e;fe(n,n+i,s=>{fe(r,r+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let r=0;r<this.mergedCells.length;r++)if(this.mergedCells[r].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);if(!r)return!1;const{row:i,col:o,rowspan:s,colspan:a}=r,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=We(u,i,i+s-1),d=We(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}getStartMostColumnIndex(e,n){const r=Ba(Ts,this,vg).call(this,e,"col",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getEndMostColumnIndex(e,n){const r=Ba(Ts,this,vg).call(this,e,"col",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}getTopMostRowIndex(e,n){const r=Ba(Ts,this,vg).call(this,e,"row",-1);let i=n;for(let o=0;o<r.length;o++)if(r[o]<=n){i=r[o];break}return i}getBottomMostRowIndex(e,n){const r=Ba(Ts,this,vg).call(this,e,"row",1);let i=n;for(let o=0;o<r.length;o++)if(r[o]>=n){i=r[o];break}return i}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}const o=[];this.mergedCells.forEach(s=>{s.shift(i,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Ba(Ts,this,f1).call(this,s)})}}function vg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=new Map,i=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=i.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=i.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),r.has(l)||r.set(l,new Set),r.get(l).add(c)}return Array.from(new Set(Array.from(r.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function f1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function coe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function Vb(t,e,n){return(e=hoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hoe(t){var e=doe(t,"string");return typeof e=="symbol"?e:e+""}function doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class foe{constructor(e){Vb(this,"plugin",void 0),Vb(this,"mergedCellsCollection",void 0),Vb(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,m=s-f,w=this.getFarthestCollection(e,n,r,i);if(w){if(r==="down"){const b=w.row+w.rowspan-a-m;o[2]+b>=this.plugin.hot.countRows()?o[2]-=m:o[2]+=m?b:0}else if(r==="right"){const b=w.col+w.colspan-l-m;o[3]+b>=this.plugin.hot.countCols()?o[3]-=m:o[3]+=m?b:0}else if(r==="up"){const b=u-m-w.row+1;o[0]+b<0?o[0]+=m:o[0]-=m?b:0}else if(r==="left"){const b=c-m-w.col+1;o[1]+b<0?o[1]+=m:o[1]-=m?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Xt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[i,a+f,c,h]}default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,m=Math.floor(d/f)*f,w=d-m;let b=null,E=null,C=null;switch(r){case"up":b="includesVertically",C=c-w+1;break;case"left":b="includesHorizontally",C=c-w+1;break;case"down":b="includesVertically",C=h+w-1;break;case"right":b="includesHorizontally",C=h+w-1;break}return _(i,M=>{M[b](C)&&M.isFarther(E,r)&&(E=M)}),E}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return _(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:r==="up"||r==="down"?!f.every(m=>{let{colspan:w}=m;return w===h.getWidth()}):!f.every(m=>{let{rowspan:w}=m;return w===h.getHeight()})}}function Wb(t,e,n){return(e=goe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:e+""}function moe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class poe{constructor(e){Wb(this,"plugin",void 0),Wb(this,"hot",void 0),Wb(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function woe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(I0)}return this.getTranslatedPhrase(M0)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return e?no.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Kh(t,e,n){return(e=voe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function voe(t){var e=Coe(t,"string");return typeof e=="symbol"?e:e+""}function Coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g1{constructor(e){Kh(this,"data",void 0),Kh(this,"next",null),Kh(this,"prev",null),this.data=e}}class Cg{constructor(){Kh(this,"first",null),Kh(this,"last",null)}push(e){const n=new g1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.last;this.last=n,n.prev=r,r.next=n}return n}unshift(e){const n=new g1(e);if(this.first===null)this.first=n,this.last=n;else{const r=this.first;this.first=n,n.next=r,r.prev=n}}inorder(e){let n=this.first;for(;n;){const r=e(n);if(n===this.last||r===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,r,i;for(;n;){if(n.data===e)return r=n.next,i=n.prev,r&&(r.prev=i),i&&(i.next=r),n===this.first&&(this.first=r),n===this.last&&(this.last=i),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(r,i){i&&(e(i,i.next),i.next=r)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,r;for(;e;)r=e.next,e.next=n,n.prev=e,n=e,e=r;this.first.next=null,this.last.prev=null,r=this.first,this.first=n,this.last=r}}function yoe(t,e){bF(t,e),e.add(t)}function ja(t,e,n){bF(t,e),e.set(t,n)}function bF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){return t.get(zm(t,e))}function br(t,e,n){return t.set(zm(t,e),n),n}function zm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap,Gi=new WeakMap,qi=new WeakMap,Ki=new WeakMap,SR=new WeakMap,yg=new WeakMap,bg=new WeakMap,Bb=new WeakSet;class boe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:r,columnIndexMapper:i}=e;yoe(this,Bb),ja(this,Yi,new Cg),ja(this,Gi,new Cg),ja(this,qi,null),ja(this,Ki,null),ja(this,SR,null),ja(this,yg,null),ja(this,bg,null),br(SR,this,n),br(yg,this,r),br(bg,this,i)}getCurrentVerticalNode(){return et(Ki,this).data}getFirstVerticalNode(){return et(Gi,this).first.data}getNextVerticalNode(){return et(Ki,this).next.data}getPrevVerticalNode(){return et(Ki,this).prev.data}getCurrentHorizontalNode(){return et(qi,this).data}getFirstHorizontalNode(){return et(Yi,this).first.data}getNextHorizontalNode(){return et(qi,this).next.data}getPrevHorizontalNode(){return et(qi,this).prev.data}setPrevNodeAsActive(){br(Ki,this,et(Ki,this).prev),br(qi,this,et(qi,this).prev)}setNextNodeAsActive(){br(Ki,this,et(Ki,this).next),br(qi,this,et(qi,this).next)}buildFocusOrder(e){const n=e.getTopStartCorner(),r=e.getBottomEndCorner(),i=new WeakSet;br(Yi,this,new Cg);for(let s=n.row;s<=r.row;s++)if(!et(yg,this).isHidden(s))for(let a=n.col;a<=r.col;a++){if(et(bg,this).isHidden(a))continue;const l=zm(Bb,this,m1).call(this,e,et(Yi,this),i,s,a);l&&br(qi,this,l)}et(Yi,this).first&&(et(Yi,this).first.prev=et(Yi,this).last,et(Yi,this).last.next=et(Yi,this).first);const o=new WeakSet;br(Gi,this,new Cg);for(let s=n.col;s<=r.col;s++)if(!et(bg,this).isHidden(s))for(let a=n.row;a<=r.row;a++){if(et(yg,this).isHidden(a))continue;const l=zm(Bb,this,m1).call(this,e,et(Gi,this),o,a,s);l&&br(Ki,this,l)}et(Gi,this).first&&(et(Gi,this).first.prev=et(Gi,this).last,et(Gi,this).last.next=et(Gi,this).first)}setActiveNode(e,n){return et(Yi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return br(qi,this,r),!1}),et(Gi,this).inorder(r=>{const{rowStart:i,rowEnd:o,colStart:s,colEnd:a}=r.data;if(e>=i&&e<=o&&n>=s&&n<=a)return br(Ki,this,r),!1}),this}}function m1(t,e,n,r,i){const o=t.getTopStartCorner(),s=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=et(SR,this).call(this,r,i);if(l&&n.has(l))return null;const u={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function SF(t,e,n){const{rowIndexMapper:r,stylesHandler:i}=t,o=i.getDefaultRowHeight();let s=0;for(let l=e;l<e+n;l++)if(!r.isHidden(l)){var a;s+=(a=t.getRowHeight(l))!==null&&a!==void 0?a:o,l===0&&!i.isClassicTheme()&&(s+=1)}return s}function Soe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:r}=e,i=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!Pe(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),Wu()&&i.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${i.get(l)}px`,i.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:m}=c,[w,b]=t.translateMergedCellToRenderable(h,m,d,f),E=t.getSetting("virtualized");if(Wu()&&d===0&&!e.getSettings().rowHeaders){const A=SF(e,h,m);i.set(l,A/m)}const C=n.getRenderableFromVisualIndex(l),M=r.getRenderableFromVisualIndex(u),H=w-C+1,L=b-M+1;let P=n.getNearestNotHiddenIndex(h,1),O=r.getNearestNotHiddenIndex(d,1);if(E){const A=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(A)||(P=Math.max(P,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(A)||(O=Math.max(O,e.getFirstRenderedVisibleColumn()))}const z=Math.min(m,H),K=Math.min(f,L);P===l&&O===u?(a.setAttribute("rowspan",z),a.setAttribute("colspan",K)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function Roe(t,e){RF(t,e),e.add(t)}function Sg(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jb(t,e,n){return(e=Eoe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eoe(t){var e=Toe(t,"string");return typeof e=="symbol"?e:e+""}function Toe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cd(t,e,n){return t.set(it(t,e),n),n}function dt(t,e){return t.get(it(t,e))}function it(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ne.getSingleton().register("beforeMergeCells");ne.getSingleton().register("afterMergeCells");ne.getSingleton().register("beforeUnmergeCells");ne.getSingleton().register("afterUnmergeCells");const RR="mergeCells",_oe=150,p1=RR;var Kr=new WeakMap,Xr=new WeakMap,lo=new WeakMap,w1=new WeakMap,ut=new WeakSet;class Moe extends Ue{constructor(){super(...arguments),Roe(this,ut),jb(this,"mergedCellsCollection",null),jb(this,"autofillCalculations",null),jb(this,"selectionCalculations",null),Sg(this,Kr,null),Sg(this,Xr,{row:0,col:0}),Sg(this,lo,new boe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Sg(this,w1,Soe(this))}static get PLUGIN_KEY(){return RR}static get PLUGIN_PRIORITY(){return _oe}static get DEFAULT_SETTINGS(){return{[jL]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[RR]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Um(this),this.autofillCalculations=new foe(this),this.selectionCalculations=new poe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Ioe).call(e,...r)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Ooe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,xoe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Hoe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Aoe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,C1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,C1).call(e,...r)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Doe).call(e,...r)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,koe).call(e,...r)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Loe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,v1).call(e,...r)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,v1).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Poe).call(e,...r)}),this.addHook("afterRenderer",function(){return dt(w1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Noe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,$oe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Foe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Voe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Woe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Boe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,joe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Uoe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,zoe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Yoe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Goe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,qoe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Koe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Xoe).call(e,...r)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return it(ut,e,Zoe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!vE())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=id(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{var i;r.style.background=(i=id(r,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?no.containsNegativeValues(e)?(Ke(no.NEGATIVE_VALUES_WARNING(e)),!1):no.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ke(no.IS_OUT_OF_BOUNDS_WARNING(e)),!1):no.isSingleCell(e)?(Ke(no.IS_SINGLE_CELL(e)),!1):no.containsZeroSpan(e)?(Ke(no.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),r=[];n.forEach(i=>{const{row:o,col:s,rowspan:a,colspan:l}=i,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&r.push([d,f,null])}),r.length!==0&&this.hot.setDataAtCell(r,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),fe(0,s.rowspan-1,c=>{fe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),_(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),fe(0,i.rowspan-1,o=>{fe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:r}=e.clone().normalize(),i=this.mergedCellsCollection.get(n.row,n.col);i.row===n.row&&i.col===n.col&&i.row+i.rowspan-1===r.row&&i.col+i.colspan-1===r.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:p1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(p1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Pe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Pe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Pe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Pe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Ioe(){this.generateFromSettings(),this.hot.render()}function Poe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast(),r=n.getTopStartCorner(),i=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(r.row===e[o].row&&r.col===e[o].col&&i.row===e[o].row+e[o].rowspan-1&&i.col===e[o].col+e[o].colspan-1)return!1}return t}function Ooe(t){dt(Xr,this).row=t.row,dt(Xr,this).col=t.col}function xoe(t){const e=this.hot.getSelectedRangeLast(),{highlight:n}=e,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;dt(Kr,this)&&(i.getRenderableFromVisualIndex(dt(Kr,this).row)!==null&&(n.row=dt(Kr,this).row),r.getRenderableFromVisualIndex(dt(Kr,this).col)!==null&&(n.col=dt(Kr,this).col),Cd(Kr,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=r.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Hoe(t){const e=this.hot.getSelectedRangeLast(),n=e.clone(),{to:r}=e,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(a,r.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function Aoe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Cd(Kr,this,e.clone());return}for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Cd(Kr,this,e.clone()),n&&e.assign(n)}function v1(t,e,n,r){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,u=o,c=s,h=o+l-1,d=s+a-1;if(r==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),m=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),w=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[We(m,u,h),We(w,c,d),We(this.hot.getLastRenderedVisibleRow(),u,h),We(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function Noe(t){t.items.push({name:"---------"},woe(this))}function C1(){Cd(Kr,this,null)}function Doe(){if(dt(Kr,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),r=dt(Kr,this).clone().normalize();dt(lo,this).setActiveNode(r.row,r.col),dt(Xr,this).row>0||dt(Xr,this).col>0?dt(lo,this).setPrevNodeAsActive():(n==="E-W"&&dt(Xr,this).col<0||e==="S-N"&&dt(Xr,this).row<0)&&dt(lo,this).setNextNodeAsActive()}function koe(t,e){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(dt(Xr,this).col<0){const{rowEnd:a,colEnd:l}=dt(lo,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(dt(Xr,this).col>0){const{rowStart:a,colStart:l}=dt(lo,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}else if(dt(Xr,this).row<0){const{rowEnd:a,colEnd:l}=dt(lo,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1)}else if(dt(Xr,this).row>0){const{rowStart:a,colStart:l}=dt(lo,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1)}if(o!==null||s!==null){const a=this.hot._createCellCoords(o,s),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):n.highlight.assign(a),u.clear(),u.add(a).commit()}dt(lo,this).setActiveNode(t,e),Cd(Xr,this,{row:0,col:0})}function Loe(){this.hot.getSelectedRangeLast().isHeader()||dt(lo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function $oe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Foe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Voe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Woe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const r=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Boe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function joe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Uoe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function zoe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Yoe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Goe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);_(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function qoe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Koe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Xoe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Zoe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let r,i;if(n==="master")r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,m=0;n==="top"||n==="top_inline_start_corner"?m=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):m=f-h,t=Math.max(t??0,SF(this.hot,e,m))}),t}function Qoe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:JL(u.type))(l,u,d)(c,h);if(m===co){const w=a+1;if(typeof e[w]<"u")return s(w)}return m}(0)}}const EF="sort";function Joe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${EF}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function ese(t){const e=t.className.split(" "),n=new RegExp(`^${EF}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function tse(t,e,n){return(e=nse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nse(t){var e=rse(t,"string");return typeof e=="symbol"?e:e+""}function rse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ym="multiColumnSorting",ise=170,y1=Ym;QL(Ym,Qoe);class ose extends l${constructor(){super(...arguments),tse(this,"pluginKey",Ym)}static get PLUGIN_KEY(){return Ym}static get PLUGIN_PRIORITY(){return ise}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Mm)),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:la,position:"before",group:y1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(y1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),pe(e,ese(e)),this.enabled!==!1&&Y(e,Joe(...r))}onAfterOnCellMouseDown(e,n){o_(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Mm))):this.sort(this.getColumnNextConfig(n.col)))}}function b1(t,e,n){return(e=sse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sse(t){var e=ase(t,"string");return typeof e=="symbol"?e:e+""}function ase(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lse="multipleSelectionHandles",use=160;class cse extends Ue{constructor(){super(...arguments),b1(this,"dragged",[]),b1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return lse}static get PLUGIN_PRIORITY(){return use}isEnabled(){return _i()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(ye(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(ye(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(ye(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function ER(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function TF(){return{label:"",isPlaceholder:!0}}function hse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;_(t,i=>{const o=[];let s=0;n.push(o),_(i,a=>{const l=ER();if(Pe(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=wt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=wt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(TF());return!u})});const r=Math.max(...Le(n,i=>i.length));return _(n,i=>{if(i.length<r){const o=Le(new Array(r-i.length),()=>ER());i.splice(i.length,0,...o)}}),n}function Ub(t,e,n){dse(t,e),e.set(t,n)}function dse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mi(t,e){return t.get(_F(t,e))}function ch(t,e,n){return t.set(_F(t,e),n),n}function _F(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const S1=["label","collapsible"];var No=new WeakMap,Ua=new WeakMap,zb=new WeakMap;class fse{constructor(){Ub(this,No,[]),Ub(this,Ua,0),Ub(this,zb,1/0)}setColumnsLimit(e){ch(zb,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ch(No,this,hse(e,mi(zb,this))),ch(Ua,this,mi(No,this).length)}getData(){return mi(No,this)}mergeWith(e){_(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Xt(s,o,S1)})}map(e){_(mi(No,this),n=>{_(n,r=>{const i=e({...r});Pe(i)&&Xt(r,i,S1)})})}getHeaderSettings(e,n){var r;if(e>=mi(Ua,this)||e<0)return null;const i=mi(No,this)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=mi(Ua,this)||e<0)return i;const o=mi(No,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return mi(Ua,this)}getColumnsCount(){return mi(Ua,this)>0?mi(No,this)[0].length:0}clear(){ch(No,this,[]),ch(Ua,this,0)}}function Yb(t,e,n){return(e=gse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gse(t){var e=mse(t,"string");return typeof e=="symbol"?e:e+""}function mse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const MF="DF-pre-order";function IF(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=IF.call(this.childs[r],t,e)}return n}const pse="DF-post-order";function PF(t,e){for(let n=0;n<this.childs.length;n++)if(PF.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const OF="BF";function wse(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const vse=OF,R1=new Map([[MF,IF],[pse,PF],[OF,wse]]);class Gm{constructor(e){Yb(this,"data",{}),Yb(this,"parent",null),Yb(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Gm({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vse;if(!R1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);R1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Gb(t,e,n){Cse(t,e),e.set(t,n)}function Cse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e){return t.get(xF(t,e))}function yse(t,e,n){return t.set(xF(t,e),n),n}function xF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cu=new WeakMap,za=new WeakMap,hu=new WeakMap;class bse{constructor(e){Gb(this,cu,new Map),Gb(this,za,new Map),Gb(this,hu,null),yse(hu,this,e)}getRoots(){return Array.from(jn(cu,this).values())}getRootByColumn(e){let n;return jn(za,this).has(e)&&(n=jn(cu,this).get(jn(za,this).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-jn(za,this).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;jn(za,this).clear(),_(jn(cu,this),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)jn(za,this).set(i,e);e+=r})}buildTree(){this.clear();const e=jn(hu,this).getColumnsCount();let n=0;for(;n<e;){const r=jn(hu,this).getHeaderSettings(0,n),i=new Gm;jn(cu,this).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=jn(hu,this).getHeadersSettings(r,n,i);r+=1,_(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Gm(a),e.addChild(l)),r<jn(hu,this).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){jn(cu,this).clear(),jn(za,this).clear()}}function HF(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function qm(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Km(t){return qm(t,"origColspan")===t.data.origColspan}function y_(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Km(t))return y_(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)_(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,HF(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Km(a)&&(l.isCollapsed=qm(a,"isCollapsed"))}),{rollbackModification:()=>b_(t),affectedColumns:Array.from(o),colspanCompensation:s}}function b_(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Km(t))return b_(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)_(o,l=>{HF(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=qm(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Km(l)&&(u.isCollapsed=qm(l,"isCollapsed"))}),{rollbackModification:()=>y_(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Sse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Rse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const E1=new Map([["collapse",b_],["expand",y_],["hide-column",Sse],["show-column",Rse]]);function Ese(t,e,n){if(!E1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return E1.get(t)(e,n)}function Rg(t){const e=[];return _(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=_se(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(TF());else{const f=Tse(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function Tse(t){const{crossHiddenColumns:e,...n}=ER(t);return n}function _se(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function qb(t,e,n){Mse(t,e),e.set(t,n)}function Mse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hh(t,e,n){return t.set(AF(t,e),n),n}function xt(t,e){return t.get(AF(t,e))}function AF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xi=new WeakMap,or=new WeakMap,Ya=new WeakMap;class Ise{constructor(){qb(this,Xi,new fse),qb(this,or,new bse(xt(Xi,this))),qb(this,Ya,[[]])}setState(e){xt(Xi,this).setData(e);let n=!1;try{xt(or,this).buildTree()}catch{xt(or,this).clear(),xt(Xi,this).clear(),n=!0}return hh(Ya,this,Rg(xt(or,this).getRoots())),n}setColumnsLimit(e){xt(Xi,this).setColumnsLimit(e)}mergeStateWith(e){const n=Le(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});xt(Xi,this).mergeWith(n),xt(or,this).buildTree(),hh(Ya,this,Rg(xt(or,this).getRoots()))}mapState(e){xt(Xi,this).map(e),xt(or,this).buildTree(),hh(Ya,this,Rg(xt(or,this).getRoots()))}mapNodes(e){return ln(xt(or,this).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=xt(or,this).getNode(n,r);let o;return i&&(o=Ese(e,i,r),hh(Ya,this,Rg(xt(or,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=xt(Ya,this)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=xt(or,this).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const r=n-e+1;let i=!1,o=null;for(let s=e;s<=n;s++){const a=xt(or,this).getRootByColumn(s);if(!a)break;i=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=r&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},MF)}return i&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return xt(Xi,this).getLayersCount()}getColumnsCount(){return xt(Xi,this).getColumnsCount()}clear(){hh(Ya,this,[]),xt(Xi,this).clear(),xt(or,this).clear()}}function dh(t,e,n){return(e=Pse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pse(t){var e=Ose(t,"string");return typeof e=="symbol"?e:e+""}function Ose(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xse{constructor(e,n){dh(this,"hot",void 0),dh(this,"nestedHeaderSettingsGetter",void 0),dh(this,"layersCount",0),dh(this,"container",void 0),dh(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),r=n.length;this.widthsMap.clear();for(let i=0;i<r;i++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;s&&(m+='<button class="changeType"></button>'),El(d,m),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function Hse(t,e){NF(t,e),e.add(t)}function T1(t,e,n){return(e=Ase(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ase(t){var e=Nse(t,"string");return typeof e=="symbol"?e:e+""}function Nse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fh(t,e,n){NF(t,e),e.set(t,n)}function NF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qo(t,e,n){return t.set(Ht(t,e),n),n}function ke(t,e){return t.get(Ht(t,e))}function Ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _1="nestedHeaders",Dse=280;var ot=new WeakMap,_s=new WeakMap,Xh=new WeakMap,rw=new WeakMap,Xm=new WeakMap,Ft=new WeakSet;class kse extends Ue{constructor(){super(...arguments),Hse(this,Ft),fh(this,ot,new Ise),fh(this,_s,null),fh(this,Xh,null),fh(this,rw,!1),fh(this,Xm,null),T1(this,"ghostTable",new xse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),T1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return _1}static get PLUGIN_PRIORITY(){return Dse}isEnabled(){return!!this.hot.getSettings()[_1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ke(nt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Ht(Ft,this,Qse).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Jse).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Vse).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Wse).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Bse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,jse).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Use).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,zse).call(e,...i)}),this.addHook("afterSelection",()=>Ht(Ft,this,Eg).call(this)),this.addHook("afterSelectionFocusSet",()=>Ht(Ft,this,Eg).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Lse).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Ht(Ft,this,Gse).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Kse).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Xse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,$se).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Fse).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Yse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,qse).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ht(Ft,e,Zse).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,Eg).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Ht(Ft,this,Eg).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ke(ot,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ke(ot,this).setState(e)),this.detectedOverlappedHeaders&&Ke(nt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";ke(ot,this).triggerColumnModification(i,r)}),!ke(_s,this)&&this.enabled&&Qo(_s,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";ke(ot,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),ke(ot,this).clear(),ke(_s,this).unsubscribe(),Qo(_s,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ke(ot,this)}getLayersCount(){return ke(ot,this).getLayersCount()}getHeaderSettings(e,n){return ke(ot,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),pe(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),pe(o,"hiddenHeader"),pe(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=ke(ot,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)Y(o,"hiddenHeader");else if(c>1){var m,w,b;const{wtOverlays:E}=l._wt,C=(m=E.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),M=(w=E.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o);((b=E.topOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(o))&&u<r&&Y(o,"hiddenHeaderText");const L=C||M?Math.min(c,r-i):c;L>1&&o.setAttribute("colspan",L)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const E=o.querySelector("div.relative");E&&f&&f.length>0&&(pe(E,this.hot.getColumnMeta(u).headerClassName),Y(E,f))}}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=ke(ot,this).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Qo(ot,this,null),ke(_s,this)!==null&&(ke(_s,this).unsubscribe(),Qo(_s,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ke(ot,this).getHeaderTreeNodeData(e.row,e.col)}}function Eg(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=ke(ot,this).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Lse(t,e){var n;const r=this.hot.getSelectedRangeLast();if(!r)return t;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:(n=ke(Xm,this))===null||n===void 0?void 0:n.row,l=s?t:i.col,u=a<0&&l>=0;if(Qo(Xm,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=ke(ot,this).findLeftMostColumnIndex(a,l),m=ke(ot,this).findRightMostColumnIndex(a,l),w=m-f+1;if(f<c&&m>h)return f;if(s){let b=null;return f>=c&&m>h?w>d?(e.value="start",b=f):(e.value="end",b=m):f<c&&m<=h&&(w>d?(e.value="end",b=m):(e.value="start",b=f)),b}return f<=c?f:m}function $se(t,e,n){const r=ke(ot,this).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=ke(ot,this).getHeaderSettings(e,t);if(o===YE){if(!a)return r.columnIndex}else if(o===Ak&&(l>s-i||!a))return null;return t}function Fse(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const m=c+f,w=d-a;if(w===0)continue;((i=ke(ot,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][w]="")}}}function Vse(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Wse(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Qo(Xh,this,e.clone()),Qo(rw,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(_p(t)||ea(t)&&l||lk(t))&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Bse(t,e,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=We(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function jse(){Qo(rw,this,!1)}function Use(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ke(rw,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=ke(ot,this).getHeaderTreeNodeData(ke(Xh,this).row,ke(Xh,this).col);if(e.setHighlight(ke(Xh,this)),o>e.getWidth()||i<n||i+o-1>r){const s=ke(ot,this).findTopMostEntireHeaderLevel(We(n,i,i+o-1),We(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function zse(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=ke(ot,this).findLeftMostColumnIndex(n.row,n.col),o=ke(ot,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Yse(t,e,n){const r=t.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});Qo(Xm,this,n.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Gse(t){if(ke(ot,this).getLayersCount()>0){t.length=0;for(let e=0;e<ke(ot,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function qse(t){const e=ke(ot,this).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=ke(ot,this).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Nn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?ke(ot,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Kse(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Xse(t,e,n){var r;const{label:i}=(r=ke(ot,this).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Zse(t,e){if(t<0)return this.hot.getCell(t,ke(ot,this).findLeftMostColumnIndex(t,e),!0)}function Qse(){this.updatePlugin()}function Jse(t,e){e||this.updatePlugin()}function gh(t,e,n){return(e=eae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eae(t){var e=tae(t,"string");return typeof e=="symbol"?e:e+""}function tae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nae{constructor(e,n){gh(this,"hot",void 0),gh(this,"data",null),gh(this,"plugin",void 0),gh(this,"parentReference",new WeakMap),gh(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},fe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&_(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&_(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Oe(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(_(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(fe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),fe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];_(r,o=>{i.push(this.getDataObject(o))}),_(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=n;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function M1(t,e,n){return(e=rae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:e+""}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_{constructor(e,n){M1(this,"hot",void 0),M1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class io extends S_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(_(l,c=>{c&&s.removeChild(c)}),Y(n,io.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",fe(0,i-1,()=>{const d=c.createElement("SPAN");Y(d,io.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ce(c,[Sl()]),Y(n,io.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Y(c,`${io.CSS_CLASSES.button} ${io.CSS_CLASSES.expandButton}`),u&&Ce(n,[Zr(!1)])):(Y(c,`${io.CSS_CLASSES.button} ${io.CSS_CLASSES.collapseButton}`),u&&Ce(n,[Zr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let r=11;this.hot.stylesHandler.isClassicTheme()||(r=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,r+10*n+25),this.hot.render()}}class oae extends S_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),_(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{fe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&_(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return _(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);_(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&_(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];_(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];_(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{_(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&_(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);ye(e.target,io.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),oi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function sae(t,e,n){aae(t,e),e.set(t,n)}function aae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lae(t,e,n){return(e=uae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uae(t){var e=cae(t,"string");return typeof e=="symbol"?e:e+""}function cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hae(t,e){return t.get(dae(t,e))}function dae(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var I1=new WeakMap;class fae extends S_{constructor(){super(...arguments),lae(this,"dataManager",this.plugin.dataManager),sae(this,I1,{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(G0)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(q0)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return fe(0,e.items.length-1,r=>{if(r===0)return _(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return fe(0,e.items.length-1,n=>{const r=hae(I1,this)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}function Tg(t,e,n){return(e=gae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gae(t){var e=mae(t,"string");return typeof e=="symbol"?e:e+""}function mae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pae{constructor(e){Tg(this,"plugin",void 0),Tg(this,"hot",void 0),Tg(this,"dataManager",void 0),Tg(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(m=>{if(!l)return!1;const w=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(w,a),w}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Rt(i)&&(Ke(nt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0;if(this.movedToCollapsed){let s=null;e[r-1]<n?s=this.dataManager.translateTrimmedRow(n-r):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);i=this.dataManager.untranslateTrimmedRow(l),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);this.hot.selectCells([[i,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function wae(t,e){DF(t,e),e.add(t)}function P1(t,e,n){DF(t,e),e.set(t,n)}function DF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kb(t,e,n){return(e=vae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vae(t){var e=Cae(t,"string");return typeof e=="symbol"?e:e+""}function Cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rm(t,e){return t.get(fn(t,e))}function Zm(t,e,n){return t.set(fn(t,e),n),n}function fn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qm="nestedRows",yae=300,O1=Qm,bae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var iw=new WeakMap,du=new WeakMap,Cn=new WeakSet;class Sae extends Ue{constructor(){super(...arguments),wae(this,Cn),Kb(this,"dataManager",null),Kb(this,"headersUI",null),Kb(this,"collapsedRowsMap",null),P1(this,iw,!1),P1(this,du,!1)}static get PLUGIN_KEY(){return Qm}static get PLUGIN_PRIORITY(){return yae}isEnabled(){return!!this.hot.getSettings()[Qm]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Bd),this.dataManager=new nae(this,this.hot),this.collapsingUI=new oae(this,this.hot),this.headersUI=new io(this,this.hot),this.contextMenuUI=new fae(this,this.hot),this.rowMoveController=new pae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,kae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Lae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Tae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,_ae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Mae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Eae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Oae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Pae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,xae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Hae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Aae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Nae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Iae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Dae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(Cn,e,Rae).call(e,...r)}),this.addHook("beforeLoadData",n=>fn(Cn,this,x1).call(this,n)),this.addHook("beforeUpdateData",n=>fn(Cn,this,x1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&((n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(r)&&r.col===-1&&r.row>=0},group:O1,relativeToGroup:la,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(O1)}disableCoreAPIModifiers(){Zm(du,this,!0)}enableCoreAPIModifiers(){Zm(du,this,!1)}onModifyRowData(e){if(!rm(du,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!rm(du,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return rm(du,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Rae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Eae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Tae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),Zm(iw,this,!0),this.dataManager.getData().slice()}function _ae(t){return this.contextMenuUI.appendOptions(t)}function Mae(t,e){this.headersUI.appendLevelIndicators(t,e)}function Iae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Pae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{Zm(iw,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Oae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function xae(){this.collapsingUI.collapsedRowsStash.stash()}function Hae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Aae(){this.collapsingUI.collapsedRowsStash.stash()}function Nae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Dae(){this.dataManager.rewriteCache()}function kae(){this.headersUI.updateRowHeaderWidth()}function Lae(t,e){rm(iw,this)&&(e.skipRender=!0)}function x1(t){if(!Bk(t)){NE(bae),this.hot.getSettings()[Qm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Xb(t,e,n){return(e=$ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ae(t){var e=Fae(t,"string");return typeof e=="symbol"?e:e+""}function Fae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Xb(this,"rootWindow",void 0),Xb(this,"prefix",void 0),Xb(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){_(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function Wae(t,e,n){return(e=Bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bae(t){var e=jae(t,"string");return typeof e=="symbol"?e:e+""}function jae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ne.getSingleton().register("persistentStateSave");ne.getSingleton().register("persistentStateLoad");ne.getSingleton().register("persistentStateReset");const H1="persistentState",Uae=0;class zae extends Ue{constructor(){super(...arguments),Wae(this,"storage",void 0)}static get PLUGIN_KEY(){return H1}static get PLUGIN_PRIORITY(){return Uae}isEnabled(){return!!this.hot.getSettings()[H1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Vae(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Yae(t,e){Gae(t,e),e.add(t)}function Gae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zb(t,e,n){return(e=qae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qae(t){var e=Kae(t,"string");return typeof e=="symbol"?e:e+""}function Kae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qb="search",Xae=190,Zae="htSearchResult",Qae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Jae=function(t,e,n){return Rt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Rt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Jb=new WeakSet;class ele extends Ue{constructor(){super(...arguments),Yae(this,Jb),Zb(this,"callback",Qae),Zb(this,"queryMethod",Jae),Zb(this,"searchResultClass",Zae)}static get PLUGIN_KEY(){return Qb}static get PLUGIN_PRIORITY(){return Xae}isEnabled(){return this.hot.getSettings()[Qb]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Qb];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return A1(Jb,e,N1).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return A1(Jb,e,N1).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return fe(0,i-1,l=>{fe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,m=(h.search.queryMethod||r)(e,c,h);if(m){const w={row:l,col:u,data:c};s.push(w)}d&&d(a,l,u,c,m)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Pe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function N1(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function _g(t,e,n){return(e=tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tle(t){var e=nle(t,"string");return typeof e=="symbol"?e:e+""}function nle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kF{constructor(e){_g(this,"viewportWidth",void 0),_g(this,"overwriteColumnWidthFn",void 0),_g(this,"baseWidths",new Map),_g(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class rle extends kF{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const r=this.viewportWidth/e,i=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*r),m=this.overwriteColumnWidthFn(f,d);f===m&&f>=ju?(i.push([d,m]),a+=m):f!==m&&(i.push([d,m]),o.push(d),s-=m)}),s<=ju){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;i.forEach((h,d)=>{let[f,m]=h,w=m;o.includes(f)||(w=Math.round(m*l)),this.stretchedWidths.set(f,w),u=f,d<i.length-1&&(c+=w)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function D1(t,e,n){ile(t,e),e.set(t,n)}function ile(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eS(t,e){return t.get(LF(t,e))}function Mg(t,e,n){return t.set(LF(t,e),n),n}function LF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ig=new WeakMap,mh=new WeakMap;class ole extends kF{constructor(){super(...arguments),D1(this,Ig,0),D1(this,mh,-1)}prepare(e){super.prepare(e),Mg(Ig,this,0),Mg(mh,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Mg(mh,this,e),Mg(Ig,this,n)}calculate(){if(eS(mh,this)===-1)return;const e=Array.from(this.baseWidths).reduce((r,i)=>{let[,o]=i;return r+o},0),n=Math.max(this.viewportWidth-e+eS(Ig,this),0);this.stretchedWidths.set(eS(mh,this),n)}}function sle(t,e){$F(t,e),e.add(t)}function Pg(t,e,n){$F(t,e),e.set(t,n)}function $F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vt(t,e){return t.get(Pu(t,e))}function tS(t,e,n){return t.set(Pu(t,e),n),n}function Pu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ale="stretchColumns";var Hn=new WeakMap,fu=new WeakMap,nS=new WeakMap,Og=new WeakMap,ph=new WeakSet;class lle{constructor(e){sle(this,ph),Pg(this,Hn,void 0),Pg(this,fu,void 0),Pg(this,nS,new Map([["all",new rle(Pu(ph,this,k1).bind(this))],["last",new ole(Pu(ph,this,k1).bind(this))]])),Pg(this,Og,"none"),tS(Hn,this,e),tS(fu,this,Vt(Hn,this).columnIndexMapper.createAndRegisterIndexMap(ale,"physicalIndexToValue"))}useStrategy(e){tS(Og,this,Vt(nS,this).has(e)?e:"none")}refreshStretching(){if(Vt(Og,this)==="none"){Vt(fu,this).clear();return}Vt(Hn,this).batchExecution(()=>{Vt(fu,this).clear();const e=Vt(nS,this).get(Vt(Og,this));let r=Vt(Hn,this).view.getViewportWidth();Pu(ph,this,ule).call(this)&&(r-=mn(Vt(Hn,this).rootDocument)),e.prepare({viewportWidth:r});for(let i=0;i<Vt(Hn,this).countCols();i++)Vt(Hn,this).columnIndexMapper.isHidden(Vt(Hn,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,Pu(ph,this,cle).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[o,s]=i;Vt(fu,this).setValueAtIndex(Vt(Hn,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return Vt(fu,this).getValueAtIndex(Vt(Hn,this).toPhysicalColumn(e))}}function ule(){const{view:t,stylesHandler:e}=Vt(Hn,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),r=Vt(Hn,this).countRows(),i=e.getDefaultRowHeight();let o=0,s=!1;for(let l=0;l<r;l++){var a;if(o+=((a=Vt(Hn,this).getRowHeight(l))!==null&&a!==void 0?a:i)+(l===0?1:0),o>n){s=!0;break}}return s}function cle(t){var e;return(e=Vt(Hn,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:ju}function k1(t,e){return Vt(Hn,this).runHooks("beforeStretchingColumnWidth",t,e)}function hle(t,e){FF(t,e),e.add(t)}function rS(t,e,n){FF(t,e),e.set(t,n)}function FF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iS(t,e,n){return t.set(Jm(t,e),n),n}function Vo(t,e){return t.get(Jm(t,e))}function Jm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dle="stretchColumns",fle=155;var Ru=new WeakMap,xg=new WeakMap,wh=new WeakMap,oS=new WeakSet;class gle extends Ue{constructor(){super(...arguments),hle(this,oS),rS(this,Ru,new lle(this.hot)),rS(this,xg,null),rS(this,wh,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(r=>{let{contentRect:i}=r;Vo(xg,this)!==null&&Vo(xg,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),iS(xg,this,i.width)})})}))}static get PLUGIN_KEY(){return dle}static get PLUGIN_PRIORITY(){return fle}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Vo(Ru,this).useStrategy(this.hot.getSettings().stretchH),Vo(wh,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jm(oS,e,ple).call(e,...r)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jm(oS,e,mle).call(e,...r)},10),super.enablePlugin())}updatePlugin(){Vo(Ru,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Vo(wh,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Vo(Ru,this).getStretchedWidth(e)}destroy(){Vo(wh,this).disconnect(),iS(wh,this,null),iS(Ru,this,null),super.destroy()}}function mle(t,e,n){if(n===this.pluginName)return;const r=this.getColumnWidth(e);return typeof r=="number"?r:t}function ple(t){t&&Vo(Ru,this).refreshStretching()}function wle(t,e){vle(t,e),e.add(t)}function vle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hg(t,e,n){return(e=Cle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cle(t){var e=yle(t,"string");return typeof e=="symbol"?e:e+""}function yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ble="touchScroll",Sle=200;var Ag=new WeakSet;class Rle extends Ue{constructor(){super(...arguments),wle(this,Ag),Hg(this,"scrollbars",[]),Hg(this,"clones",[]),Hg(this,"lockedCollection",!1),Hg(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return ble}static get PLUGIN_PRIORITY(){return Sle}static get SETTING_KEYS(){return!0}isEnabled(){return wE()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>sS(Ag,this,Ele).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>sS(Ag,this,Tle).call(this)),this.addHook("afterMomentumScroll",()=>sS(Ag,this,_le).call(this))}}function Ele(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Tle(){this.freezeOverlays=!0,_(this.clones,t=>{Y(t,"hide-tween")})}function _le(){this.freezeOverlays=!1,_(this.clones,t=>{pe(t,"hide-tween"),Y(t,"show-tween")}),this.hot._registerTimeout(()=>{_(this.clones,t=>{pe(t,"show-tween")})},400),_(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Mle(t,e){Ile(t,e),e.add(t)}function Ile(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ple(t,e,n){return(e=Ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ole(t){var e=xle(t,"string");return typeof e=="symbol"?e:e+""}function xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hle(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const im="trimRows",Ale=330;var L1=new WeakSet;class Nle extends Ue{constructor(){super(...arguments),Mle(this,L1),Ple(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return im}static get PLUGIN_PRIORITY(){return Ale}isEnabled(){return!!this.hot.getSettings()[im]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Bd),this.trimmedRowsMap.addLocalHook("init",()=>Hle(L1,this,Dle).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[im];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),_(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{_(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(_(e,l=>{o[l]=!1}),i=ln(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Dle(){const t=this.hot.getSettings()[im];Array.isArray(t)&&this.hot.batchExecution(()=>{_(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function kle(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=$le(t,"string");return typeof e=="symbol"?e:e+""}function $le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ai{constructor(e){kle(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Ng(t,e,n){return(e=Fle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fle(t){var e=Vle(t,"string");return typeof e=="symbol"?e:e+""}function Vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R_ extends ai{constructor(e){let{stateBefore:n,range:r,type:i,alignment:o}=e;super("cell_alignment"),Ng(this,"stateBefore",void 0),Ng(this,"range",void 0),Ng(this,"type",void 0),Ng(this,"alignment",void 0),this.stateBefore=n,this.range=r,this.type=i,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(r,i,o,s)=>{n.done(()=>new R_({stateBefore:r,range:i,type:o,alignment:s}))})}undo(e,n){_(this.range,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&e.setCellMeta(i,o,"className",this.stateBefore[i][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Ps(this.range,this.type,this.alignment,(r,i)=>e.getCellMeta(r,i),(r,i,o,s)=>e.setCellMeta(r,i,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function $1(t,e,n){return(e=Wle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wle(t){var e=Ble(t,"string");return typeof e=="symbol"?e:e+""}function Ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E_ extends ai{constructor(e){let{columns:n,finalIndex:r}=e;super("col_move"),$1(this,"columns",void 0),$1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(r,i)=>{r!==!1&&n.done(()=>new E_({columns:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),v_(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function F1(t,e,n){return(e=jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jle(t){var e=Ule(t,"string");return typeof e=="symbol"?e:e+""}function Ule(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T_ extends ai{constructor(e){let{currentSortState:n,newSortState:r}=e;super("col_sort"),F1(this,"previousSortState",void 0),F1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=r}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(r,i,o)=>{o&&n.done(()=>new T_({currentSortState:r,newSortState:i}))})}undo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),o=i.isEnabled()?i:r;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const r=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),n()}}function V1(t,e,n){return(e=zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zle(t){var e=Yle(t,"string");return typeof e=="symbol"?e:e+""}function Yle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class __ extends ai{constructor(e){let{index:n,amount:r}=e;super("insert_col"),V1(this,"index",void 0),V1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(r,i,o)=>{n.done(()=>new __({index:r,amount:i}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function W1(t,e,n){return(e=Gle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gle(t){var e=qle(t,"string");return typeof e=="symbol"?e:e+""}function qle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M_ extends ai{constructor(e){let{index:n,amount:r}=e;super("insert_row"),W1(this,"index",void 0),W1(this,"amount",void 0),this.index=n,this.amount=r}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(r,i,o)=>{n.done(()=>new M_({index:r,amount:i}),o)})}undo(e,n){const r=e.countRows(),i=e.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Dg(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I_ extends ai{constructor(e){let{changes:n,selected:r,countCols:i,countRows:o}=e;super("change"),Dg(this,"changes",void 0),Dg(this,"selected",void 0),Dg(this,"countCols",void 0),Dg(this,"countRows",void 0),this.changes=n,this.selected=r,this.countCols=i,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new I_({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,i)})}undo(e,n){const r=$n(this.changes);for(let s=0,a=r.length;s<a;s++)r[s].splice(3,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,n){const r=$n(this.changes);for(let i=0,o=r.length;i<o;i++)r[i].splice(2,1);e.addHookOnce("afterChange",n),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function B1(t,e,n){return(e=Zle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zle(t){var e=Qle(t,"string");return typeof e=="symbol"?e:e+""}function Qle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P_ extends ai{constructor(e){let{conditionsStack:n,previousConditionsStack:r}=e;super("filter"),B1(this,"conditionsStack",void 0),B1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=r}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(r,i)=>{n.done(()=>new P_({conditionsStack:r,previousConditionsStack:i}))})}undo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.previousConditionsStack),r.filter()}redo(e,n){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),r.importConditions(this.conditionsStack),r.filter()}}function Jle(t,e,n){return(e=eue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eue(t){var e=tue(t,"string");return typeof e=="symbol"?e:e+""}function tue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O_ extends ai{constructor(e){let{data:n,cellRange:r}=e;super("merge_cells"),Jle(this,"cellRange",void 0),this.cellRange=r,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(r,i)=>{if(i)return;const o=r.getTopStartCorner(),s=r.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new O_({data:a,cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}function VF(t,e,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return fe(r,i,l=>{fe(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Do(t,e,n){return(e=nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nue(t){var e=rue(t,"string");return typeof e=="symbol"?e:e+""}function rue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x_ extends ai{constructor(e){let{index:n,indexes:r,data:i,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Do(this,"index",void 0),Do(this,"indexes",void 0),Do(this,"data",void 0),Do(this,"amount",void 0),Do(this,"headers",void 0),Do(this,"columnPositions",void 0),Do(this,"rowPositions",void 0),Do(this,"fixedColumnsStart",void 0),Do(this,"removedCellMetas",void 0),this.index=n,this.indexes=r,this.data=i,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+r)%e.countCols(),c=u+i-1,h=[],d=[],f=[];return fe(l.length-1,m=>{const w=[],b=l[m];fe(u,c,E=>{w.push(b[e.toPhysicalColumn(E)])}),h.push(w)}),fe(i-1,m=>{f.push(e.toPhysicalColumn(u+m))}),Array.isArray(e.getSettings().colHeaders)&&fe(i-1,m=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+m)]||null)}),new x_({index:u,indexes:f,data:h,amount:i,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:VF(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const r=e.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(i[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(Le(this.data[c],o));const l=Le(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),_(e.getSourceDataArray(),(c,h)=>{_(i,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&_(l,(c,h)=>{e.getSettings().colHeaders[i[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function gu(t,e,n){return(e=iue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iue(t){var e=oue(t,"string");return typeof e=="symbol"?e:e+""}function oue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H_ extends ai{constructor(e){let{index:n,data:r,fixedRowsBottom:i,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),gu(this,"index",void 0),gu(this,"data",void 0),gu(this,"fixedRowsBottom",void 0),gu(this,"fixedRowsTop",void 0),gu(this,"rowIndexesSequence",void 0),gu(this,"removedCellMetas",void 0),this.index=n,this.data=r,this.fixedRowsBottom=i,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=e.toPhysicalRow(r),u=l+i-1,c=$n(e.getSourceData(l,0,l+i-1,e.countSourceCols()-1));return new H_({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:VF(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const r=e.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);i.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function j1(t,e,n){return(e=sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sue(t){var e=aue(t,"string");return typeof e=="symbol"?e:e+""}function aue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A_ extends ai{constructor(e){let{rows:n,finalIndex:r}=e;super("row_move"),j1(this,"rows",void 0),j1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=r}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(r,i)=>{r!==!1&&n.done(()=>new A_({rows:r,finalIndex:i}))})}undo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),v_(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),r.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function lue(t,e,n){return(e=uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uue(t){var e=cue(t,"string");return typeof e=="symbol"?e:e+""}function cue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N_ extends ai{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),lue(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(r,i)=>{i||n.done(()=>new N_({cellRange:r}))})}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}function hue(t,e){[R_,E_,T_,__,M_,I_,P_,O_,x_,H_,A_,N_].forEach(n=>n.startRegisteringEvents(t,e))}function due(t,e){fue(t,e),e.add(t)}function fue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aS(t,e,n){return(e=gue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gue(t){var e=mue(t,"string");return typeof e=="symbol"?e:e+""}function mue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const U1="undoRedo",pue="undoRedo",wue=1e3;ne.getSingleton().register("beforeUndo");ne.getSingleton().register("afterUndo");ne.getSingleton().register("beforeRedo");ne.getSingleton().register("afterRedo");const z1=new Set;var kg=new WeakSet;class vue extends Ue{static get PLUGIN_KEY(){return pue}static get PLUGIN_PRIORITY(){return wue}static get SETTING_KEYS(){return!0}constructor(e){super(e),due(this,kg),aS(this,"doneActions",[]),aS(this,"undoneActions",[]),aS(this,"ignoreNewActions",!1),hue(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lS(kg,e,Cue).call(e,...r)}),this.registerShortcuts(),lS(kg,this,yue).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),lS(kg,this,bue).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:o=>!o.altKey,group:U1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(U1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=$n(n);if(this.hot.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",r)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=$n(n);if(this.hot.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",r)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Cue(t,e){e==="loadData"&&this.clear()}function yue(){const t=e=>{z1.has(e)||(Ke(nt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),z1.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function bue(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function Sue(){je(Dh),je(L7),je(kh),je(g5),je(S5),je(l$),je(wZ),je(tQ),je(Zp),je(uJ),je(DJ),je(jJ),je(ew),je(Tee),je(yne),je(Jne),je(_re),je($re),je(Xre),je(aie),je(wie),je(Die),je(Uie),je(Moe),je(ose),je(cse),je(kse),je(Sae),je(zae),je(ele),je(gle),je(Rle),je(Nle),je(vue)}function Rue(){a9(),O8(),F8(),o7(),Sue()}function Eue(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var uS,cS,hS,dS,fS;Rue();Eue(oe);oe.__GhostTable=n_;oe._getListenersCounter=gG;oe._getRegisteredMapsCounter=v3;oe.EventManager=Jr;const Tue=[Yz,PY,r3,H8,_Y,BY,Xz,DG,TY,Qz,zY,NG],_ue=[$Y,YY];oe.helper={};oe.dom={};_(Tue,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(oe.helper[e]=t[e])})});_(_ue,t=>{_(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(oe.dom[e]=t[e])})});oe.cellTypes=(uS=oe.cellTypes)!==null&&uS!==void 0?uS:{};_(SX(),t=>{oe.cellTypes[t]=NT(t)});oe.cellTypes.registerCellType=Vr;oe.cellTypes.getCellType=NT;oe.editors=(cS=oe.editors)!==null&&cS!==void 0?cS:{};_(lG(),t=>{oe.editors[`${Ln(t)}Editor`]=od(t)});oe.editors.registerEditor=ur;oe.editors.getEditor=od;oe.renderers=(hS=oe.renderers)!==null&&hS!==void 0?hS:{};_(XG(),t=>{const e=sd(t);t==="base"&&(oe.renderers.cellDecorator=e),oe.renderers[`${Ln(t)}Renderer`]=e});oe.renderers.registerRenderer=Er;oe.renderers.getRenderer=sd;oe.validators=(dS=oe.validators)!==null&&dS!==void 0?dS:{};_(JG(),t=>{oe.validators[`${Ln(t)}Validator`]=FE(t)});oe.validators.registerValidator=Za;oe.validators.getValidator=FE;oe.plugins=(fS=oe.plugins)!==null&&fS!==void 0?fS:{};_($E(),t=>{oe.plugins[t]=$d(t)});oe.plugins[`${Ln(Ue.PLUGIN_KEY)}Plugin`]=Ue;oe.plugins.registerPlugin=je;oe.plugins.getPlugin=$d;function TR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Mue(t){if(Array.isArray(t))return TR(t)}function Iue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yd(t,e,n){return e=ep(e),Due(t,WF()?Reflect.construct(e,n||[],ep(t).constructor):e.apply(t,n))}function Ku(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y1(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,BF(r.key),r)}}function Xu(t,e,n){return e&&Y1(t.prototype,e),n&&Y1(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pue(t,e,n){return(e=BF(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ep(t){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ep(t)}function bd(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_R(t,e)}function WF(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WF=function(){return!!t})()}function Oue(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xue(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Hue(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?G1(Object(n),!0).forEach(function(r){Pue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Aue(t,e){if(t==null)return{};var n,r,i=Nue(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Nue(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Due(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iue(t)}function _R(t,e){return _R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},_R(t,e)}function kue(t){return Mue(t)||Oue(t)||$ue(t)||xue()}function Lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function BF(t){var e=Lue(t,"string");return typeof e=="symbol"?e:e+""}function $ue(t,e){if(t){if(typeof t=="string")return TR(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?TR(t,e):void 0}}var gS=null,Fue="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Vue="The Handsontable instance bound to this component was destroyed and cannot be used properly.",tp="global",Wue="hot-wrapper-editor-container";function Bue(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function MR(t,e){var n=Pt.Children.toArray(t),r=Pt.Children.count(t),i=null;return r!==0&&(r===1&&n[0].props[e]?i=n[0]:i=n.find(function(o){return o.props[e]!==void 0})),i||null}function jF(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function UF(t,e){if(typeof t>"u"||e===null)return null;var n=YF(e.props,!1);return n.className="".concat(Wue," ").concat(n.className),Q1.createPortal(Pt.createElement("div",Object.assign({},n),e),t.body)}function zF(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tp,r=MR(t,"hot-editor"),i=jF(r);return r?Pt.cloneElement(r,{emitEditorInstance:function(s,a){e.get(i)||e.set(i,new Map);var l=e.get(i);l.set(a??tp,s)},editorColumnScope:n,isEditor:!0}):null}function jue(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;n||(n=document),gS||(gS=n.createDocumentFragment());var o=i??n.createElement("DIV");gS.appendChild(o);var s=Pt.cloneElement(t,Hue({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:Q1.createPortal(s,o,r),portalContainer:o}}function YF(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function Uue(){return typeof window<"u"}var GF=function(){function t(){Ku(this,t)}return Xu(t,null,[{key:"getSettings",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.prevProps,o=i===void 0?{}:i,s=r.isInit,a=s===void 0?!1:s,l=r.initOnlySettingKeys,u=l===void 0?[]:l,c=function(b){return!a&&u.includes(b)?o[b]===n[b]:!1},h={};if(n.settings){var d=n.settings;for(var f in d)d.hasOwnProperty(f)&&!c(f)&&(h[f]=d[f])}for(var m in n)m!=="settings"&&m!=="children"&&!c(m)&&n.hasOwnProperty(m)&&(h[m]=n[m]);return h}}])}(),zue=function(t){function e(){return Ku(this,e),yd(this,e,arguments)}return bd(e,t),Xu(e,[{key:"getSettingsProps",value:function(){var r=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!r.internalProps.includes(i)}).reduce(function(i,o){return i[o]=r.props[o],i},{})}},{key:"getLocalEditorElement",value:function(){return zF(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var r=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=GF.getSettings(this.getSettingsProps()),r!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(r),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var r=this.props._getOwnerDocument(),i=UF(r,this.getLocalEditorElement());return Pt.createElement(Pt.Fragment,null,i)}}])}(Pt.Component),Yue=function(t){function e(){var n;return Ku(this,e),n=yd(this,e,arguments),n.state={portals:[]},n}return bd(e,t),Xu(e,[{key:"render",value:function(){return Pt.createElement(Pt.Fragment,null,this.state.portals)}}])}(Pt.Component),Gue="16.0.1";function que(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qF={exports:{}},mS,q1;function Kue(){if(q1)return mS;q1=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return mS=t,mS}var pS,K1;function Xue(){if(K1)return pS;K1=1;var t=Kue();function e(){}function n(){}return n.resetWarningCache=e,pS=function(){function i(a,l,u,c,h,d){if(d!==t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}i.isRequired=i;function o(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:o,element:i,elementType:i,instanceOf:o,node:i,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},pS}qF.exports=Xue()();var Zue=qF.exports,wS=que(Zue),D_=function(t){function e(){var n;return Ku(this,e),n=yd(this,e,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCache=new Map,n.portalContainerCache=new Map,n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return bd(e,t),Xu(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Vue),null)},set:function(r){this.__hotInstance=r}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return Uue()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(r){this.hotElementRef=r}},{key:"getRendererWrapper",value:function(r){var i=this;return function(s,a,l,u,c,h,d){var f=i.getRenderedCellCache(),m=i.getPortalContainerCache(),w="".concat(l,"-").concat(u),b=s.guid,E="".concat(b,"-").concat(w),C="".concat(w,"-").concat(b);if(f.has(w)&&(a.innerHTML=f.get(w).innerHTML),a&&!a.getAttribute("ghost-table")){for(var M=i.portalCache.get(C),H=m.get(E);a.firstChild;)a.removeChild(a.firstChild);if(M&&H)a.appendChild(H);else{var L=jue(r,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:d,isRenderer:!0},a.ownerDocument,C,H),P=L.portal,O=L.portalContainer;m.set(E,O),a.appendChild(O),i.portalCache.set(C,P)}}return f.set(w,a),a}}},{key:"getEditorClass",value:function(r){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tp,s=jF(r),a=(i=this.getEditorCache().get(s))===null||i===void 0?void 0:i.get(o);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(r){var i=function(o){function s(a){var l;return Ku(this,s),l=yd(this,s,[a]),r.hotCustomEditorInstance=l,l.editorComponent=r,l}return bd(s,o),Xu(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(oe.editors.BaseEditor);return Object.getOwnPropertyNames(oe.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(i.prototype[o]=function(){for(var s,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(s=r[o]).call.apply(s,[r].concat(l))})}),i}},{key:"getGlobalRendererElement",value:function(){return MR(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return zF(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var r,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this._isHotInstanceDestroyed()?[]:((r=this.hotInstance)===null||r===void 0||(r=r.getSettings())===null||r===void 0?void 0:r._initOnlySettings)||[],a=GF.getSettings(this.props,{prevProps:o,isInit:i,initOnlySettingKeys:s}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(a.columns=this.columnSettings.length?this.columnSettings:a.columns,u)a.editor=this.getEditorClass(u,tp);else{var c;this.props.editor||(c=this.props.settings)!==null&&c!==void 0&&c.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=od("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=sd("text")}return a}},{key:"displayAutoSizeWarning",value:function(r){var i,o;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&Bue(Fue)}},{key:"setHotColumnSettings",value:function(r,i){this.columnSettings[i]=r}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:kue(this.portalCache.values())})}},{key:"updateHot",value:function(r){this.hotInstance&&this.hotInstance.updateSettings(r,!1)}},{key:"setRenderersPortalManagerRef",value:function(r){this.renderersPortalManager=r}},{key:"componentDidMount",value:function(){var r=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new oe.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return r.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return r.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(r){this.clearCache();var i=this.createNewGlobalSettings(!1,r);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var r=this,i=function(c){return c.type===zue},o=Pt.Children.toArray(this.props.children),s=o.filter(function(u){return i(u)}).map(function(u,c){return Pt.cloneElement(u,{_componentRendererColumns:r.componentRendererColumns,_emitColumnSettings:r.setHotColumnSettings.bind(r),_columnIndex:c,_getChildElementByType:MR.bind(r),_getRendererWrapper:r.getRendererWrapper.bind(r),_getEditorClass:r.getEditorClass.bind(r),_getOwnerDocument:r.getOwnerDocument.bind(r),_getEditorCache:r.getEditorCache.bind(r),children:u.props.children})}),a=YF(this.props),l=UF(this.getOwnerDocument(),this.getGlobalEditorElement());return Pt.createElement(Pt.Fragment,null,Pt.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),s),Pt.createElement(Yue,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return Gue}}])}(Pt.Component);D_.propTypes={style:wS.object,id:wS.string,className:wS.string};var Que=["children"],Jue=Pt.forwardRef(function(t,e){var n,r=t.children,i=Aue(t,Que),o=typeof Pt.useId=="function"?Pt.useId():void 0,s=(n=i.id)!==null&&n!==void 0?n:o;return Pt.createElement(D_,Object.assign({id:s},i,{ref:e}),r)});Jue.version=D_.version;Pt.Component;export{Jue as H,Q8 as N,Pt as U,rV as a,oe as b,Z1 as r,tce as t};
