import{j as e,n as u,g as R,a as N}from"./index-Df-6MJ7u.js";import{r as a}from"./handsontable-7BBM75Z1.js";import{F as A}from"./TrashIcon-I-_qGSbO.js";import"./react-Csw2ODfV.js";function K({title:l,titleId:h,...d},b){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:b,"aria-labelledby":h},d),l?a.createElement("title",{id:h},l):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}const $=a.forwardRef(K),q=()=>{const[l,h]=a.useState(""),[d,b]=a.useState(""),[w,v]=a.useState(!1),[g,p]=a.useState({role:""}),[E,C]=a.useState([]),[y,f]=a.useState(null),[r,F]=a.useState(1),[m,k]=a.useState(1),[o,T]=a.useState(5),[S,j]=a.useState("add"),i=a.useRef(null);a.useEffect(()=>(i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{b(l)},300),()=>{i.current&&clearTimeout(i.current)}),[l]),a.useEffect(()=>{(async()=>{try{const x=(await u.get("/api/settings/paginaterecs")).data.value||5;T(x),s(1,x,d)}catch{s(1,5,d)}})()},[d]);const s=async(t=1,n=o,x="")=>{v(!0);try{const c=await u.get(`/api/roles?per_page=${n}&page=${t}&search=${x}`);C(c.data.data),k(c.data.last_page),F(c.data.current_page)}catch(c){console.error("Failed to load roles",c)}finally{v(!1)}},P=()=>{p({role:""}),f(null),j("add"),s(r,o,l)},X=t=>{p({...g,[t.target.name]:t.target.value}),s(r,o,l)},L=async t=>{t.preventDefault(),await R();try{y?(await u.put(`/api/roles/${y}`,g,{headers:{"X-XSRF-TOKEN":N.get("XSRF-TOKEN")||""},withCredentials:!0}),alert("Role updated"),f(null),j("add")):(await u.post("/api/roles",g,{headers:{"X-XSRF-TOKEN":N.get("XSRF-TOKEN")||""},withCredentials:!0}),alert("Role added")),p({role:""}),s(r,o,l)}catch(n){alert(n?.response?.data?.message||"Error saving role")}},D=t=>{f(t.id),p({role:t.role}),j("edit"),s(r,o,l)},O=async t=>{if(confirm("Are you sure you want to delete this role?")){await R();try{await u.delete(`/api/roles/${t}`,{headers:{"X-XSRF-TOKEN":N.get("XSRF-TOKEN")||""},withCredentials:!0}),alert("Role deleted"),s(r)}catch{alert("Delete failed")}}};return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-full",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:y?"Update Role":"Add New Role"}),e.jsxs("form",{onSubmit:L,className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",name:"role",placeholder:"Enter role",value:g.role,onChange:X,className:"w-full border rounded px-3 py-2 text-gray-800",required:!0}),e.jsx("button",{type:"submit",className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-500",children:S==="edit"?"Update":"Submit"}),S==="edit"&&e.jsx("button",{type:"button",onClick:P,className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500",children:"Cancel"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",value:l,onChange:t=>h(t.target.value),placeholder:"Search roles...",className:"w-full border rounded px-3 py-2 text-gray-800"})}),w&&e.jsx("div",{className:"flex justify-center my-4",children:e.jsx("div",{className:"w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}),!w&&e.jsxs("table",{className:"w-full text-left border border-gray-200 bg-white rounded shadow",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"#"}),e.jsx("th",{className:"p-2",children:"Role"}),e.jsx("th",{className:"p-2 w-24 text-center",children:"Actions"})]})}),e.jsx("tbody",{children:E.map((t,n)=>e.jsxs("tr",{className:"border-t border-gray-100",children:[e.jsx("td",{className:"p-2",children:(r-1)*o+n+1}),e.jsx("td",{className:"p-2",children:t.role}),e.jsxs("td",{className:"p-2 flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>D(t),className:"text-blue-500 hover:text-blue-700",title:"Edit",children:e.jsx($,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>O(t.id),className:"text-red-500 hover:text-red-700",title:"Delete",children:e.jsx(A,{className:"h-5 w-5"})})]})]},t.id))})]}),e.jsxs("div",{className:"flex justify-between mt-4 text-sm text-gray-700",children:[e.jsx("button",{onClick:()=>s(1),disabled:r===1,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:"First"}),e.jsx("button",{onClick:()=>s(r-1),disabled:r===1,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"self-center",children:["Page ",r," of ",m]}),e.jsx("button",{onClick:()=>s(r+1),disabled:r===m,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:"Next"}),e.jsx("button",{onClick:()=>s(m),disabled:r===m,className:"px-3 py-1 bg-gray-200 rounded hover:bg-gray-300 disabled:opacity-50",children:"Last"})]})]})};export{q as default};
